(function(A){if(typeof exports=="object"&&typeof module=="object"){A(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],A)}else{A(CodeMirror)}}})(function(A){A.defineMode("vbscript",function(l,S){var q="error";function O(s){return new RegExp("^(("+s.join(")|(")+"))\\b","i")}var D=new RegExp("^[\\+\\-\\*/&\\\\\\^<>=]");var k=new RegExp("^((<>)|(<=)|(>=))");var T=new RegExp("^[\\.,]");var i=new RegExp("^[\\(\\)]");var U=new RegExp("^[A-Za-z][_A-Za-z0-9]*");var E=["class","sub","select","while","if","function","property","with","for"];var Q=["else","elseif","case"];var F=["next","loop","wend"];var X=O(["and","or","not","xor","is","mod","eqv","imp"]);var o=["dim","redim","then","until","randomize","byval","byref","new","property","exit","in","const","private","public","get","set","let","stop","on error resume next","on error goto 0","option explicit","call","me"];var Z=["true","false","nothing","empty","null"];var J=["abs","array","asc","atn","cbool","cbyte","ccur","cdate","cdbl","chr","cint","clng","cos","csng","cstr","date","dateadd","datediff","datepart","dateserial","datevalue","day","escape","eval","execute","exp","filter","formatcurrency","formatdatetime","formatnumber","formatpercent","getlocale","getobject","getref","hex","hour","inputbox","instr","instrrev","int","fix","isarray","isdate","isempty","isnull","isnumeric","isobject","join","lbound","lcase","left","len","loadpicture","log","ltrim","rtrim","trim","maths","mid","minute","month","monthname","msgbox","now","oct","replace","rgb","right","rnd","round","scriptengine","scriptenginebuildversion","scriptenginemajorversion","scriptengineminorversion","second","setlocale","sgn","sin","space","split","sqr","strcomp","string","strreverse","tan","time","timer","timeserial","timevalue","typename","ubound","ucase","unescape","vartype","weekday","weekdayname","year"];var j=["vbBlack","vbRed","vbGreen","vbYellow","vbBlue","vbMagenta","vbCyan","vbWhite","vbBinaryCompare","vbTextCompare","vbSunday","vbMonday","vbTuesday","vbWednesday","vbThursday","vbFriday","vbSaturday","vbUseSystemDayOfWeek","vbFirstJan1","vbFirstFourDays","vbFirstFullWeek","vbGeneralDate","vbLongDate","vbShortDate","vbLongTime","vbShortTime","vbObjectError","vbOKOnly","vbOKCancel","vbAbortRetryIgnore","vbYesNoCancel","vbYesNo","vbRetryCancel","vbCritical","vbQuestion","vbExclamation","vbInformation","vbDefaultButton1","vbDefaultButton2","vbDefaultButton3","vbDefaultButton4","vbApplicationModal","vbSystemModal","vbOK","vbCancel","vbAbort","vbRetry","vbIgnore","vbYes","vbNo","vbCr","VbCrLf","vbFormFeed","vbLf","vbNewLine","vbNullChar","vbNullString","vbTab","vbVerticalTab","vbUseDefault","vbTrue","vbFalse","vbEmpty","vbNull","vbInteger","vbLong","vbSingle","vbDouble","vbCurrency","vbDate","vbString","vbObject","vbError","vbBoolean","vbVariant","vbDataObject","vbDecimal","vbByte","vbArray"];var N=["WScript","err","debug","RegExp"];var K=["description","firstindex","global","helpcontext","helpfile","ignorecase","length","number","pattern","source","value","count"];var d=["clear","execute","raise","replace","test","write","writeline","close","open","state","eof","update","addnew","end","createobject","quit"];var Y=["server","response","request","session","application"];var G=["buffer","cachecontrol","charset","contenttype","expires","expiresabsolute","isclientconnected","pics","status","clientcertificate","cookies","form","querystring","servervariables","totalbytes","contents","staticobjects","codepage","lcid","sessionid","timeout","scripttimeout"];var p=["addheader","appendtolog","binarywrite","end","flush","redirect","binaryread","remove","removeall","lock","unlock","abandon","getlasterror","htmlencode","mappath","transfer","urlencode"];var P=d.concat(K);N=N.concat(j);if(l.isASP){N=N.concat(Y);P=P.concat(p,G)}var m=O(o);var a=O(Z);var R=O(J);var M=O(N);var b=O(P);var f='"';var W=O(E);var e=O(Q);var c=O(F);var H=O(["end"]);var B=O(["do"]);var V=O(["on error resume next","exit"]);var r=O(["rem"]);function L(s,t){t.currentIndent++}function n(s,t){t.currentIndent--}function h(w,v){if(w.eatSpace()){return"space"}var u=w.peek();if(u==="'"){w.skipToEnd();return"comment"}if(w.match(r)){w.skipToEnd();return"comment"}if(w.match(/^((&H)|(&O))?[0-9\.]/i,false)&&!w.match(/^((&H)|(&O))?[0-9\.]+[a-z_]/i,false)){var s=false;if(w.match(/^\d*\.\d+/i)){s=true}else{if(w.match(/^\d+\.\d*/)){s=true}else{if(w.match(/^\.\d+/)){s=true}}}if(s){w.eat(/J/i);return"number"}var t=false;if(w.match(/^&H[0-9a-f]+/i)){t=true}else{if(w.match(/^&O[0-7]+/i)){t=true}else{if(w.match(/^[1-9]\d*F?/)){w.eat(/J/i);t=true}else{if(w.match(/^0(?![\dx])/i)){t=true}}}}if(t){w.eat(/L/i);return"number"}}if(w.match(f)){v.tokenize=g(w.current());return v.tokenize(w,v)}if(w.match(k)||w.match(D)||w.match(X)){return"operator"}if(w.match(T)){return null}if(w.match(i)){return"bracket"}if(w.match(V)){v.doInCurrentLine=true;return"keyword"}if(w.match(B)){L(w,v);v.doInCurrentLine=true;return"keyword"}if(w.match(W)){if(!v.doInCurrentLine){L(w,v)}else{v.doInCurrentLine=false}return"keyword"}if(w.match(e)){return"keyword"}if(w.match(H)){n(w,v);n(w,v);return"keyword"}if(w.match(c)){if(!v.doInCurrentLine){n(w,v)}else{v.doInCurrentLine=false}return"keyword"}if(w.match(m)){return"keyword"}if(w.match(a)){return"atom"}if(w.match(b)){return"variable-2"}if(w.match(R)){return"builtin"}if(w.match(M)){return"variable-2"}if(w.match(U)){return"variable"}w.next();return q}function g(u){var s=u.length==1;var t="string";return function(w,v){while(!w.eol()){w.eatWhile(/[^'"]/);if(w.match(u)){v.tokenize=h;return t}else{w.eat(/['"]/)}}if(s){if(S.singleLineStringErrors){return q}else{v.tokenize=h}}return t}}function C(v,u){var s=u.tokenize(v,u);var t=v.current();if(t==="."){s=u.tokenize(v,u);t=v.current();if(s&&(s.substr(0,8)==="variable"||s==="builtin"||s==="keyword")){if(s==="builtin"||s==="keyword"){s="variable"}if(P.indexOf(t.substr(1))>-1){s="variable-2"}return s}else{return q}}return s}var I={electricChars:"dDpPtTfFeE ",startState:function(){return{tokenize:h,lastToken:null,currentIndent:0,nextLineIndent:0,doInCurrentLine:false,ignoreKeyword:false}},token:function(u,t){if(u.sol()){t.currentIndent+=t.nextLineIndent;t.nextLineIndent=0;t.doInCurrentLine=0}var s=C(u,t);t.lastToken={style:s,content:u.current()};if(s==="space"){s=null}return s},indent:function(u,s){var t=s.replace(/^\s+|\s+$/g,"");if(t.match(c)||t.match(H)||t.match(e)){return l.indentUnit*(u.currentIndent-1)}if(u.currentIndent<0){return 0}return u.currentIndent*l.indentUnit}};return I});A.defineMIME("text/vbscript","vbscript")});