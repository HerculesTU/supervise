(function(A){if(typeof exports=="object"&&typeof module=="object"){A(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],A)}else{A(CodeMirror)}}})(function(A){A.defineMode("coffeescript",function(S,O){var E="error";function J(Y){return new RegExp("^(("+Y.join(")|(")+"))\\b")}var U=/^(?:->|=>|\+[+=]?|-[\-=]?|\*[\*=]?|\/[\/=]?|[=!]=|<[><]?=?|>>?=?|%=?|&=?|\|=?|\^=?|\~|!|\?|(or|and|\|\||&&|\?)=)/;var K=/^(?:[()\[\]{},:`=;]|\.\.?\.?)/;var T=/^[_A-Za-z$][_A-Za-z$0-9]*/;var H=/^@[_A-Za-z$][_A-Za-z$0-9]*/;var D=J(["and","or","not","is","isnt","in","instanceof","typeof"]);var V=["for","while","loop","if","unless","else","switch","try","catch","finally","class"];var P=["break","by","continue","debugger","delete","do","in","of","new","return","then","this","@","throw","when","until","extends"];var B=J(V.concat(P));V=J(V);var I=/^('{3}|\"{3}|['\"])/;var C=/^(\/{3}|\/)/;var L=["Infinity","NaN","undefined","null","true","false","on","off","yes","no"];var R=J(L);function G(e,b){if(e.sol()){if(b.scope.align===null){b.scope.align=false}var Y=b.scope.offset;if(e.eatSpace()){var c=e.indentation();if(c>Y&&b.scope.type=="coffee"){return"indent"}else{if(c<Y){return"dedent"}}return null}else{if(Y>0){X(e,b)}}}if(e.eatSpace()){return null}var a=e.peek();if(e.match("####")){e.skipToEnd();return"comment"}if(e.match("###")){b.tokenize=M;return b.tokenize(e,b)}if(a==="#"){e.skipToEnd();return"comment"}if(e.match(/^-?[0-9\.]/,false)){var d=false;if(e.match(/^-?\d*\.\d+(e[\+\-]?\d+)?/i)){d=true}if(e.match(/^-?\d+\.\d*/)){d=true}if(e.match(/^-?\.\d+/)){d=true}if(d){if(e.peek()=="."){e.backUp(1)}return"number"}var Z=false;if(e.match(/^-?0x[0-9a-f]+/i)){Z=true}if(e.match(/^-?[1-9]\d*(e[\+\-]?\d+)?/)){Z=true}if(e.match(/^-?0(?![\dx])/i)){Z=true}if(Z){return"number"}}if(e.match(I)){b.tokenize=W(e.current(),false,"string");return b.tokenize(e,b)}if(e.match(C)){if(e.current()!="/"||e.match(/^.*\//,false)){b.tokenize=W(e.current(),true,"string-2");return b.tokenize(e,b)}else{e.backUp(1)}}if(e.match(U)||e.match(D)){return"operator"}if(e.match(K)){return"punctuation"}if(e.match(R)){return"atom"}if(e.match(H)||b.prop&&e.match(T)){return"property"}if(e.match(B)){return"keyword"}if(e.match(T)){return"variable"}e.next();return E}function W(a,Y,Z){return function(c,b){while(!c.eol()){c.eatWhile(/[^'"\/\\]/);if(c.eat("\\")){c.next();if(Y&&c.eol()){return Z}}else{if(c.match(a)){b.tokenize=G;return Z}else{c.eat(/['"\/]/)}}}if(Y){if(O.singleLineStringErrors){Z=E}else{b.tokenize=G}}return Z}}function M(Z,Y){while(!Z.eol()){Z.eatWhile(/[^#]/);if(Z.match("###")){Y.tokenize=G;break}Z.eatWhile("#")}return"comment"}function Q(e,d,Y){Y=Y||"coffee";var Z=0,b=false,c=null;for(var a=d.scope;a;a=a.prev){if(a.type==="coffee"||a.type=="}"){Z=a.offset+S.indentUnit;break}}if(Y!=="coffee"){b=null;c=e.column()+e.current().length}else{if(d.scope.align){d.scope.align=false}}d.scope={offset:Z,type:Y,prev:d.scope,align:b,alignOffset:c}}function X(c,b){if(!b.scope.prev){return}if(b.scope.type==="coffee"){var a=c.indentation();var Z=false;for(var Y=b.scope;Y;Y=Y.prev){if(a===Y.offset){Z=true;break}}if(!Z){return true}while(b.scope.prev&&b.scope.offset!==a){b.scope=b.scope.prev}return false}else{b.scope=b.scope.prev;return false}}function N(c,a){var Y=a.tokenize(c,a);var Z=c.current();if(Z==="return"){a.dedent=true}if(((Z==="->"||Z==="=>")&&c.eol())||Y==="indent"){Q(c,a)}var b="[({".indexOf(Z);if(b!==-1){Q(c,a,"])}".slice(b,b+1))}if(V.exec(Z)){Q(c,a)}if(Z=="then"){X(c,a)}if(Y==="dedent"){if(X(c,a)){return E}}b="])}".indexOf(Z);if(b!==-1){while(a.scope.type=="coffee"&&a.scope.prev){a.scope=a.scope.prev}if(a.scope.type==Z){a.scope=a.scope.prev}}if(a.dedent&&c.eol()){if(a.scope.type=="coffee"&&a.scope.prev){a.scope=a.scope.prev}a.dedent=false}return Y}var F={startState:function(Y){return{tokenize:G,scope:{offset:Y||0,type:"coffee",prev:null,align:false},prop:false,dedent:0}},token:function(b,a){var Y=a.scope.align===null&&a.scope;if(Y&&b.sol()){Y.align=false}var Z=N(b,a);if(Z&&Z!="comment"){if(Y){Y.align=true}a.prop=Z=="punctuation"&&b.current()=="."}return Z},indent:function(c,a){if(c.tokenize!=G){return 0}var b=c.scope;var Z=a&&"])}".indexOf(a.charAt(0))>-1;if(Z){while(b.type=="coffee"&&b.prev){b=b.prev}}var Y=Z&&b.type===a.charAt(0);if(b.align){return b.alignOffset-(Y?1:0)}else{return(Y?b.prev:b).offset}},lineComment:"#",fold:"indent"};return F});A.defineMIME("text/x-coffeescript","coffeescript");A.defineMIME("text/coffeescript","coffeescript")});