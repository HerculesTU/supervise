(function(A){if(typeof exports=="object"&&typeof module=="object"){A(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],A)}else{A(CodeMirror)}}})(function(A){A.defineMode("tiki",function(B){function E(Y,X,Z){return function(b,a){while(!b.eol()){if(b.match(X)){a.tokenize=C;break}b.next()}if(Z){a.tokenize=Z}return Y}}function K(X){return function(Z,Y){while(!Z.eol()){Z.next()}Y.tokenize=C;return X}}function C(b,a){function X(c){a.tokenize=c;return c(b,a)}var Y=b.sol();var Z=b.next();switch(Z){case"{":b.eat("/");b.eatSpace();b.eatWhile(/[^\s\u00a0=\"\'\/?(}]/);a.tokenize=S;return"tag";case"_":if(b.eat("_")){return X(E("strong","__",C))}break;case"'":if(b.eat("'")){return X(E("em","''",C))}break;case"(":if(b.eat("(")){return X(E("variable-2","))",C))}break;case"[":return X(E("variable-3","]",C));break;case"|":if(b.eat("|")){return X(E("comment","||"))}break;case"-":if(b.eat("=")){return X(E("header string","=-",C))}else{if(b.eat("-")){return X(E("error tw-deleted","--",C))}}break;case"=":if(b.match("==")){return X(E("tw-underline","===",C))}break;case":":if(b.eat(":")){return X(E("comment","::"))}break;case"^":return X(E("tw-box","^"));break;case"~":if(b.match("np~")){return X(E("meta","~/np~"))}break}if(Y){switch(Z){case"!":if(b.match("!!!!!")){return X(K("header string"))}else{if(b.match("!!!!")){return X(K("header string"))}else{if(b.match("!!!")){return X(K("header string"))}else{if(b.match("!!")){return X(K("header string"))}else{return X(K("header string"))}}}}break;case"*":case"#":case"+":return X(K("tw-listitem bracket"));break}}return null}var O=B.indentUnit;var P,V;function S(a,Z){var Y=a.next();var X=a.peek();if(Y=="}"){Z.tokenize=C;return"tag"}else{if(Y=="("||Y==")"){return"bracket"}else{if(Y=="="){V="equals";if(X==">"){Y=a.next();X=a.peek()}if(!/[\'\"]/.test(X)){Z.tokenize=L()}return"operator"}else{if(/[\'\"]/.test(Y)){Z.tokenize=N(Y);return Z.tokenize(a,Z)}else{a.eatWhile(/[^\s\u00a0=\"\'\/?]/);return"keyword"}}}}}function N(X){return function(Z,Y){while(!Z.eol()){if(Z.next()==X){Y.tokenize=S;break}}return"string"}}function L(){return function(a,Z){while(!a.eol()){var Y=a.next();var X=a.peek();if(Y==" "||Y==","||/[ )}]/.test(X)){Z.tokenize=S;break}}return"string"}}var M,J;function U(){for(var X=arguments.length-1;X>=0;X--){M.cc.push(arguments[X])}}function D(){U.apply(null,arguments);return true}function I(Z,X){var Y=M.context&&M.context.noIndent;M.context={prev:M.context,pluginName:Z,indent:M.indented,startOfLine:X,noIndent:Y}}function Q(){if(M.context){M.context=M.context.prev}}function R(X){if(X=="openPlugin"){M.pluginName=P;return D(T,G(M.startOfLine))}else{if(X=="closePlugin"){var Y=false;if(M.context){Y=M.context.pluginName!=P;Q()}else{Y=true}if(Y){J="error"}return D(F(Y))}else{if(X=="string"){if(!M.context||M.context.name!="!cdata"){I("!cdata")}if(M.tokenize==C){Q()}return D()}else{return D()}}}}function G(X){return function(Y){if(Y=="selfclosePlugin"||Y=="endPlugin"){return D()}if(Y=="endPlugin"){I(M.pluginName,X);return D()}return D()}}function F(X){return function(Y){if(X){J="error"}if(Y=="endPlugin"){return D()}return U()}}function T(X){if(X=="keyword"){J="attribute";return D(T)}if(X=="equals"){return D(W,T)}return U()}function W(X){if(X=="keyword"){J="string";return D()}if(X=="string"){return D(H)}return U()}function H(X){if(X=="string"){return D(H)}else{return U()}}return{startState:function(){return{tokenize:C,cc:[],indented:0,startOfLine:true,pluginName:null,context:null}},token:function(a,Z){if(a.sol()){Z.startOfLine=true;Z.indented=a.indentation()}if(a.eatSpace()){return null}J=V=P=null;var Y=Z.tokenize(a,Z);if((Y||V)&&Y!="comment"){M=Z;while(true){var X=Z.cc.pop()||R;if(X(V||Y)){break}}}Z.startOfLine=false;return J||Y},indent:function(Z,Y){var X=Z.context;if(X&&X.noIndent){return 0}if(X&&/^{\//.test(Y)){X=X.prev}while(X&&!X.startOfLine){X=X.prev}if(X){return X.indent+O}else{return 0}},electricChars:"/"}});A.defineMIME("text/tiki","tiki")});