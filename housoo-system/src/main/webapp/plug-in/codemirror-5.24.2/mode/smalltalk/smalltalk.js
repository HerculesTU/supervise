(function(A){if(typeof exports=="object"&&typeof module=="object"){A(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],A)}else{A(CodeMirror)}}})(function(A){A.defineMode("smalltalk",function(B){var J=/[+\-\/\\*~<>=@%|&?!.,:;^]/;var D=/true|false|nil|self|super|thisContext/;var C=function(M,N){this.next=M;this.parent=N};var H=function(N,M,O){this.name=N;this.context=M;this.eos=O};var E=function(){this.context=new C(L,null);this.expectVariable=true;this.indentation=0;this.userIndentationDelta=0};E.prototype.userIndent=function(M){this.userIndentationDelta=M>0?(M/B.indentUnit-this.indentation):0};var L=function(Q,M,P){var O=new H(null,M,false);var N=Q.next();if(N==='"'){O=G(Q,new C(G,M))}else{if(N==="'"){O=I(Q,new C(I,M))}else{if(N==="#"){if(Q.peek()==="'"){Q.next();O=K(Q,new C(K,M))}else{if(Q.eatWhile(/[^\s.{}\[\]()]/)){O.name="string-2"}else{O.name="meta"}}}else{if(N==="$"){if(Q.next()==="<"){Q.eatWhile(/[^\s>]/);Q.next()}O.name="string-2"}else{if(N==="|"&&P.expectVariable){O.context=new C(F,M)}else{if(/[\[\]{}()]/.test(N)){O.name="bracket";O.eos=/[\[{(]/.test(N);if(N==="["){P.indentation++}else{if(N==="]"){P.indentation=Math.max(0,P.indentation-1)}}}else{if(J.test(N)){Q.eatWhile(J);O.name="operator";O.eos=N!==";"}else{if(/\d/.test(N)){Q.eatWhile(/[\w\d]/);O.name="number"}else{if(/[\w_]/.test(N)){Q.eatWhile(/[\w\d_]/);O.name=P.expectVariable?(D.test(Q.current())?"keyword":"variable"):null}else{O.eos=P.expectVariable}}}}}}}}}return O};var G=function(N,M){N.eatWhile(/[^"]/);return new H("comment",N.eat('"')?M.parent:M,true)};var I=function(N,M){N.eatWhile(/[^']/);return new H("string",N.eat("'")?M.parent:M,false)};var K=function(N,M){N.eatWhile(/[^']/);return new H("string-2",N.eat("'")?M.parent:M,false)};var F=function(P,M){var O=new H(null,M,false);var N=P.next();if(N==="|"){O.context=M.parent;O.eos=true}else{P.eatWhile(/[^|]/);O.name="variable"}return O};return{startState:function(){return new E},token:function(O,N){N.userIndent(O.indentation());if(O.eatSpace()){return null}var M=N.context.next(O,N.context,N);N.context=M.context;N.expectVariable=M.eos;return M.name},blankLine:function(M){M.userIndent(0)},indent:function(O,N){var M=O.context.next===L&&N&&N.charAt(0)==="]"?-1:O.userIndentationDelta;return(O.indentation+M)*B.indentUnit},electricChars:"]"}});A.defineMIME("text/x-stsrc",{name:"smalltalk"})});