(function(A){if(typeof exports=="object"&&typeof module=="object"){A(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],A)}else{A(CodeMirror)}}})(function(A){A.defineMode("stex",function(){function I(M,L){M.cmdState.push(L)}function H(L){if(L.cmdState.length>0){return L.cmdState[L.cmdState.length-1]}else{return null}}function F(M){var L=M.cmdState.pop();if(L){L.closeBracket()}}function C(O){var L=O.cmdState;for(var M=L.length-1;M>=0;M--){var N=L[M];if(N.name=="DEFAULT"){continue}return N}return{styleIdentifier:function(){return null}}}function G(N,L,M){return function(){this.name=N;this.bracketNo=0;this.style=L;this.styles=M;this.argument=null;this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null};this.openBracket=function(){this.bracketNo++;return"bracket"};this.closeBracket=function(){}}}var J={};J["importmodule"]=G("importmodule","tag",["string","builtin"]);J["documentclass"]=G("documentclass","tag",["","atom"]);J["usepackage"]=G("usepackage","tag",["atom"]);J["begin"]=G("begin","tag",["atom"]);J["end"]=G("end","tag",["atom"]);J["DEFAULT"]=function(){this.name="DEFAULT";this.style="tag";this.styleIdentifier=this.openBracket=this.closeBracket=function(){}};function E(M,L){M.f=L}function D(L,P){var M;if(L.match(/^\\[a-zA-Z@]+/)){var O=L.current().slice(1);M=J[O]||J["DEFAULT"];M=new M();I(P,M);E(P,K);return M.style}if(L.match(/^\\[$&%#{}_]/)){return"tag"}if(L.match(/^\\[,;!\/\\]/)){return"tag"}if(L.match("\\[")){E(P,function(Q,R){return B(Q,R,"\\]")});return"keyword"}if(L.match("$$")){E(P,function(Q,R){return B(Q,R,"$$")});return"keyword"}if(L.match("$")){E(P,function(Q,R){return B(Q,R,"$")});return"keyword"}var N=L.next();if(N=="%"){L.skipToEnd();return"comment"}else{if(N=="}"||N=="]"){M=H(P);if(M){M.closeBracket(N);E(P,K)}else{return"error"}return"bracket"}else{if(N=="{"||N=="["){M=J["DEFAULT"];M=new M();I(P,M);return"bracket"}else{if(/\d/.test(N)){L.eatWhile(/[\w.%]/);return"atom"}else{L.eatWhile(/[\w\-_]/);M=C(P);if(M.name=="begin"){M.argument=L.current()}return M.styleIdentifier()}}}}}function B(M,O,L){if(M.eatSpace()){return null}if(M.match(L)){E(O,D);return"keyword"}if(M.match(/^\\[a-zA-Z@]+/)){return"tag"}if(M.match(/^[a-zA-Z]+/)){return"variable-2"}if(M.match(/^\\[$&%#{}_]/)){return"tag"}if(M.match(/^\\[,;!\/]/)){return"tag"}if(M.match(/^[\^_&]/)){return"tag"}if(M.match(/^[+\-<>|=,\/@!*:;'"`~#?]/)){return null}if(M.match(/^(\d+\.\d*|\d*\.\d+|\d+)/)){return"number"}var N=M.next();if(N=="{"||N=="}"||N=="["||N=="]"||N=="("||N==")"){return"bracket"}if(N=="%"){M.skipToEnd();return"comment"}return"error"}function K(L,O){var M=L.peek(),N;if(M=="{"||M=="["){N=H(O);N.openBracket(M);L.eat(M);E(O,D);return"bracket"}if(/[ \t\r]/.test(M)){L.eat(M);return null}E(O,D);F(O);return D(L,O)}return{startState:function(){return{cmdState:[],f:D}},copyState:function(L){return{cmdState:L.cmdState.slice(),f:L.f}},token:function(M,L){return L.f(M,L)},blankLine:function(L){L.f=D;L.cmdState.length=0},lineComment:"%"}});A.defineMIME("text/x-stex","stex");A.defineMIME("text/x-latex","stex")});