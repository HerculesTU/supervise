(function(A){if(typeof exports=="object"&&typeof module=="object"){A(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],A)}else{A(CodeMirror)}}})(function(A){A.defineMode("xquery",function(){var B=function(){function c(i){return{type:i,style:"keyword"}}var b=c("keyword a"),Z=c("keyword b"),a=c("keyword c"),V=c("operator"),U={type:"atom",style:"atom"},j={type:"punctuation",style:null},X={type:"axis_specifier",style:"qualifier"};var e={"if":b,"switch":b,"while":b,"for":b,"else":Z,"then":Z,"try":Z,"finally":Z,"catch":Z,"element":a,"attribute":a,"let":a,"implements":a,"import":a,"module":a,"namespace":a,"return":a,"super":a,"this":a,"throws":a,"where":a,"private":a,",":j,"null":U,"fn:false()":U,"fn:true()":U};var Y=["after","ancestor","ancestor-or-self","and","as","ascending","assert","attribute","before","by","case","cast","child","comment","declare","default","define","descendant","descendant-or-self","descending","document","document-node","element","else","eq","every","except","external","following","following-sibling","follows","for","function","if","import","in","instance","intersect","item","let","module","namespace","node","node","of","only","or","order","parent","precedes","preceding","preceding-sibling","processing-instruction","ref","return","returns","satisfies","schema","schema-element","self","some","sortby","stable","text","then","to","treat","typeswitch","union","variable","version","where","xquery","empty-sequence"];for(var g=0,h=Y.length;g<h;g++){e[Y[g]]=c(Y[g])}var d=["xs:string","xs:float","xs:decimal","xs:double","xs:integer","xs:boolean","xs:date","xs:dateTime","xs:time","xs:duration","xs:dayTimeDuration","xs:time","xs:yearMonthDuration","numeric","xs:hexBinary","xs:base64Binary","xs:anyURI","xs:QName","xs:byte","xs:boolean","xs:anyURI","xf:yearMonthDuration"];for(var g=0,h=d.length;g<h;g++){e[d[g]]=U}var W=["eq","ne","lt","le","gt","ge",":=","=",">",">=","<","<=",".","|","?","and","or","div","idiv","mod","*","/","+","-"];for(var g=0,h=W.length;g<h;g++){e[W[g]]=V}var f=["self::","attribute::","child::","descendant::","descendant-or-self::","parent::","ancestor::","ancestor-or-self::","following::","preceding::","following-sibling::","preceding-sibling::"];for(var g=0,h=f.length;g<h;g++){e[f[g]]=X}return e}();function P(W,V,U){V.tokenize=U;return U(W,V)}function E(b,Z){var Y=b.next(),V=false,X=D(b);if(Y=="<"){if(b.match("!--",true)){return P(b,Z,L)}if(b.match("![CDATA",false)){Z.tokenize=I;return"tag"}if(b.match("?",false)){return P(b,Z,K)}var W=b.eat("/");b.eatSpace();var f="",e;while((e=b.eat(/[^\s\u00a0=<>\"\'\/?]/))){f+=e}return P(b,Z,C(f,W))}else{if(Y=="{"){M(Z,{type:"codeblock"});return null}else{if(Y=="}"){G(Z);return null}else{if(Q(Z)){if(Y==">"){return"tag"}else{if(Y=="/"&&b.eat(">")){G(Z);return"tag"}else{return"variable"}}}else{if(/\d/.test(Y)){b.match(/^\d*(?:\.\d*)?(?:E[+\-]?\d+)?/);return"atom"}else{if(Y==="("&&b.eat(":")){M(Z,{type:"comment"});return P(b,Z,R)}else{if(!X&&(Y==='"'||Y==="'")){return P(b,Z,J(Y))}else{if(Y==="$"){return P(b,Z,N)}else{if(Y===":"&&b.eat("=")){return"keyword"}else{if(Y==="("){M(Z,{type:"paren"});return null}else{if(Y===")"){G(Z);return null}else{if(Y==="["){M(Z,{type:"bracket"});return null}else{if(Y==="]"){G(Z);return null}else{var d=B.propertyIsEnumerable(Y)&&B[Y];if(X&&Y==='"'){while(b.next()!=='"'){}}if(X&&Y==="'"){while(b.next()!=="'"){}}if(!d){b.eatWhile(/[\w\$_-]/)}var U=b.eat(":");if(!b.eat(":")&&U){b.eatWhile(/[\w\$_-]/)}if(b.match(/^[ \t]*\(/,false)){V=true}var a=b.current();d=B.propertyIsEnumerable(a)&&B[a];if(V&&!d){d={type:"function_call",style:"variable def"}}if(S(Z)){G(Z);return"variable"}if(a=="element"||a=="attribute"||d.type=="axis_specifier"){M(Z,{type:"xmlconstructor"})}return d?d.style:"variable"}}}}}}}}}}}}}}function R(Z,W){var Y=false,V=false,U=0,X;while(X=Z.next()){if(X==")"&&Y){if(U>0){U--}else{G(W);break}}else{if(X==":"&&V){U++}}Y=(X==":");V=(X=="(")}return"comment"}function J(U,V){return function(Y,X){var W;if(F(X)&&Y.current()==U){G(X);if(V){X.tokenize=V}return"string"}M(X,{type:"string",name:U,tokenize:J(U,V)});if(Y.match("{",false)&&O(X)){X.tokenize=E;return"string"}while(W=Y.next()){if(W==U){G(X);if(V){X.tokenize=V}break}else{if(Y.match("{",false)&&O(X)){X.tokenize=E;return"string"}}}return"string"}}function N(W,V){var U=/[\w\$_-]/;if(W.eat('"')){while(W.next()!=='"'){}W.eat(":")}else{W.eatWhile(U);if(!W.match(":=",false)){W.eat(":")}}W.eatWhile(U);V.tokenize=E;return"variable"}function C(V,U){return function(X,W){X.eatSpace();if(U&&X.eat(">")){G(W);W.tokenize=E;return"tag"}if(!X.eat("/")){M(W,{type:"tag",name:V,tokenize:E})}if(!X.eat(">")){W.tokenize=H;return"tag"}else{W.tokenize=E}return"tag"}}function H(W,V){var U=W.next();if(U=="/"&&W.eat(">")){if(O(V)){G(V)}if(Q(V)){G(V)}return"tag"}if(U==">"){if(O(V)){G(V)}return"tag"}if(U=="="){return null}if(U=='"'||U=="'"){return P(W,V,J(U,H))}if(!O(V)){M(V,{type:"attribute",tokenize:H})}W.eat(/[a-zA-Z_:]/);W.eatWhile(/[-a-zA-Z0-9_:.]/);W.eatSpace();if(W.match(">",false)||W.match("/",false)){G(V);V.tokenize=E}return"attribute"}function L(W,V){var U;while(U=W.next()){if(U=="-"&&W.match("->",true)){V.tokenize=E;return"comment"}}}function I(W,V){var U;while(U=W.next()){if(U=="]"&&W.match("]",true)){V.tokenize=E;return"comment"}}}function K(W,V){var U;while(U=W.next()){if(U=="?"&&W.match(">",true)){V.tokenize=E;return"comment meta"}}}function Q(U){return T(U,"tag")}function O(U){return T(U,"attribute")}function S(U){return T(U,"xmlconstructor")}function F(U){return T(U,"string")}function D(U){if(U.current()==='"'){return U.match(/^[^\"]+\"\:/,false)}else{if(U.current()==="'"){return U.match(/^[^\"]+\'\:/,false)}else{return false}}}function T(V,U){return(V.stack.length&&V.stack[V.stack.length-1].type==U)}function M(V,U){V.stack.push(U)}function G(V){V.stack.pop();var U=V.stack.length&&V.stack[V.stack.length-1].tokenize;V.tokenize=U||E}return{startState:function(){return{tokenize:E,cc:[],stack:[]}},token:function(W,V){if(W.eatSpace()){return null}var U=V.tokenize(W,V);return U},blockCommentStart:"(:",blockCommentEnd:":)"}});A.defineMIME("application/xquery","xquery")});