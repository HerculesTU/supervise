(function(A){if(typeof exports=="object"&&typeof module=="object"){A(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],A)}else{A(CodeMirror)}}})(function(I){I.defineOption("styleSelectedText",false,function(N,M,L){var K=L&&L!=I.Init;if(M&&!K){N.state.markedSelection=[];N.state.markedSelectionStyle=typeof M=="string"?M:"CodeMirror-selectedtext";B(N);N.on("cursorActivity",G);N.on("change",F)}else{if(!M&&K){N.off("cursorActivity",G);N.off("change",F);J(N);N.state.markedSelection=N.state.markedSelectionStyle=null}}});function G(K){K.operation(function(){D(K)})}function F(K){if(K.state.markedSelection.length){K.operation(function(){J(K)})}}var A=8;var C=I.Pos;var E=I.cmpPos;function H(P,L,U,V){if(E(L,U)==0){return}var T=P.state.markedSelection;var Q=P.state.markedSelectionStyle;for(var M=L.line;;){var N=M==L.line?L:C(M,0);var R=M+A,S=R>=U.line;var O=S?U:C(R,0);var K=P.markText(N,O,{className:Q});if(V==null){T.push(K)}else{T.splice(V++,0,K)}if(S){break}M=R}}function J(M){var K=M.state.markedSelection;for(var L=0;L<K.length;++L){K[L].clear()}K.length=0}function B(M){J(M);var L=M.listSelections();for(var K=0;K<L.length;K++){H(M,L[K].from(),L[K].to())}}function D(O){if(!O.somethingSelected()){return J(O)}if(O.listSelections().length>1){return B(O)}var L=O.getCursor("start"),M=O.getCursor("end");var N=O.state.markedSelection;if(!N.length){return H(O,L,M)}var P=N[0].find(),K=N[N.length-1].find();if(!P||!K||M.line-L.line<A||E(L,K.to)>=0||E(M,P.from)<=0){return B(O)}while(E(L,P.from)>0){N.shift().clear();P=N[0].find()}if(E(L,P.from)<0){if(P.to.line-L.line<A){N.shift().clear();H(O,L,P.to,0)}else{H(O,L,P.from,0)}}while(E(M,K.to)<0){N.pop().clear();K=N[N.length-1].find()}if(E(M,K.to)>0){if(M.line-K.from.line<A){N.pop().clear();H(O,K.from,M)}else{H(O,K.to,M)}}}});