(function(A){if(typeof exports=="object"&&typeof module=="object"){A(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],A)}else{A(CodeMirror)}}})(function(G){var E="CodeMirror-activeline";var C="CodeMirror-activeline-background";var F="CodeMirror-activeline-gutter";G.defineOption("styleActiveLine",false,function(L,K,J){var I=J==G.Init?false:J;if(K==I){return}if(I){L.off("beforeSelectionChange",A);B(L);delete L.state.activeLines}if(K){L.state.activeLines=[];H(L,L.listSelections());L.on("beforeSelectionChange",A)}});function B(J){for(var I=0;I<J.state.activeLines.length;I++){J.removeLineClass(J.state.activeLines[I],"wrap",E);J.removeLineClass(J.state.activeLines[I],"background",C);J.removeLineClass(J.state.activeLines[I],"gutter",F)}}function D(K,J){if(K.length!=J.length){return false}for(var I=0;I<K.length;I++){if(K[I]!=J[I]){return false}}return true}function H(N,L){var K=[];for(var I=0;I<L.length;I++){var O=L[I];var J=N.getOption("styleActiveLine");if(typeof J=="object"&&J.nonEmpty?O.anchor.line!=O.head.line:!O.empty()){continue}var M=N.getLineHandleVisualStart(O.head.line);if(K[K.length-1]!=M){K.push(M)}}if(D(N.state.activeLines,K)){return}N.operation(function(){B(N);for(var P=0;P<K.length;P++){N.addLineClass(K[P],"wrap",E);N.addLineClass(K[P],"background",C);N.addLineClass(K[P],"gutter",F)}N.state.activeLines=K})}function A(J,I){H(J,I.ranges)}});