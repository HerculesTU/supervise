/* WebUploader 0.1.5 */
(function(I,E){var H={},F=function(M,K){var O,N,L;if(typeof M==="string"){return J(M)}else{O=[];for(N=M.length,L=0;L<N;L++){O.push(J(M[L]))}return K.apply(null,O)}},A=function(M,L,K){if(arguments.length===2){K=L;L=null}F(L||[],function(){D(M,K,arguments)})},D=function(O,K,N){var M={exports:K},L;if(typeof K==="function"){N.length||(N=[F,M.exports,M]);L=K.apply(null,N);L!==undefined&&(M.exports=L)}H[O]=M.exports},J=function(L){var K=H[L]||I[L];if(!K){throw new Error("`"+L+"` is undefined")}return K},C=function(M){var L,N,K,O,P,Q;Q=function(R){return R&&(R.charAt(0).toUpperCase()+R.substr(1))};for(L in H){N=M;if(!H.hasOwnProperty(L)){continue}K=L.split("/");P=Q(K.pop());while((O=Q(K.shift()))){N[O]=N[O]||{};N=N[O]}N[P]=H[L]}return M},B=function(K){I.__dollar=K;return C(E(I,A,F))},G;if(typeof module==="object"&&typeof module.exports==="object"){module.exports=B()}else{if(typeof define==="function"&&define.amd){define(["jquery"],B)}else{G=I.WebUploader;I.WebUploader=B();I.WebUploader.noConflict=function(){I.WebUploader=G}}}})(window,function(A,C,B){C("dollar-third",[],function(){var D=A.__dollar||A.jQuery||A.Zepto;if(!D){throw new Error("jQuery or Zepto not found!")}return D});C("dollar",["dollar-third"],function(D){return D});C("promise-third",["dollar"],function(D){return{Deferred:D.Deferred,when:D.when,isPromise:function(E){return E&&typeof E.then==="function"}}});C("promise",["promise-third"],function(D){return D});C("base",["dollar","promise"],function(J,H){var I=function(){},E=Function.call;function D(K){return function(){return E.apply(K,arguments)}}function G(L,K){return function(){return L.apply(K,arguments)}}function F(K){var L;if(Object.create){return Object.create(K)}else{L=function(){};L.prototype=K;return new L()}}return{version:"0.1.5",$:J,Deferred:H.Deferred,isPromise:H.isPromise,when:H.when,browser:(function(O){var P={},R=O.match(/WebKit\/([\d.]+)/),L=O.match(/Chrome\/([\d.]+)/)||O.match(/CriOS\/([\d.]+)/),M=O.match(/MSIE\s([\d\.]+)/)||O.match(/(?:trident)(?:.*rv:([\w.]+))?/i),N=O.match(/Firefox\/([\d.]+)/),K=O.match(/Safari\/([\d.]+)/),Q=O.match(/OPR\/([\d.]+)/);R&&(P.webkit=parseFloat(R[1]));L&&(P.chrome=parseFloat(L[1]));M&&(P.ie=parseFloat(M[1]));N&&(P.firefox=parseFloat(N[1]));K&&(P.safari=parseFloat(K[1]));Q&&(P.opera=parseFloat(Q[1]));return P})(navigator.userAgent),os:(function(N){var L={},M=N.match(/(?:Android);?[\s\/]+([\d.]+)?/),K=N.match(/(?:iPad|iPod|iPhone).*OS\s([\d_]+)/);M&&(L.android=parseFloat(M[1]));K&&(L.ios=parseFloat(K[1].replace(/_/g,".")));return L})(navigator.userAgent),inherits:function(N,M,L){var K;if(typeof M==="function"){K=M;M=null}else{if(M&&M.hasOwnProperty("constructor")){K=M.constructor}else{K=function(){return N.apply(this,arguments)}}}J.extend(true,K,N,L||{});K.__super__=N.prototype;K.prototype=F(N.prototype);M&&J.extend(true,K.prototype,M);return K},noop:I,bindFn:G,log:(function(){if(A.console){return G(console.log,console)}return I})(),nextTick:(function(){return function(K){setTimeout(K,1)}})(),slice:D([].slice),guid:(function(){var K=0;return function(N){var L=(+new Date()).toString(32),M=0;for(;M<5;M++){L+=Math.floor(Math.random()*65535).toString(32)}return(N||"wu_")+L+(K++).toString(32)}})(),formatSize:function(K,M,N){var L;N=N||["B","K","M","G","TB"];while((L=N.shift())&&K>1024){K=K/1024}return(L==="B"?K:K.toFixed(M||2))+L}}});C("mediator",["base"],function(K){var J=K.$,D=[].slice,G=/\s+/,I;function F(O,N,L,M){return J.grep(O,function(P){return P&&(!N||P.e===N)&&(!L||P.cb===L||P.cb._cb===L)&&(!M||P.ctx===M)})}function H(N,L,M){J.each((N||"").split(G),function(P,O){M(O,L)})}function E(P,Q){var M=false,L=-1,O=P.length,N;while(++L<O){N=P[L];if(N.cb.apply(N.ctx2,Q)===false){M=true;break}}return !M}I={on:function(N,L,M){var O=this,P;if(!L){return this}P=this._events||(this._events=[]);H(N,L,function(S,Q){var R={e:S};R.cb=Q;R.ctx=M;R.ctx2=M||O;R.id=P.length;P.push(R)});return this},once:function(N,L,M){var O=this;if(!L){return O}H(N,L,function(Q,P){var R=function(){O.off(Q,R);return P.apply(M||O,arguments)};R._cb=P;O.on(Q,R,M)});return O},off:function(M,L,O){var N=this._events;if(!N){return this}if(!M&&!L&&!O){this._events=[];return this}H(M,L,function(Q,P){J.each(F(N,Q,P,O),function(){delete N[this.id]})});return this},trigger:function(L){var O,N,M;if(!this._events||!L){return this}O=D.call(arguments,1);N=F(this._events,L);M=F(this._events,"all");return E(N,O)&&E(M,arguments)}};return J.extend({installTo:function(L){return J.extend(L,I)}},I)});C("uploader",["base","mediator"],function(E,F){var G=E.$;function D(H){this.options=G.extend(true,{},D.options,H);this._init(this.options)}D.options={};F.installTo(D.prototype);G.each({upload:"start-upload",stop:"stop-upload",getFile:"get-file",getFiles:"get-files",addFile:"add-file",addFiles:"add-file",sort:"sort-files",removeFile:"remove-file",cancelFile:"cancel-file",skipFile:"skip-file",retry:"retry",isInProgress:"is-in-progress",makeThumb:"make-thumb",md5File:"md5-file",getDimension:"get-dimension",addButton:"add-btn",predictRuntimeType:"predict-runtime-type",refresh:"refresh",disable:"disable",enable:"enable",reset:"reset"},function(H,I){D.prototype[H]=function(){return this.request(I,arguments)}});G.extend(D.prototype,{state:"pending",_init:function(H){var I=this;I.request("init",H,function(){I.state="ready";I.trigger("ready")})},option:function(H,J){var I=this.options;if(arguments.length>1){if(G.isPlainObject(J)&&G.isPlainObject(I[H])){G.extend(I[H],J)}else{I[H]=J}}else{return H?I[H]:I}},getStats:function(){var H=this.request("get-stats");return H?{successNum:H.numOfSuccess,progressNum:H.numOfProgress,cancelNum:H.numOfCancel,invalidNum:H.numOfInvalid,uploadFailNum:H.numOfUploadFailed,queueNum:H.numOfQueue,interruptNum:H.numofInterrupt}:{}},trigger:function(H){var K=[].slice.call(arguments,1),I=this.options,J="on"+H.substring(0,1).toUpperCase()+H.substring(1);if(F.trigger.apply(this,arguments)===false||G.isFunction(I[J])&&I[J].apply(this,K)===false||G.isFunction(this[J])&&this[J].apply(this,K)===false||F.trigger.apply(F,[this,H].concat(K))===false){return false}return true},destroy:function(){this.request("destroy",arguments);this.off()},request:E.noop});E.create=D.create=function(H){return new D(H)};E.Uploader=D;return D});C("runtime/runtime",["base","mediator"],function(G,H){var I=G.$,F={},E=function(K){for(var J in K){if(K.hasOwnProperty(J)){return J}}return null};function D(J){this.options=I.extend({container:document.body},J);this.uid=G.guid("rt_")}I.extend(D.prototype,{getContainer:function(){var J=this.options,L,K;if(this._container){return this._container}L=I(J.container||document.body);K=I(document.createElement("div"));K.attr("id","rt_"+this.uid);K.css({position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"});L.append(K);L.addClass("webuploader-container");this._container=K;this._parent=L;return K},init:G.noop,exec:G.noop,destroy:function(){this._container&&this._container.remove();this._parent&&this._parent.removeClass("webuploader-container");this.off()}});D.orders="html5,flash";D.addRuntime=function(J,K){F[J]=K};D.hasRuntime=function(J){return !!(J?F[J]:E(F))};D.create=function(K,M){var J,L;M=M||D.orders;I.each(M.split(/\s*,\s*/g),function(){if(F[this]){J=this;return false}});J=J||E(F);if(!J){throw new Error("Runtime Error")}L=new F[J](K);return L};H.installTo(D.prototype);return D});C("runtime/client",["base","mediator","runtime/runtime"],function(G,H,E){var D;D=(function(){var I={};return{add:function(J){I[J.uid]=J},get:function(J,L){var K;if(J){return I[J]}for(K in I){if(L&&I[K].__standalone){continue}return I[K]}return null},remove:function(J){delete I[J.uid]}}})();function F(J,I){var K=G.Deferred(),L;this.uid=G.guid("client_");this.runtimeReady=function(M){return K.done(M)};this.connectRuntime=function(N,M){if(L){throw new Error("already connected!")}K.done(M);if(typeof N==="string"&&D.get(N)){L=D.get(N)}L=L||D.get(null,I);if(!L){L=E.create(N,N.runtimeOrder);L.__promise=K.promise();L.once("ready",K.resolve);L.init();D.add(L);L.__client=1}else{G.$.extend(L.options,N);L.__promise.then(K.resolve);L.__client++}I&&(L.__standalone=I);return L};this.getRuntime=function(){return L};this.disconnectRuntime=function(){if(!L){return}L.__client--;if(L.__client<=0){D.remove(L);delete L.__promise;L.destroy()}L=null};this.exec=function(){if(!L){return}var M=G.slice(arguments);J&&M.unshift(J);return L.exec.apply(this,M)};this.getRuid=function(){return L&&L.uid};this.destroy=(function(M){return function(){M&&M.apply(this,arguments);this.trigger("destroy");this.off();this.exec("destroy");this.disconnectRuntime()}})(this.destroy)}H.installTo(F.prototype);return F});C("lib/dnd",["base","mediator","runtime/client"],function(F,G,E){var H=F.$;function D(I){I=this.options=H.extend({},D.options,I);I.container=H(I.container);if(!I.container.length){return}E.call(this,"DragAndDrop")}D.options={accept:null,disableGlobalDnd:false};F.inherits(E,{constructor:D,init:function(){var I=this;I.connectRuntime(I.options,function(){I.exec("init");I.trigger("ready")})}});G.installTo(D.prototype);return D});C("widgets/widget",["base","uploader"],function(L,E){var J=L.$,F=E.prototype._init,K=E.prototype.destroy,H={},G=[];function D(O){if(!O){return false}var N=O.length,M=J.type(O);if(O.nodeType===1&&N){return true}return M==="array"||M!=="function"&&M!=="string"&&(N===0||typeof N==="number"&&N>0&&(N-1) in O)}function I(M){this.owner=M;this.options=M.options}J.extend(I.prototype,{init:L.noop,invoke:function(N,O){var M=this.responseMap;if(!M||!(N in M)||!(M[N] in this)||!J.isFunction(this[M[N]])){return H}return this[M[N]].apply(this,O)},request:function(){return this.owner.request.apply(this.owner,arguments)}});J.extend(E.prototype,{_init:function(){var M=this,N=M._widgets=[],O=M.options.disableWidgets||"";J.each(G,function(Q,P){(!O||!~O.indexOf(P._name))&&N.push(new P(M))});return F.apply(M,arguments)},request:function(X,N,O){var R=0,V=this._widgets,M=V&&V.length,W=[],Q=[],T,P,U,S;N=D(N)?N:[N];for(;R<M;R++){T=V[R];P=T.invoke(X,N);if(P!==H){if(L.isPromise(P)){Q.push(P)}else{W.push(P)}}}if(O||Q.length){U=L.when.apply(L,Q);S=U.pipe?"pipe":"then";return U[S](function(){var Y=L.Deferred(),Z=arguments;if(Z.length===1){Z=Z[0]}setTimeout(function(){Y.resolve(Z)},1);return Y.promise()})[O?S:"done"](O||L.noop)}else{return W[0]}},destroy:function(){K.apply(this,arguments);this._widgets=null}});E.register=I.register=function(P,M){var N={init:"init",destroy:"destroy",name:"anonymous"},O;if(arguments.length===1){M=P;J.each(M,function(Q){if(Q[0]==="_"||Q==="name"){Q==="name"&&(N.name=M.name);return}N[Q.replace(/[A-Z]/g,"-$&").toLowerCase()]=Q})}else{N=J.extend(N,P)}M.responseMap=N;O=L.inherits(I,M);O._name=N.name;G.push(O);return O};E.unRegister=I.unRegister=function(N){if(!N||N==="anonymous"){return}for(var M=G.length;M--;){if(G[M]._name===N){G.splice(M,1)}}};return I});C("widgets/filednd",["base","uploader","lib/dnd","widgets/widget"],function(F,E,D){var G=F.$;E.options.dnd="";return E.register({name:"dnd",init:function(I){if(!I.dnd||this.request("predict-runtime-type")!=="html5"){return}var K=this,L=F.Deferred(),J=G.extend({},{disableGlobalDnd:I.disableGlobalDnd,container:I.dnd,accept:I.accept}),H;this.dnd=H=new D(J);H.once("ready",L.resolve);H.on("drop",function(M){K.request("add-file",[M])});H.on("accept",function(M){return K.owner.trigger("dndAccept",M)});H.init();return L.promise()},destroy:function(){this.dnd&&this.dnd.destroy()}})});C("lib/filepaste",["base","mediator","runtime/client"],function(E,G,D){var H=E.$;function F(I){I=this.options=H.extend({},I);I.container=H(I.container||document.body);D.call(this,"FilePaste")}E.inherits(D,{constructor:F,init:function(){var I=this;I.connectRuntime(I.options,function(){I.exec("init");I.trigger("ready")})}});G.installTo(F.prototype);return F});C("widgets/filepaste",["base","uploader","lib/filepaste","widgets/widget"],function(E,D,F){var G=E.$;return D.register({name:"paste",init:function(H){if(!H.paste||this.request("predict-runtime-type")!=="html5"){return}var J=this,K=E.Deferred(),I=G.extend({},{container:H.paste,accept:H.accept}),L;this.paste=L=new F(I);L.once("ready",K.resolve);L.on("paste",function(M){J.owner.request("add-file",[M])});L.init();return K.promise()},destroy:function(){this.paste&&this.paste.destroy()}})});C("lib/blob",["base","runtime/client"],function(E,F){function D(G,H){var I=this;I.source=H;I.ruid=G;this.size=H.size||0;if(!H.type&&this.ext&&~"jpg,jpeg,png,gif,bmp".indexOf(this.ext)){this.type="image/"+(this.ext==="jpg"?"jpeg":this.ext)}else{this.type=H.type||"application/octet-stream"}F.call(I,"Blob");this.uid=H.uid||this.uid;if(G){I.connectRuntime(G)}}E.inherits(F,{constructor:D,slice:function(H,G){return this.exec("slice",H,G)},getSource:function(){return this.source}});return D});C("lib/file",["base","lib/blob"],function(F,D){var E=1,G=/\.([^.]+)$/;function H(J,K){var I;this.name=K.name||("untitled"+E++);I=G.exec(K.name)?RegExp.$1.toLowerCase():"";if(!I&&K.type){I=/\/(jpg|jpeg|png|gif|bmp)$/i.exec(K.type)?RegExp.$1.toLowerCase():"";this.name+="."+I}this.ext=I;this.lastModifiedDate=K.lastModifiedDate||(new Date()).toLocaleString();D.apply(this,arguments)}return F.inherits(D,H)});C("lib/filepicker",["base","runtime/client","lib/file"],function(F,G,H){var D=F.$;function E(I){I=this.options=D.extend({},E.options,I);I.container=D(I.id);if(!I.container.length){throw new Error("按钮指定错误")}I.innerHTML=I.innerHTML||I.label||I.container.html()||"";I.button=D(I.button||document.createElement("div"));I.button.html(I.innerHTML);I.container.html(I.button);G.call(this,"FilePicker",true)}E.options={button:null,container:null,label:null,innerHTML:null,multiple:true,accept:null,name:"file"};F.inherits(G,{constructor:E,init:function(){var K=this,J=K.options,I=J.button;I.addClass("webuploader-pick");K.on("all",function(L){var M;switch(L){case"mouseenter":I.addClass("webuploader-pick-hover");break;case"mouseleave":I.removeClass("webuploader-pick-hover");break;case"change":M=K.exec("getFiles");K.trigger("select",D.map(M,function(N){N=new H(K.getRuid(),N);N._refer=J.container;return N}),J.container);break}});K.connectRuntime(J,function(){K.refresh();K.exec("init",J);K.trigger("ready")});this._resizeHandler=F.bindFn(this.refresh,this);D(A).on("resize",this._resizeHandler)},refresh:function(){var I=this.getRuntime().getContainer(),J=this.options.button,M=J.outerWidth?J.outerWidth():J.width(),L=J.outerHeight?J.outerHeight():J.height(),K=J.offset();M&&L&&I.css({bottom:"auto",right:"auto",width:M+"px",height:L+"px"}).offset(K)},enable:function(){var I=this.options.button;I.removeClass("webuploader-pick-disable");this.refresh()},disable:function(){var I=this.options.button;this.getRuntime().getContainer().css({top:"-99999px"});I.addClass("webuploader-pick-disable")},destroy:function(){var I=this.options.button;D(A).off("resize",this._resizeHandler);I.removeClass("webuploader-pick-disable webuploader-pick-hover webuploader-pick")}});return E});C("widgets/filepicker",["base","uploader","lib/filepicker","widgets/widget"],function(F,D,E){var G=F.$;G.extend(D.options,{pick:null,accept:null});return D.register({name:"picker",init:function(H){this.pickers=[];return H.pick&&this.addBtn(H.pick)},refresh:function(){G.each(this.pickers,function(){this.refresh()})},addBtn:function(H){var J=this,I=J.options,L=I.accept,K=[];if(!H){return}G.isPlainObject(H)||(H={id:H});G(H.id).each(function(){var N,O,M;M=F.Deferred();N=G.extend({},H,{accept:G.isPlainObject(L)?[L]:L,swf:I.swf,runtimeOrder:I.runtimeOrder,id:this});O=new E(N);O.once("ready",M.resolve);O.on("select",function(P){J.owner.request("add-file",[P])});O.init();J.pickers.push(O);K.push(M.promise())});return F.when.apply(F,K)},disable:function(){G.each(this.pickers,function(){this.disable()})},enable:function(){G.each(this.pickers,function(){this.enable()})},destroy:function(){G.each(this.pickers,function(){this.destroy()});this.pickers=null}})});C("file",["base","mediator"],function(L,H){var I=L.$,D="WU_FILE_",F=0,K=/\.([^.]+)$/,G={};function J(){return D+F++}function E(M){this.name=M.name||"Untitled";this.size=M.size||0;this.type=M.type||"application/octet-stream";this.lastModifiedDate=M.lastModifiedDate||(new Date()*1);this.id=J();this.ext=K.exec(this.name)?RegExp.$1:"";this.statusText="";G[this.id]=E.Status.INITED;this.source=M;this.loaded=0;this.on("error",function(N){this.setStatus(E.Status.ERROR,N)})}I.extend(E.prototype,{setStatus:function(N,O){var M=G[this.id];typeof O!=="undefined"&&(this.statusText=O);if(N!==M){G[this.id]=N;this.trigger("statuschange",N,M)}},getStatus:function(){return G[this.id]},getSource:function(){return this.source},destroy:function(){this.off();delete G[this.id]}});H.installTo(E.prototype);E.Status={INITED:"inited",QUEUED:"queued",PROGRESS:"progress",ERROR:"error",COMPLETE:"complete",CANCELLED:"cancelled",INTERRUPT:"interrupt",INVALID:"invalid"};return E});C("queue",["base","mediator","file"],function(G,H,F){var I=G.$,E=F.Status;function D(){this.stats={numOfQueue:0,numOfSuccess:0,numOfCancel:0,numOfProgress:0,numOfUploadFailed:0,numOfInvalid:0,numofDeleted:0,numofInterrupt:0,};this._queue=[];this._map={}}I.extend(D.prototype,{append:function(J){this._queue.push(J);this._fileAdded(J);return this},prepend:function(J){this._queue.unshift(J);this._fileAdded(J);return this},getFile:function(J){if(typeof J!=="string"){return J}return this._map[J]},fetch:function(K){var L=this._queue.length,J,M;K=K||E.QUEUED;for(J=0;J<L;J++){M=this._queue[J];if(K===M.getStatus()){return M}}return null},sort:function(J){if(typeof J==="function"){this._queue.sort(J)}},getFiles:function(){var K=[].slice.call(arguments,0),L=[],J=0,M=this._queue.length,N;for(;J<M;J++){N=this._queue[J];if(K.length&&!~I.inArray(N.getStatus(),K)){continue}L.push(N)}return L},removeFile:function(L){var J=this,K=this._map[L.id];if(K){delete this._map[L.id];L.destroy();this.stats.numofDeleted++}},_fileAdded:function(L){var J=this,K=this._map[L.id];if(!K){this._map[L.id]=L;L.on("statuschange",function(M,N){J._onFileStatusChange(M,N)})}},_onFileStatusChange:function(K,L){var J=this.stats;switch(L){case E.PROGRESS:J.numOfProgress--;break;case E.QUEUED:J.numOfQueue--;break;case E.ERROR:J.numOfUploadFailed--;break;case E.INVALID:J.numOfInvalid--;break;case E.INTERRUPT:J.numofInterrupt--;break}switch(K){case E.QUEUED:J.numOfQueue++;break;case E.PROGRESS:J.numOfProgress++;break;case E.ERROR:J.numOfUploadFailed++;break;case E.COMPLETE:J.numOfSuccess++;break;case E.CANCELLED:J.numOfCancel++;break;case E.INVALID:J.numOfInvalid++;break;case E.INTERRUPT:J.numofInterrupt++;break}}});H.installTo(D.prototype);return D});C("widgets/queue",["base","uploader","queue","file","lib/file","runtime/client","widgets/widget"],function(L,E,G,D,H,F){var J=L.$,K=/\.\w+$/,I=D.Status;return E.register({name:"queue",init:function(Q){var S=this,R,T,P,U,O,N,M;if(J.isPlainObject(Q.accept)){Q.accept=[Q.accept]}if(Q.accept){O=[];for(P=0,T=Q.accept.length;P<T;P++){U=Q.accept[P].extensions;U&&O.push(U)}if(O.length){N="\\."+O.join(",").replace(/,/g,"$|\\.").replace(/\*/g,".*")+"$"}S.accept=new RegExp(N,"i")}S.queue=new G();S.stats=S.queue.stats;if(this.request("predict-runtime-type")!=="html5"){return}R=L.Deferred();this.placeholder=M=new F("Placeholder");M.connectRuntime({runtimeOrder:"html5"},function(){S._ruid=M.getRuid();R.resolve()});return R.promise()},_wrapFile:function(M){if(!(M instanceof D)){if(!(M instanceof H)){if(!this._ruid){throw new Error("Can't add external files.")}M=new H(this._ruid,M)}M=new D(M)}return M},acceptFile:function(N){var M=!N||!N.size||this.accept&&K.exec(N.name)&&!this.accept.test(N.name);return !M},_addFile:function(N){var M=this;N=M._wrapFile(N);if(!M.owner.trigger("beforeFileQueued",N)){return}if(!M.acceptFile(N)){M.owner.trigger("error","Q_TYPE_DENIED",N);return}M.queue.append(N);M.owner.trigger("fileQueued",N);return N},getFile:function(M){return this.queue.getFile(M)},addFile:function(N){var M=this;if(!N.length){N=[N]}N=J.map(N,function(O){return M._addFile(O)});M.owner.trigger("filesQueued",N);if(M.options.auto){setTimeout(function(){M.request("start-upload")},20)}},getStats:function(){return this.stats},removeFile:function(O,M){var N=this;O=O.id?O:N.queue.getFile(O);this.request("cancel-file",O);if(M){this.queue.removeFile(O)}},getFiles:function(){return this.queue.getFiles.apply(this.queue,arguments)},fetchFile:function(){return this.queue.fetch.apply(this.queue,arguments)},retry:function(R,O){var M=this,Q,N,P;if(R){R=R.id?R:M.queue.getFile(R);R.setStatus(I.QUEUED);O||M.request("start-upload");return}Q=M.queue.getFiles(I.ERROR);N=0;P=Q.length;for(;N<P;N++){R=Q[N];R.setStatus(I.QUEUED)}M.request("start-upload")},sortFiles:function(){return this.queue.sort.apply(this.queue,arguments)},reset:function(){this.owner.trigger("reset");this.queue=new G();this.stats=this.queue.stats},destroy:function(){this.reset();this.placeholder&&this.placeholder.destroy()}})});C("widgets/runtime",["uploader","runtime/runtime","widgets/widget"],function(D,E){D.support=function(){return E.hasRuntime.apply(E,arguments)};return D.register({name:"runtime",init:function(){if(!this.predictRuntimeType()){throw Error("Runtime Error")}},predictRuntimeType:function(){var I=this.options.runtimeOrder||E.orders,F=this.type,G,H;if(!F){I=I.split(/\s*,\s*/g);for(G=0,H=I.length;G<H;G++){if(E.hasRuntime(I[G])){this.type=F=I[G];break}}}return F}})});C("lib/transport",["base","runtime/client","mediator"],function(F,G,D){var H=F.$;function E(I){var J=this;I=J.options=H.extend(true,{},E.options,I||{});G.call(this,"Transport");this._blob=null;this._formData=I.formData||{};this._headers=I.headers||{};this.on("progress",this._timeout);this.on("load error",function(){J.trigger("progress",1);clearTimeout(J._timer)})}E.options={server:"",method:"POST",withCredentials:false,fileVal:"file",timeout:2*60*1000,formData:{},headers:{},sendAsBinary:false};H.extend(E.prototype,{appendBlob:function(I,K,L){var M=this,J=M.options;if(M.getRuid()){M.disconnectRuntime()}M.connectRuntime(K.ruid,function(){M.exec("init")});M._blob=K;J.fileVal=I||J.fileVal;J.filename=L||J.filename},append:function(I,J){if(typeof I==="object"){H.extend(this._formData,I)}else{this._formData[I]=J}},setRequestHeader:function(I,J){if(typeof I==="object"){H.extend(this._headers,I)}else{this._headers[I]=J}},send:function(I){this.exec("send",I);this._timeout()},abort:function(){clearTimeout(this._timer);return this.exec("abort")},destroy:function(){this.trigger("destroy");this.off();this.exec("destroy");this.disconnectRuntime()},getResponse:function(){return this.exec("getResponse")},getResponseAsJson:function(){return this.exec("getResponseAsJson")},getStatus:function(){return this.exec("getStatus")},_timeout:function(){var I=this,J=I.options.timeout;if(!J){return}clearTimeout(I._timer);I._timer=setTimeout(function(){I.abort();I.trigger("error","timeout")},J)}});D.installTo(E.prototype);return E});C("widgets/upload",["base","uploader","file","lib/transport","widgets/widget"],function(K,E,D,J){var I=K.$,G=K.isPromise,H=D.Status;I.extend(E.options,{prepareNextFile:false,chunked:false,chunkSize:5*1024*1024,chunkRetry:2,threads:3,formData:{}});function F(P,R){var O=[],U=P.source,Q=U.size,S=R?Math.ceil(Q/R):1,M=0,N=0,L,T;T={file:P,has:function(){return !!O.length},shift:function(){return O.shift()},unshift:function(V){O.unshift(V)}};while(N<S){L=Math.min(R,Q-M);O.push({file:P,start:M,end:R?(M+L):Q,total:Q,chunks:S,chunk:N++,cuted:T});M+=L}P.blocks=O.concat();P.remaning=O.length;return T}E.register({name:"upload",init:function(){var M=this.owner,L=this;this.runing=false;this.progress=false;M.on("startUpload",function(){L.progress=true}).on("uploadFinished",function(){L.progress=false});this.pool=[];this.stack=[];this.pending=[];this.remaning=0;this.__tick=K.bindFn(this._tick,this);M.on("uploadComplete",function(N){N.blocks&&I.each(N.blocks,function(P,O){O.transport&&(O.transport.abort(),O.transport.destroy());delete O.transport});delete N.blocks;delete N.remaning})},reset:function(){this.request("stop-upload",true);this.runing=false;this.pool=[];this.stack=[];this.pending=[];this.remaning=0;this._trigged=false;this._promise=null},startUpload:function(M){var L=this;I.each(L.request("get-files",H.INVALID),function(){L.request("remove-file",this)});if(M){M=M.id?M:L.request("get-file",M);if(M.getStatus()===H.INTERRUPT){I.each(L.pool,function(O,N){if(N.file!==M){return}N.transport&&N.transport.send()});M.setStatus(H.QUEUED)}else{if(M.getStatus()===H.PROGRESS){return}else{M.setStatus(H.QUEUED)}}}else{I.each(L.request("get-files",[H.INITED]),function(){this.setStatus(H.QUEUED)})}if(L.runing){return}L.runing=true;I.each(L.pool,function(P,N){var O=N.file;if(O.getStatus()===H.INTERRUPT){O.setStatus(H.PROGRESS);L._trigged=false;N.transport&&N.transport.send()}});M||I.each(L.request("get-files",H.INTERRUPT),function(){this.setStatus(H.PROGRESS)});L._trigged=false;K.nextTick(L.__tick);L.owner.trigger("startUpload")},stopUpload:function(N,M){var L=this;if(N===true){M=N;N=null}if(L.runing===false){return}if(N){N=N.id?N:L.request("get-file",N);if(N.getStatus()!==H.PROGRESS&&N.getStatus()!==H.QUEUED){return}N.setStatus(H.INTERRUPT);I.each(L.pool,function(P,O){if(O.file!==N){return}O.transport&&O.transport.abort();L._putback(O);L._popBlock(O)});return K.nextTick(L.__tick)}L.runing=false;if(this._promise&&this._promise.file){this._promise.file.setStatus(H.INTERRUPT)}M&&I.each(L.pool,function(P,O){O.transport&&O.transport.abort();O.file.setStatus(H.INTERRUPT)});L.owner.trigger("stopUpload")},cancelFile:function(L){L=L.id?L:this.request("get-file",L);L.blocks&&I.each(L.blocks,function(O,N){var M=N.transport;if(M){M.abort();M.destroy();delete N.transport}});L.setStatus(H.CANCELLED);this.owner.trigger("fileDequeued",L)},isInProgress:function(){return !!this.progress},_getStats:function(){return this.request("get-stats")},skipFile:function(M,L){M=M.id?M:this.request("get-file",M);M.setStatus(L||H.COMPLETE);M.skipped=true;M.blocks&&I.each(M.blocks,function(P,O){var N=O.transport;if(N){N.abort();N.destroy();delete O.transport}});this.owner.trigger("uploadSkip",M)},_tick:function(){var N=this,L=N.options,M,O;if(N._promise){return N._promise.always(N.__tick)}if(N.pool.length<L.threads&&(O=N._nextBlock())){N._trigged=false;M=function(P){N._promise=null;P&&P.file&&N._startSend(P);K.nextTick(N.__tick)};N._promise=G(O)?O.always(M):M(O)}else{if(!N.remaning&&!N._getStats().numOfQueue&&!N._getStats().numofInterrupt){N.runing=false;N._trigged||K.nextTick(function(){N.owner.trigger("uploadFinished")});N._trigged=true}}},_putback:function(M){var L;M.cuted.unshift(M);L=this.stack.indexOf(M.cuted);if(!~L){this.stack.unshift(M.cuted)}},_getStack:function(){var M=0,L;while((L=this.stack[M++])){if(L.has()&&L.file.getStatus()===H.PROGRESS){return L}else{if(!L.has()||L.file.getStatus()!==H.PROGRESS&&L.file.getStatus()!==H.INTERRUPT){this.stack.splice(--M,1)}}}return null},_nextBlock:function(){var Q=this,N=Q.options,L,P,M,O;if((L=this._getStack())){if(N.prepareNextFile&&!Q.pending.length){Q._prepareNextFile()}return L.shift()}else{if(Q.runing){if(!Q.pending.length&&Q._getStats().numOfQueue){Q._prepareNextFile()}P=Q.pending.shift();M=function(R){if(!R){return null}L=F(R,N.chunked?N.chunkSize:0);Q.stack.push(L);return L.shift()};if(G(P)){O=P.file;P=P[P.pipe?"pipe":"then"](M);P.file=O;return P}return M(P)}}},_prepareNextFile:function(){var M=this,N=M.request("fetch-file"),L=M.pending,O;if(N){O=M.request("before-send-file",N,function(){if(N.getStatus()===H.PROGRESS||N.getStatus()===H.INTERRUPT){return N}return M._finishFile(N)});M.owner.trigger("uploadStart",N);N.setStatus(H.PROGRESS);O.file=N;O.done(function(){var P=I.inArray(O,L);~P&&L.splice(P,1,N)});O.fail(function(P){N.setStatus(H.ERROR,P);M.owner.trigger("uploadError",N,P);M.owner.trigger("uploadComplete",N)});L.push(O)}},_popBlock:function(M){var L=I.inArray(M,this.pool);this.pool.splice(L,1);M.file.remaning--;this.remaning--},_startSend:function(O){var M=this,N=O.file,L;if(N.getStatus()!==H.PROGRESS){if(N.getStatus()===H.INTERRUPT){M._putback(O)}return}M.pool.push(O);M.remaning++;O.blob=O.chunks===1?N.source:N.source.slice(O.start,O.end);L=M.request("before-send",O,function(){if(N.getStatus()===H.PROGRESS){M._doSend(O)}else{M._popBlock(O);K.nextTick(M.__tick)}});L.fail(function(){if(N.remaning===1){M._finishFile(N).always(function(){O.percentage=1;M._popBlock(O);M.owner.trigger("uploadComplete",N);K.nextTick(M.__tick)})}else{O.percentage=1;M._popBlock(O);K.nextTick(M.__tick)}})},_doSend:function(Q){var S=this,M=S.owner,R=S.options,O=Q.file,T=new J(R),L=I.extend({},R.formData),P=I.extend({},R.headers),N,U;Q.transport=T;T.on("destroy",function(){delete Q.transport;S._popBlock(Q);K.nextTick(S.__tick)});T.on("progress",function(V){var X=0,W=0;X=Q.percentage=V;if(Q.chunks>1){I.each(O.blocks,function(Z,Y){W+=(Y.percentage||0)*(Y.end-Y.start)});X=W/O.size}M.trigger("uploadProgress",O,X||0)});N=function(V){var W;U=T.getResponseAsJson()||{};U._raw=T.getResponse();W=function(X){V=X};if(!M.trigger("uploadAccept",Q,U,W)){V=V||"server"}return V};T.on("error",function(V,W){Q.retried=Q.retried||0;if(Q.chunks>1&&~"http,abort".indexOf(V)&&Q.retried<R.chunkRetry){Q.retried++;T.send()}else{if(!W&&V==="server"){V=N(V)}O.setStatus(H.ERROR,V);M.trigger("uploadError",O,V);M.trigger("uploadComplete",O)}});T.on("load",function(){var V;if((V=N())){T.trigger("error",V,true);return}if(O.remaning===1){S._finishFile(O,U)}else{T.destroy()}});L=I.extend(L,{id:O.id,name:O.name,type:O.type,lastModifiedDate:O.lastModifiedDate,size:O.size});Q.chunks>1&&I.extend(L,{chunks:Q.chunks,chunk:Q.chunk});M.trigger("uploadBeforeSend",Q,L,P);T.appendBlob(R.fileVal,Q.blob,O.name);T.append(L);T.setRequestHeader(P);T.send()},_finishFile:function(O,M,N){var L=this.owner;return L.request("after-send-file",arguments,function(){O.setStatus(H.COMPLETE);L.trigger("uploadSuccess",O,M,N)}).fail(function(P){if(O.getStatus()===H.PROGRESS){O.setStatus(H.ERROR,P)}L.trigger("uploadError",O,P)}).always(function(){L.trigger("uploadComplete",O)})}})});C("widgets/validator",["base","uploader","file","widgets/widget"],function(G,E,F){var I=G.$,D={},H;H={addValidator:function(J,K){D[J]=K},removeValidator:function(J){delete D[J]}};E.register({name:"validator",init:function(){var J=this;G.nextTick(function(){I.each(D,function(){this.call(J.owner)})})}});H.addValidator("fileNumLimit",function(){var L=this,K=L.options,J=0,N=parseInt(K.fileNumLimit,10),M=true;if(!N){return}L.on("beforeFileQueued",function(O){if(J>=N&&M){M=false;this.trigger("error","Q_EXCEED_NUM_LIMIT",N,O);setTimeout(function(){M=true},1)}return J>=N?false:true});L.on("fileQueued",function(){J++});L.on("fileDequeued",function(){J--});L.on("reset",function(){J=0})});H.addValidator("fileSizeLimit",function(){var L=this,K=L.options,J=0,N=parseInt(K.fileSizeLimit,10),M=true;if(!N){return}L.on("beforeFileQueued",function(P){var O=J+P.size>N;if(O&&M){M=false;this.trigger("error","Q_EXCEED_SIZE_LIMIT",N,P);setTimeout(function(){M=true},1)}return O?false:true});L.on("fileQueued",function(O){J+=O.size});L.on("fileDequeued",function(O){J-=O.size});L.on("reset",function(){J=0})});H.addValidator("fileSingleSizeLimit",function(){var K=this,J=K.options,L=J.fileSingleSizeLimit;if(!L){return}K.on("beforeFileQueued",function(M){if(M.size>L){M.setStatus(F.Status.INVALID,"exceed_size");this.trigger("error","F_EXCEED_SIZE",L,M);return false}})});H.addValidator("duplicate",function(){var M=this,J=M.options,L={};if(J.duplicate){return}function K(Q){var P=0,O=0,R=Q.length,N;for(;O<R;O++){N=Q.charCodeAt(O);P=N+(P<<6)+(P<<16)-P}return P}M.on("beforeFileQueued",function(O){var N=O.__hash||(O.__hash=K(O.name+O.size+O.lastModifiedDate));if(L[N]){this.trigger("error","F_DUPLICATE",O);return false}});M.on("fileQueued",function(O){var N=O.__hash;N&&(L[N]=true)});M.on("fileDequeued",function(O){var N=O.__hash;N&&(delete L[N])});M.on("reset",function(){L={}})});return H});C("runtime/compbase",[],function(){function D(F,E){this.owner=F;this.options=F.options;this.getRuntime=function(){return E};this.getRuid=function(){return E.uid};this.trigger=function(){return F.trigger.apply(F,arguments)}}return D});C("runtime/html5/runtime",["base","runtime/runtime","runtime/compbase"],function(G,E,F){var D="html5",I={};function H(){var J={},K=this,L=this.destroy;E.apply(K,arguments);K.type=D;K.exec=function(R,N){var Q=this,O=Q.uid,P=G.slice(arguments,2),M;if(I[R]){M=J[O]=J[O]||new I[R](Q,K);if(M[N]){return M[N].apply(M,P)}}};K.destroy=function(){return L&&L.apply(this,arguments)}}G.inherits(E,{constructor:H,init:function(){var J=this;setTimeout(function(){J.trigger("ready")},1)}});H.register=function(K,J){var L=I[K]=G.inherits(F,J);return L};if(A.Blob&&A.FileReader&&A.DataView){E.addRuntime(D,H)}return H});C("runtime/html5/blob",["runtime/html5/runtime","lib/blob"],function(D,E){return D.register("Blob",{slice:function(H,G){var F=this.owner.source,I=F.slice||F.webkitSlice||F.mozSlice;F=I.call(F,H,G);return new E(this.getRuid(),F)}})});C("runtime/html5/dnd",["base","runtime/html5/runtime","lib/file"],function(G,D,H){var E=G.$,F="webuploader-dnd-";return D.register("DragAndDrop",{init:function(){var I=this.elem=this.options.container;this.dragEnterHandler=G.bindFn(this._dragEnterHandler,this);this.dragOverHandler=G.bindFn(this._dragOverHandler,this);this.dragLeaveHandler=G.bindFn(this._dragLeaveHandler,this);this.dropHandler=G.bindFn(this._dropHandler,this);this.dndOver=false;I.on("dragenter",this.dragEnterHandler);I.on("dragover",this.dragOverHandler);I.on("dragleave",this.dragLeaveHandler);I.on("drop",this.dropHandler);if(this.options.disableGlobalDnd){E(document).on("dragover",this.dragOverHandler);E(document).on("drop",this.dropHandler)}},_dragEnterHandler:function(I){var J=this,L=J._denied||false,K;I=I.originalEvent||I;if(!J.dndOver){J.dndOver=true;K=I.dataTransfer.items;if(K&&K.length){J._denied=L=!J.trigger("accept",K)}J.elem.addClass(F+"over");J.elem[L?"addClass":"removeClass"](F+"denied")}I.dataTransfer.dropEffect=L?"none":"copy";return false},_dragOverHandler:function(J){var I=this.elem.parent().get(0);if(I&&!E.contains(I,J.currentTarget)){return false}clearTimeout(this._leaveTimer);this._dragEnterHandler.call(this,J);return false},_dragLeaveHandler:function(){var J=this,I;I=function(){J.dndOver=false;J.elem.removeClass(F+"over "+F+"denied")};clearTimeout(J._leaveTimer);J._leaveTimer=setTimeout(I,100);return false},_dropHandler:function(K){var L=this,J=L.getRuid(),I=L.elem.parent().get(0),M,O;if(I&&!E.contains(I,K.currentTarget)){return false}K=K.originalEvent||K;M=K.dataTransfer;try{O=M.getData("text/html")}catch(N){}if(O){return}L._getTansferFiles(M,function(P){L.trigger("drop",E.map(P,function(Q){return new H(J,Q)}))});L.dndOver=false;L.elem.removeClass(F+"over");return false},_getTansferFiles:function(I,L){var P=[],M=[],R,K,O,S,N,Q,J;R=I.items;K=I.files;J=!!(R&&R[0].webkitGetAsEntry);for(N=0,Q=K.length;N<Q;N++){O=K[N];S=R&&R[N];if(J&&S.webkitGetAsEntry().isDirectory){M.push(this._traverseDirectoryTree(S.webkitGetAsEntry(),P))}else{P.push(O)}}G.when.apply(G,M).done(function(){if(!P.length){return}L(P)})},_traverseDirectoryTree:function(J,L){var K=G.Deferred(),I=this;if(J.isFile){J.file(function(M){L.push(M);K.resolve()})}else{if(J.isDirectory){J.createReader().readEntries(function(Q){var P=Q.length,M=[],O=[],N;for(N=0;N<P;N++){M.push(I._traverseDirectoryTree(Q[N],O))}G.when.apply(G,M).then(function(){L.push.apply(L,O);K.resolve()},K.reject)})}}return K.promise()},destroy:function(){var I=this.elem;if(!I){return}I.off("dragenter",this.dragEnterHandler);I.off("dragover",this.dragOverHandler);I.off("dragleave",this.dragLeaveHandler);I.off("drop",this.dropHandler);if(this.options.disableGlobalDnd){E(document).off("dragover",this.dragOverHandler);E(document).off("drop",this.dropHandler)}}})});C("runtime/html5/filepaste",["base","runtime/html5/runtime","lib/file"],function(E,D,F){return D.register("FilePaste",{init:function(){var H=this.options,J=this.elem=H.container,M=".*",L,G,K,I;if(H.accept){L=[];for(G=0,K=H.accept.length;G<K;G++){I=H.accept[G].mimeTypes;I&&L.push(I)}if(L.length){M=L.join(",");M=M.replace(/,/g,"|").replace(/\*/g,".*")}}this.accept=M=new RegExp(M,"i");this.hander=E.bindFn(this._pasteHander,this);J.on("paste",this.hander)},_pasteHander:function(G){var H=[],J=this.getRuid(),L,N,M,I,K;G=G.originalEvent||G;L=G.clipboardData.items;for(I=0,K=L.length;I<K;I++){N=L[I];if(N.kind!=="file"||!(M=N.getAsFile())){continue}H.push(new F(J,M))}if(H.length){G.preventDefault();G.stopPropagation();this.trigger("paste",H)}},destroy:function(){this.elem.off("paste",this.hander)}})});C("runtime/html5/filepicker",["base","runtime/html5/runtime"],function(E,D){var F=E.$;return D.register("FilePicker",{init:function(){var N=this.getRuntime().getContainer(),G=this,I=G.owner,L=G.options,K=this.label=F(document.createElement("label")),P=this.input=F(document.createElement("input")),O,M,H,J;P.attr("type","file");P.attr("name",L.name);P.addClass("webuploader-element-invisible");K.on("click",function(){P.trigger("click")});K.css({opacity:0,width:"100%",height:"100%",display:"block",cursor:"pointer",background:"#ffffff"});if(L.multiple){P.attr("multiple","multiple")}if(L.accept&&L.accept.length>0){O=[];for(M=0,H=L.accept.length;M<H;M++){O.push(L.accept[M].mimeTypes)}P.attr("accept",O.join(","))}N.append(P);N.append(K);J=function(Q){I.trigger(Q.type)};P.on("change",function(Q){var S=arguments.callee,R;G.files=Q.target.files;R=this.cloneNode(true);R.value=null;this.parentNode.replaceChild(R,this);P.off();P=F(R).on("change",S).on("mouseenter mouseleave",J);I.trigger("change")});K.on("mouseenter mouseleave",J)},getFiles:function(){return this.files},destroy:function(){this.input.off();this.label.off()}})});C("runtime/html5/transport",["base","runtime/html5/runtime"],function(E,D){var F=E.noop,G=E.$;return D.register("Transport",{init:function(){this._status=0;this._response=null},send:function(){var H=this.owner,K=this.options,I=this._initAjax(),O=H._blob,L=K.server,N,M,J;if(K.sendAsBinary){L+=(/\?/.test(L)?"&":"?")+G.param(H._formData);M=O.getSource()}else{N=new FormData();G.each(H._formData,function(Q,P){N.append(Q,P)});N.append(K.fileVal,O.getSource(),K.filename||H._formData.name||"")}if(K.withCredentials&&"withCredentials" in I){I.open(K.method,L,true);I.withCredentials=true}else{I.open(K.method,L)}this._setRequestHeader(I,K.headers);if(M){I.overrideMimeType&&I.overrideMimeType("application/octet-stream");if(E.os.android){J=new FileReader();J.onload=function(){I.send(this.result);J=J.onload=null};J.readAsArrayBuffer(M)}else{I.send(M)}}else{I.send(N)}},getResponse:function(){return this._response},getResponseAsJson:function(){return this._parseJson(this._response)},getStatus:function(){return this._status},abort:function(){var H=this._xhr;if(H){H.upload.onprogress=F;H.onreadystatechange=F;H.abort();this._xhr=H=null}},destroy:function(){this.abort()},_initAjax:function(){var I=this,J=new XMLHttpRequest(),H=this.options;if(H.withCredentials&&!("withCredentials" in J)&&typeof XDomainRequest!=="undefined"){J=new XDomainRequest()}J.upload.onprogress=function(K){var L=0;if(K.lengthComputable){L=K.loaded/K.total}return I.trigger("progress",L)};J.onreadystatechange=function(){if(J.readyState!==4){return}J.upload.onprogress=F;J.onreadystatechange=F;I._xhr=null;I._status=J.status;if(J.status>=200&&J.status<300){I._response=J.responseText;return I.trigger("load")}else{if(J.status>=500&&J.status<600){I._response=J.responseText;return I.trigger("error","server")}}return I.trigger("error",I._status?"http":"abort")};I._xhr=J;return J},_setRequestHeader:function(I,H){G.each(H,function(J,K){I.setRequestHeader(J,K)})},_parseJson:function(J){var H;try{H=JSON.parse(J)}catch(I){H={}}return H}})});C("runtime/flash/runtime",["base","runtime/runtime","runtime/compbase"],function(K,J,E){var H=K.$,I="flash",G={};function D(){var N;try{N=navigator.plugins["Shockwave Flash"];N=N.description}catch(M){try{N=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(L){N="0.0"}}N=N.match(/\d+/g);return parseFloat(N[0]+"."+N[1],10)}function F(){var L={},N={},P=this.destroy,Q=this,O=K.guid("webuploader_");J.apply(Q,arguments);Q.type=I;Q.exec=function(W,S){var V=this,T=V.uid,U=K.slice(arguments,2),R;N[T]=V;if(G[W]){if(!L[T]){L[T]=new G[W](V,Q)}R=L[T];if(R[S]){return R[S].apply(R,U)}}return Q.flashExec.apply(V,arguments)};function M(U,T){var R=U.type||U,S,V;S=R.split("::");V=S[0];R=S[1];if(R==="Ready"&&V===Q.uid){Q.trigger("ready")}else{if(N[V]){N[V].trigger(R.toLowerCase(),U,T)}}}A[O]=function(){var R=arguments;setTimeout(function(){M.apply(null,R)},1)};this.jsreciver=O;this.destroy=function(){return P&&P.apply(this,arguments)};this.flashExec=function(U,R){var S=Q.getFlash(),T=K.slice(arguments,2);return S.exec(this.uid,U,R,T)}}K.inherits(J,{constructor:F,init:function(){var N=this.getContainer(),M=this.options,L;N.css({position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});L='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+M.swf+'" ';if(K.browser.ie){L+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '}L+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+M.swf+'" /><param name="flashvars" value="uid='+this.uid+"&jsreciver="+this.jsreciver+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';N.html(L)},getFlash:function(){if(this._flash){return this._flash}this._flash=H("#"+this.uid).get(0);return this._flash}});F.register=function(M,L){L=G[M]=K.inherits(E,H.extend({flashExec:function(){var O=this.owner,N=this.getRuntime();return N.flashExec.apply(O,arguments)}},L));return L};if(D()>=11.4){J.addRuntime(I,F)}return F});C("runtime/flash/filepicker",["base","runtime/flash/runtime"],function(E,D){var F=E.$;return D.register("FilePicker",{init:function(H){var I=F.extend({},H),J,G;J=I.accept&&I.accept.length;for(G=0;G<J;G++){if(!I.accept[G].title){I.accept[G].title="Files"}}delete I.button;delete I.id;delete I.container;this.flashExec("FilePicker","init",I)},destroy:function(){this.flashExec("FilePicker","destroy")}})});C("runtime/flash/transport",["base","runtime/flash/runtime","runtime/client"],function(E,D,F){var G=E.$;return D.register("Transport",{init:function(){this._status=0;this._response=null;this._responseJson=null},send:function(){var L=this.owner,H=this.options,K=this._initAjax(),I=L._blob,J=H.server,M;K.connectRuntime(I.ruid);if(H.sendAsBinary){J+=(/\?/.test(J)?"&":"?")+G.param(L._formData);M=I.uid}else{G.each(L._formData,function(O,N){K.exec("append",O,N)});K.exec("appendBlob",H.fileVal,I.uid,H.filename||L._formData.name||"")}this._setRequestHeader(K,H.headers);K.exec("send",{method:H.method,url:J,forceURLStream:H.forceURLStream,mimeType:"application/octet-stream"},M)},getStatus:function(){return this._status},getResponse:function(){return this._response||""},getResponseAsJson:function(){return this._responseJson},abort:function(){var H=this._xhr;if(H){H.exec("abort");H.destroy();this._xhr=H=null}},destroy:function(){this.abort()},_initAjax:function(){var H=this,I=new F("XMLHttpRequest");I.on("uploadprogress progress",function(K){var J=K.loaded/K.total;J=Math.min(1,Math.max(0,J));return H.trigger("progress",J)});I.on("load",function(){var L=I.exec("getStatus"),J=false,M="",K;I.off();H._xhr=null;if(L>=200&&L<300){J=true}else{if(L>=500&&L<600){J=true;M="server"}else{M="http"}}if(J){H._response=I.exec("getResponse");H._response=decodeURIComponent(H._response);K=A.JSON&&A.JSON.parse||function(N){try{return new Function("return "+N).call()}catch(O){return{}}};H._responseJson=H._response?K(H._response):{}}I.destroy();I=null;return M?H.trigger("error",M):H.trigger("load")});I.on("error",function(){I.off();H._xhr=null;H.trigger("error","http")});H._xhr=I;return I},_setRequestHeader:function(I,H){G.each(H,function(J,K){I.exec("setRequestHeader",J,K)})}})});C("preset/withoutimage",["base","widgets/filednd","widgets/filepaste","widgets/filepicker","widgets/queue","widgets/runtime","widgets/upload","widgets/validator","runtime/html5/blob","runtime/html5/dnd","runtime/html5/filepaste","runtime/html5/filepicker","runtime/html5/transport","runtime/flash/filepicker","runtime/flash/transport"],function(D){return D});C("webuploader",["preset/withoutimage"],function(D){return D});return B("webuploader")});