(function(p){var G,H,I,J,K,L,r={},u={},v={},M={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{children:"children",name:"name",title:"",url:"url"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},w=[function(b){var a=b.treeObj,c=e.event;a.bind(c.NODECREATED,function(a,c,g){j.apply(b.callback.onNodeCreated,[a,c,g])});a.bind(c.CLICK,function(a,c,g,l,h){j.apply(b.callback.onClick,[c,g,l,h])});a.bind(c.EXPAND,function(a,c,g){j.apply(b.callback.onExpand,[a,c,g])});a.bind(c.COLLAPSE,function(a,c,g){j.apply(b.callback.onCollapse,[a,c,g])});a.bind(c.ASYNC_SUCCESS,function(a,c,g,l){j.apply(b.callback.onAsyncSuccess,[a,c,g,l])});a.bind(c.ASYNC_ERROR,function(a,c,g,l,h,e){j.apply(b.callback.onAsyncError,[a,c,g,l,h,e])});a.bind(c.REMOVE,function(a,c,g){j.apply(b.callback.onRemove,[a,c,g])})}],x=[function(b){var a=e.event;b.treeObj.unbind(a.NODECREATED).unbind(a.CLICK).unbind(a.EXPAND).unbind(a.COLLAPSE).unbind(a.ASYNC_SUCCESS).unbind(a.ASYNC_ERROR).unbind(a.REMOVE)}],y=[function(b){var a=h.getCache(b);a||(a={},h.setCache(b,a));a.nodes=[];a.doms=[]}],z=[function(b,a,c,d,f,g){if(c){var l=h.getRoot(b),e=b.data.key.children;c.level=a;c.tId=b.treeId+"_"+ ++l.zId;c.parentTId=d?d.tId:null;c.open=typeof c.open=="string"?j.eqs(c.open,"true"):!!c.open;c[e]&&c[e].length>0?(c.isParent=!0,c.zAsync=!0):(c.isParent=typeof c.isParent=="string"?j.eqs(c.isParent,"true"):!!c.isParent,c.open=c.isParent&&!b.async.enable?c.open:!1,c.zAsync=!c.isParent);c.isFirstNode=f;c.isLastNode=g;c.getParentNode=function(){return h.getNodeCache(b,c.parentTId)};c.getPreNode=function(){return h.getPreNode(b,c)};c.getNextNode=function(){return h.getNextNode(b,c)};c.isAjaxing=!1;h.fixPIdKeyValue(b,c)}}],s=[function(b){var a=b.target,c=h.getSetting(b.data.treeId),d="",f=null,g="",l="",i=null,n=null,k=null;if(j.eqs(b.type,"mousedown")){l="mousedown"}else{if(j.eqs(b.type,"mouseup")){l="mouseup"}else{if(j.eqs(b.type,"contextmenu")){l="contextmenu"}else{if(j.eqs(b.type,"click")){if(j.eqs(a.tagName,"span")&&a.getAttribute("treeNode"+e.id.SWITCH)!==null){d=j.getNodeMainDom(a).id,g="switchNode"}else{if(k=j.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+e.id.A}])){d=j.getNodeMainDom(k).id,g="clickNode"}}}else{if(j.eqs(b.type,"dblclick")&&(l="dblclick",k=j.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+e.id.A}]))){d=j.getNodeMainDom(k).id,g="switchNode"}}}}}if(l.length>0&&d.length==0&&(k=j.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+e.id.A}]))){d=j.getNodeMainDom(k).id}if(d.length>0){switch(f=h.getNodeCache(c,d),g){case"switchNode":f.isParent?j.eqs(b.type,"click")||j.eqs(b.type,"dblclick")&&j.apply(c.view.dblClickExpand,[c.treeId,f],c.view.dblClickExpand)?i=G:g="":g="";break;case"clickNode":i=H}}switch(l){case"mousedown":n=I;break;case"mouseup":n=J;break;case"dblclick":n=K;break;case"contextmenu":n=L}return{stop:!1,node:f,nodeEventType:g,nodeEventCallback:i,treeEventType:l,treeEventCallback:n}}],A=[function(b){var a=h.getRoot(b);a||(a={},h.setRoot(b,a));a[b.data.key.children]=[];a.expandTriggerFlag=!1;a.curSelectedList=[];a.noSelection=!0;a.createdNodes=[];a.zId=0;a._ver=(new Date).getTime()}],B=[],C=[],D=[],E=[],F=[],h={addNodeCache:function(b,a){h.getCache(b).nodes[h.getNodeCacheId(a.tId)]=a},getNodeCacheId:function(b){return b.substring(b.lastIndexOf("_")+1)},addAfterA:function(b){C.push(b)},addBeforeA:function(b){B.push(b)},addInnerAfterA:function(b){E.push(b)},addInnerBeforeA:function(b){D.push(b)},addInitBind:function(b){w.push(b)},addInitUnBind:function(b){x.push(b)},addInitCache:function(b){y.push(b)},addInitNode:function(b){z.push(b)},addInitProxy:function(b,a){a?s.splice(0,0,b):s.push(b)},addInitRoot:function(b){A.push(b)},addNodesData:function(b,a,c){var d=b.data.key.children;a[d]||(a[d]=[]);if(a[d].length>0){a[d][a[d].length-1].isLastNode=!1,i.setNodeLineIcos(b,a[d][a[d].length-1])}a.isParent=!0;a[d]=a[d].concat(c)},addSelectedNode:function(b,a){var c=h.getRoot(b);h.isSelectedNode(b,a)||c.curSelectedList.push(a)},addCreatedNode:function(b,a){(b.callback.onNodeCreated||b.view.addDiyDom)&&h.getRoot(b).createdNodes.push(a)},addZTreeTools:function(b){F.push(b)},exSetting:function(b){p.extend(!0,M,b)},fixPIdKeyValue:function(b,a){b.data.simpleData.enable&&(a[b.data.simpleData.pIdKey]=a.parentTId?a.getParentNode()[b.data.simpleData.idKey]:b.data.simpleData.rootPId)},getAfterA:function(b,a,c){for(var d=0,f=C.length;d<f;d++){C[d].apply(this,arguments)}},getBeforeA:function(b,a,c){for(var d=0,f=B.length;d<f;d++){B[d].apply(this,arguments)}},getInnerAfterA:function(b,a,c){for(var d=0,f=E.length;d<f;d++){E[d].apply(this,arguments)}},getInnerBeforeA:function(b,a,c){for(var d=0,f=D.length;d<f;d++){D[d].apply(this,arguments)}},getCache:function(b){return v[b.treeId]},getNextNode:function(b,a){if(!a){return null}for(var c=b.data.key.children,d=a.parentTId?a.getParentNode():h.getRoot(b),f=0,g=d[c].length-1;f<=g;f++){if(d[c][f]===a){return f==g?null:d[c][f+1]}}return null},getNodeByParam:function(b,a,c,d){if(!a||!c){return null}for(var f=b.data.key.children,g=0,l=a.length;g<l;g++){if(a[g][c]==d){return a[g]}var e=h.getNodeByParam(b,a[g][f],c,d);if(e){return e}}return null},getNodeCache:function(b,a){if(!a){return null}var c=v[b.treeId].nodes[h.getNodeCacheId(a)];return c?c:null},getNodeName:function(b,a){return""+a[b.data.key.name]},getNodeTitle:function(b,a){return""+a[b.data.key.title===""?b.data.key.name:b.data.key.title]},getNodes:function(b){return h.getRoot(b)[b.data.key.children]},getNodesByParam:function(b,a,c,d){if(!a||!c){return[]}for(var f=b.data.key.children,g=[],l=0,e=a.length;l<e;l++){a[l][c]==d&&g.push(a[l]),g=g.concat(h.getNodesByParam(b,a[l][f],c,d))}return g},getNodesByParamFuzzy:function(b,a,c,d){if(!a||!c){return[]}for(var f=b.data.key.children,g=[],d=d.toLowerCase(),l=0,e=a.length;l<e;l++){typeof a[l][c]=="string"&&a[l][c].toLowerCase().indexOf(d)>-1&&g.push(a[l]),g=g.concat(h.getNodesByParamFuzzy(b,a[l][f],c,d))}return g},getNodesByFilter:function(b,a,c,d,f){if(!a){return d?null:[]}for(var g=b.data.key.children,e=d?null:[],i=0,n=a.length;i<n;i++){if(j.apply(c,[a[i],f],!1)){if(d){return a[i]}e.push(a[i])}var k=h.getNodesByFilter(b,a[i][g],c,d,f);if(d&&k){return k}e=d?k:e.concat(k)}return e},getPreNode:function(b,a){if(!a){return null}for(var c=b.data.key.children,d=a.parentTId?a.getParentNode():h.getRoot(b),f=0,g=d[c].length;f<g;f++){if(d[c][f]===a){return f==0?null:d[c][f-1]}}return null},getRoot:function(b){return b?u[b.treeId]:null},getRoots:function(){return u},getSetting:function(b){return r[b]},getSettings:function(){return r},getZTreeTools:function(b){return(b=this.getRoot(this.getSetting(b)))?b.treeTools:null},initCache:function(b){for(var a=0,c=y.length;a<c;a++){y[a].apply(this,arguments)}},initNode:function(b,a,c,d,f,g){for(var e=0,h=z.length;e<h;e++){z[e].apply(this,arguments)}},initRoot:function(b){for(var a=0,c=A.length;a<c;a++){A[a].apply(this,arguments)}},isSelectedNode:function(b,a){for(var c=h.getRoot(b),d=0,f=c.curSelectedList.length;d<f;d++){if(a===c.curSelectedList[d]){return !0}}return !1},removeNodeCache:function(b,a){var c=b.data.key.children;if(a[c]){for(var d=0,f=a[c].length;d<f;d++){arguments.callee(b,a[c][d])}}h.getCache(b).nodes[h.getNodeCacheId(a.tId)]=null},removeSelectedNode:function(b,a){for(var c=h.getRoot(b),d=0,f=c.curSelectedList.length;d<f;d++){if(a===c.curSelectedList[d]||!h.getNodeCache(b,c.curSelectedList[d].tId)){c.curSelectedList.splice(d,1),d--,f--}}},setCache:function(b,a){v[b.treeId]=a},setRoot:function(b,a){u[b.treeId]=a},setZTreeTools:function(b,a){for(var c=0,d=F.length;c<d;c++){F[c].apply(this,arguments)}},transformToArrayFormat:function(b,a){if(!a){return[]}var c=b.data.key.children,d=[];if(j.isArray(a)){for(var f=0,g=a.length;f<g;f++){d.push(a[f]),a[f][c]&&(d=d.concat(h.transformToArrayFormat(b,a[f][c])))}}else{d.push(a),a[c]&&(d=d.concat(h.transformToArrayFormat(b,a[c])))}return d},transformTozTreeFormat:function(b,a){var c,d,f=b.data.simpleData.idKey,g=b.data.simpleData.pIdKey,e=b.data.key.children;if(!f||f==""||!a){return[]}if(j.isArray(a)){var h=[],i=[];for(c=0,d=a.length;c<d;c++){i[a[c][f]]=a[c]}for(c=0,d=a.length;c<d;c++){i[a[c][g]]&&a[c][f]!=a[c][g]?(i[a[c][g]][e]||(i[a[c][g]][e]=[]),i[a[c][g]][e].push(a[c])):h.push(a[c])}return h}else{return[a]}}},m={bindEvent:function(b){for(var a=0,c=w.length;a<c;a++){w[a].apply(this,arguments)}},unbindEvent:function(b){for(var a=0,c=x.length;a<c;a++){x[a].apply(this,arguments)}},bindTree:function(b){var a={treeId:b.treeId},c=b.treeObj;b.view.txtSelectedEnable||c.bind("selectstart",function(a){a=a.originalEvent.srcElement.nodeName.toLowerCase();return a==="input"||a==="textarea"}).css({"-moz-user-select":"-moz-none"});c.bind("click",a,m.proxy);c.bind("dblclick",a,m.proxy);c.bind("mouseover",a,m.proxy);c.bind("mouseout",a,m.proxy);c.bind("mousedown",a,m.proxy);c.bind("mouseup",a,m.proxy);c.bind("contextmenu",a,m.proxy)},unbindTree:function(b){b.treeObj.unbind("click",m.proxy).unbind("dblclick",m.proxy).unbind("mouseover",m.proxy).unbind("mouseout",m.proxy).unbind("mousedown",m.proxy).unbind("mouseup",m.proxy).unbind("contextmenu",m.proxy)},doProxy:function(b){for(var a=[],c=0,d=s.length;c<d;c++){var f=s[c].apply(this,arguments);a.push(f);if(f.stop){break}}return a},proxy:function(b){var a=h.getSetting(b.data.treeId);if(!j.uCanDo(a,b)){return !0}for(var a=m.doProxy(b),c=!0,d=0,f=a.length;d<f;d++){var g=a[d];g.nodeEventCallback&&(c=g.nodeEventCallback.apply(g,[b,g.node])&&c);g.treeEventCallback&&(c=g.treeEventCallback.apply(g,[b,g.node])&&c)}return c}};G=function(b,a){var c=h.getSetting(b.data.treeId);if(a.open){if(j.apply(c.callback.beforeCollapse,[c.treeId,a],!0)==!1){return !0}}else{if(j.apply(c.callback.beforeExpand,[c.treeId,a],!0)==!1){return !0}}h.getRoot(c).expandTriggerFlag=!0;i.switchNode(c,a);return !0};H=function(b,a){var c=h.getSetting(b.data.treeId),d=c.view.autoCancelSelected&&(b.ctrlKey||b.metaKey)&&h.isSelectedNode(c,a)?0:c.view.autoCancelSelected&&(b.ctrlKey||b.metaKey)&&c.view.selectedMulti?2:1;if(j.apply(c.callback.beforeClick,[c.treeId,a,d],!0)==!1){return !0}d===0?i.cancelPreSelectedNode(c,a):i.selectNode(c,a,d===2);c.treeObj.trigger(e.event.CLICK,[b,c.treeId,a,d]);return !0};I=function(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeMouseDown,[c.treeId,a],!0)&&j.apply(c.callback.onMouseDown,[b,c.treeId,a]);return !0};J=function(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeMouseUp,[c.treeId,a],!0)&&j.apply(c.callback.onMouseUp,[b,c.treeId,a]);return !0};K=function(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeDblClick,[c.treeId,a],!0)&&j.apply(c.callback.onDblClick,[b,c.treeId,a]);return !0};L=function(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeRightClick,[c.treeId,a],!0)&&j.apply(c.callback.onRightClick,[b,c.treeId,a]);return typeof c.callback.onRightClick!="function"};var j={apply:function(b,a,c){return typeof b=="function"?b.apply(N,a?a:[]):c},canAsync:function(b,a){var c=b.data.key.children;return b.async.enable&&a&&a.isParent&&!(a.zAsync||a[c]&&a[c].length>0)},clone:function(b){if(b===null){return null}var a=j.isArray(b)?[]:{},c;for(c in b){a[c]=b[c] instanceof Date?new Date(b[c].getTime()):typeof b[c]==="object"?arguments.callee(b[c]):b[c]}return a},eqs:function(b,a){return b.toLowerCase()===a.toLowerCase()},isArray:function(b){return Object.prototype.toString.apply(b)==="[object Array]"},$:function(b,a,c){a&&typeof a!="string"&&(c=a,a="");return typeof b=="string"?p(b,c?c.treeObj.get(0).ownerDocument:null):p("#"+b.tId+a,c?c.treeObj:null)},getMDom:function(b,a,c){if(!a){return null}for(;a&&a.id!==b.treeId;){for(var d=0,f=c.length;a.tagName&&d<f;d++){if(j.eqs(a.tagName,c[d].tagName)&&a.getAttribute(c[d].attrName)!==null){return a}}a=a.parentNode}return null},getNodeMainDom:function(b){return p(b).parent("li").get(0)||p(b).parentsUntil("li").parent().get(0)},isChildOrSelf:function(b,a){return p(b).closest("#"+a).length>0},uCanDo:function(){return !0}},i={addNodes:function(b,a,c,d){if(!b.data.keep.leaf||!a||a.isParent){if(j.isArray(c)||(c=[c]),b.data.simpleData.enable&&(c=h.transformTozTreeFormat(b,c)),a){var f=k(a,e.id.SWITCH,b),g=k(a,e.id.ICON,b),l=k(a,e.id.UL,b);if(!a.open){i.replaceSwitchClass(a,f,e.folder.CLOSE),i.replaceIcoClass(a,g,e.folder.CLOSE),a.open=!1,l.css({display:"none"})}h.addNodesData(b,a,c);i.createNodes(b,a.level+1,c,a);d||i.expandCollapseParentNode(b,a,!0)}else{h.addNodesData(b,h.getRoot(b),c),i.createNodes(b,0,c,null)}}},appendNodes:function(b,a,c,d,f,g){if(!c){return[]}for(var e=[],j=b.data.key.children,k=0,m=c.length;k<m;k++){var o=c[k];if(f){var t=(d?d:h.getRoot(b))[j].length==c.length&&k==0;h.initNode(b,a,o,d,t,k==c.length-1,g);h.addNodeCache(b,o)}t=[];o[j]&&o[j].length>0&&(t=i.appendNodes(b,a+1,o[j],o,f,g&&o.open));g&&(i.makeDOMNodeMainBefore(e,b,o),i.makeDOMNodeLine(e,b,o),h.getBeforeA(b,o,e),i.makeDOMNodeNameBefore(e,b,o),h.getInnerBeforeA(b,o,e),i.makeDOMNodeIcon(e,b,o),h.getInnerAfterA(b,o,e),i.makeDOMNodeNameAfter(e,b,o),h.getAfterA(b,o,e),o.isParent&&o.open&&i.makeUlHtml(b,o,e,t.join("")),i.makeDOMNodeMainAfter(e,b,o),h.addCreatedNode(b,o))}return e},appendParentULDom:function(b,a){var c=[],d=k(a,b);!d.get(0)&&a.parentTId&&(i.appendParentULDom(b,a.getParentNode()),d=k(a,b));var f=k(a,e.id.UL,b);f.get(0)&&f.remove();f=i.appendNodes(b,a.level+1,a[b.data.key.children],a,!1,!0);i.makeUlHtml(b,a,c,f.join(""));d.append(c.join(""))},asyncNode:function(b,a,c,d){var f,g;if(a&&!a.isParent){return j.apply(d),!1}else{if(a&&a.isAjaxing){return !1}else{if(j.apply(b.callback.beforeAsync,[b.treeId,a],!0)==!1){return j.apply(d),!1}}}if(a){a.isAjaxing=!0,k(a,e.id.ICON,b).attr({style:"","class":e.className.BUTTON+" "+e.className.ICO_LOADING})}var l={};for(f=0,g=b.async.autoParam.length;a&&f<g;f++){var q=b.async.autoParam[f].split("="),n=q;q.length>1&&(n=q[1],q=q[0]);l[n]=a[q]}if(j.isArray(b.async.otherParam)){for(f=0,g=b.async.otherParam.length;f<g;f+=2){l[b.async.otherParam[f]]=b.async.otherParam[f+1]}}else{for(var m in b.async.otherParam){l[m]=b.async.otherParam[m]}}var o=h.getRoot(b)._ver;p.ajax({contentType:b.async.contentType,type:b.async.type,url:j.apply(b.async.url,[b.treeId,a],b.async.url),data:l,dataType:b.async.dataType,success:function(f){if(o==h.getRoot(b)._ver){var g=[];try{g=!f||f.length==0?[]:typeof f=="string"?eval("("+f+")"):f}catch(l){g=f}if(a){a.isAjaxing=null,a.zAsync=!0}i.setNodeLineIcos(b,a);g&&g!==""?(g=j.apply(b.async.dataFilter,[b.treeId,a,g],g),i.addNodes(b,a,g?j.clone(g):[],!!c)):i.addNodes(b,a,[],!!c);b.treeObj.trigger(e.event.ASYNC_SUCCESS,[b.treeId,a,f]);j.apply(d)}},error:function(c,d,f){if(o==h.getRoot(b)._ver){if(a){a.isAjaxing=null}i.setNodeLineIcos(b,a);b.treeObj.trigger(e.event.ASYNC_ERROR,[b.treeId,a,c,d,f])}}});return !0},cancelPreSelectedNode:function(b,a){for(var c=h.getRoot(b).curSelectedList,d=c.length-1;d>=0;d--){if(!a||a===c[d]){if(k(c[d],e.id.A,b).removeClass(e.node.CURSELECTED),a){h.removeSelectedNode(b,a);break}}}if(!a){h.getRoot(b).curSelectedList=[]}},createNodeCallback:function(b){if(b.callback.onNodeCreated||b.view.addDiyDom){for(var a=h.getRoot(b);a.createdNodes.length>0;){var c=a.createdNodes.shift();j.apply(b.view.addDiyDom,[b.treeId,c]);b.callback.onNodeCreated&&b.treeObj.trigger(e.event.NODECREATED,[b.treeId,c])}}},createNodes:function(b,a,c,d){if(c&&c.length!=0){var f=h.getRoot(b),g=b.data.key.children,g=!d||d.open||!!k(d[g][0],b).get(0);f.createdNodes=[];a=i.appendNodes(b,a,c,d,!0,g);d?(d=k(d,e.id.UL,b),d.get(0)&&d.append(a.join(""))):b.treeObj.append(a.join(""));i.createNodeCallback(b)}},destroy:function(b){b&&(h.initCache(b),h.initRoot(b),m.unbindTree(b),m.unbindEvent(b),b.treeObj.empty(),delete r[b.treeId])},expandCollapseNode:function(b,a,c,d,f){var g=h.getRoot(b),l=b.data.key.children;if(a){if(g.expandTriggerFlag){var q=f,f=function(){q&&q();a.open?b.treeObj.trigger(e.event.EXPAND,[b.treeId,a]):b.treeObj.trigger(e.event.COLLAPSE,[b.treeId,a])};g.expandTriggerFlag=!1}if(!a.open&&a.isParent&&(!k(a,e.id.UL,b).get(0)||a[l]&&a[l].length>0&&!k(a[l][0],b).get(0))){i.appendParentULDom(b,a),i.createNodeCallback(b)}if(a.open==c){j.apply(f,[])}else{var c=k(a,e.id.UL,b),g=k(a,e.id.SWITCH,b),n=k(a,e.id.ICON,b);a.isParent?(a.open=!a.open,a.iconOpen&&a.iconClose&&n.attr("style",i.makeNodeIcoStyle(b,a)),a.open?(i.replaceSwitchClass(a,g,e.folder.OPEN),i.replaceIcoClass(a,n,e.folder.OPEN),d==!1||b.view.expandSpeed==""?(c.show(),j.apply(f,[])):a[l]&&a[l].length>0?c.slideDown(b.view.expandSpeed,f):(c.show(),j.apply(f,[]))):(i.replaceSwitchClass(a,g,e.folder.CLOSE),i.replaceIcoClass(a,n,e.folder.CLOSE),d==!1||b.view.expandSpeed==""||!(a[l]&&a[l].length>0)?(c.hide(),j.apply(f,[])):c.slideUp(b.view.expandSpeed,f))):j.apply(f,[])}}else{j.apply(f,[])}},expandCollapseParentNode:function(b,a,c,d,f){a&&(a.parentTId?(i.expandCollapseNode(b,a,c,d),a.parentTId&&i.expandCollapseParentNode(b,a.getParentNode(),c,d,f)):i.expandCollapseNode(b,a,c,d,f))},expandCollapseSonNode:function(b,a,c,d,f){var g=h.getRoot(b),e=b.data.key.children,g=a?a[e]:g[e],e=a?!1:d,j=h.getRoot(b).expandTriggerFlag;h.getRoot(b).expandTriggerFlag=!1;if(g){for(var k=0,m=g.length;k<m;k++){g[k]&&i.expandCollapseSonNode(b,g[k],c,e)}}h.getRoot(b).expandTriggerFlag=j;i.expandCollapseNode(b,a,c,d,f)},makeDOMNodeIcon:function(b,a,c){var d=h.getNodeName(a,c),d=a.view.nameIsHTML?d:d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");b.push("<span id='",c.tId,e.id.ICON,"' title='' treeNode",e.id.ICON," class='",i.makeNodeIcoClass(a,c),"' style='",i.makeNodeIcoStyle(a,c),"'></span><span id='",c.tId,e.id.SPAN,"'>",d,"</span>")},makeDOMNodeLine:function(b,a,c){b.push("<span id='",c.tId,e.id.SWITCH,"' title='' class='",i.makeNodeLineClass(a,c),"' treeNode",e.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(b){b.push("</li>")},makeDOMNodeMainBefore:function(b,a,c){b.push("<li id='",c.tId,"' class='",e.className.LEVEL,c.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(b){b.push("</a>")},makeDOMNodeNameBefore:function(b,a,c){var d=h.getNodeTitle(a,c),f=i.makeNodeUrl(a,c),g=i.makeNodeFontCss(a,c),l=[],k;for(k in g){l.push(k,":",g[k],";")}b.push("<a id='",c.tId,e.id.A,"' class='",e.className.LEVEL,c.level,"' treeNode",e.id.A,' onclick="',c.click||"",'" ',f!=null&&f.length>0?"href='"+f+"'":""," target='",i.makeNodeTarget(c),"' style='",l.join(""),"'");j.apply(a.view.showTitle,[a.treeId,c],a.view.showTitle)&&d&&b.push("title='",d.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'");b.push(">")},makeNodeFontCss:function(b,a){var c=j.apply(b.view.fontCss,[b.treeId,a],b.view.fontCss);return c&&typeof c!="function"?c:{}},makeNodeIcoClass:function(b,a){var c=["ico"];a.isAjaxing||(c[0]=(a.iconSkin?a.iconSkin+"_":"")+c[0],a.isParent?c.push(a.open?e.folder.OPEN:e.folder.CLOSE):c.push(e.folder.DOCU));return e.className.BUTTON+" "+c.join("_")},makeNodeIcoStyle:function(b,a){var c=[];if(!a.isAjaxing){var d=a.isParent&&a.iconOpen&&a.iconClose?a.open?a.iconOpen:a.iconClose:a.icon;d&&c.push("background:url(",d,") 0 0 no-repeat;");(b.view.showIcon==!1||!j.apply(b.view.showIcon,[b.treeId,a],!0))&&c.push("width:0px;height:0px;")}return c.join("")},makeNodeLineClass:function(b,a){var c=[];b.view.showLine?a.level==0&&a.isFirstNode&&a.isLastNode?c.push(e.line.ROOT):a.level==0&&a.isFirstNode?c.push(e.line.ROOTS):a.isLastNode?c.push(e.line.BOTTOM):c.push(e.line.CENTER):c.push(e.line.NOLINE);a.isParent?c.push(a.open?e.folder.OPEN:e.folder.CLOSE):c.push(e.folder.DOCU);return i.makeNodeLineClassEx(a)+c.join("_")},makeNodeLineClassEx:function(b){return e.className.BUTTON+" "+e.className.LEVEL+b.level+" "+e.className.SWITCH+" "},makeNodeTarget:function(b){return b.target||"_blank"},makeNodeUrl:function(b,a){var c=b.data.key.url;return a[c]?a[c]:null},makeUlHtml:function(b,a,c,d){c.push("<ul id='",a.tId,e.id.UL,"' class='",e.className.LEVEL,a.level," ",i.makeUlLineClass(b,a),"' style='display:",a.open?"block":"none","'>");c.push(d);c.push("</ul>")},makeUlLineClass:function(b,a){return b.view.showLine&&!a.isLastNode?e.line.LINE:""},removeChildNodes:function(b,a){if(a){var c=b.data.key.children,d=a[c];if(d){for(var f=0,g=d.length;f<g;f++){h.removeNodeCache(b,d[f])}h.removeSelectedNode(b);delete a[c];b.data.keep.parent?k(a,e.id.UL,b).empty():(a.isParent=!1,a.open=!1,c=k(a,e.id.SWITCH,b),d=k(a,e.id.ICON,b),i.replaceSwitchClass(a,c,e.folder.DOCU),i.replaceIcoClass(a,d,e.folder.DOCU),k(a,e.id.UL,b).remove())}}},setFirstNode:function(b,a){var c=b.data.key.children;if(a[c].length>0){a[c][0].isFirstNode=!0}},setLastNode:function(b,a){var c=b.data.key.children,d=a[c].length;if(d>0){a[c][d-1].isLastNode=!0}},removeNode:function(b,a){var c=h.getRoot(b),d=b.data.key.children,f=a.parentTId?a.getParentNode():c;a.isFirstNode=!1;a.isLastNode=!1;a.getPreNode=function(){return null};a.getNextNode=function(){return null};if(h.getNodeCache(b,a.tId)){k(a,b).remove();h.removeNodeCache(b,a);h.removeSelectedNode(b,a);for(var g=0,l=f[d].length;g<l;g++){if(f[d][g].tId==a.tId){f[d].splice(g,1);break}}i.setFirstNode(b,f);i.setLastNode(b,f);var j,g=f[d].length;if(!b.data.keep.parent&&g==0){f.isParent=!1,f.open=!1,g=k(f,e.id.UL,b),l=k(f,e.id.SWITCH,b),j=k(f,e.id.ICON,b),i.replaceSwitchClass(f,l,e.folder.DOCU),i.replaceIcoClass(f,j,e.folder.DOCU),g.css("display","none")}else{if(b.view.showLine&&g>0){var n=f[d][g-1],g=k(n,e.id.UL,b),l=k(n,e.id.SWITCH,b);j=k(n,e.id.ICON,b);f==c?f[d].length==1?i.replaceSwitchClass(n,l,e.line.ROOT):(c=k(f[d][0],e.id.SWITCH,b),i.replaceSwitchClass(f[d][0],c,e.line.ROOTS),i.replaceSwitchClass(n,l,e.line.BOTTOM)):i.replaceSwitchClass(n,l,e.line.BOTTOM);g.removeClass(e.line.LINE)}}}},replaceIcoClass:function(b,a,c){if(a&&!b.isAjaxing&&(b=a.attr("class"),b!=void 0)){b=b.split("_");switch(c){case e.folder.OPEN:case e.folder.CLOSE:case e.folder.DOCU:b[b.length-1]=c}a.attr("class",b.join("_"))}},replaceSwitchClass:function(b,a,c){if(a){var d=a.attr("class");if(d!=void 0){d=d.split("_");switch(c){case e.line.ROOT:case e.line.ROOTS:case e.line.CENTER:case e.line.BOTTOM:case e.line.NOLINE:d[0]=i.makeNodeLineClassEx(b)+c;break;case e.folder.OPEN:case e.folder.CLOSE:case e.folder.DOCU:d[1]=c}a.attr("class",d.join("_"));c!==e.folder.DOCU?a.removeAttr("disabled"):a.attr("disabled","disabled")}}},selectNode:function(b,a,c){c||i.cancelPreSelectedNode(b);k(a,e.id.A,b).addClass(e.node.CURSELECTED);h.addSelectedNode(b,a)},setNodeFontCss:function(b,a){var c=k(a,e.id.A,b),d=i.makeNodeFontCss(b,a);d&&c.css(d)},setNodeLineIcos:function(b,a){if(a){var c=k(a,e.id.SWITCH,b),d=k(a,e.id.UL,b),f=k(a,e.id.ICON,b),g=i.makeUlLineClass(b,a);g.length==0?d.removeClass(e.line.LINE):d.addClass(g);c.attr("class",i.makeNodeLineClass(b,a));a.isParent?c.removeAttr("disabled"):c.attr("disabled","disabled");f.removeAttr("style");f.attr("style",i.makeNodeIcoStyle(b,a));f.attr("class",i.makeNodeIcoClass(b,a))}},setNodeName:function(b,a){var c=h.getNodeTitle(b,a),d=k(a,e.id.SPAN,b);d.empty();b.view.nameIsHTML?d.html(h.getNodeName(b,a)):d.text(h.getNodeName(b,a));j.apply(b.view.showTitle,[b.treeId,a],b.view.showTitle)&&k(a,e.id.A,b).attr("title",!c?"":c)},setNodeTarget:function(b,a){k(a,e.id.A,b).attr("target",i.makeNodeTarget(a))},setNodeUrl:function(b,a){var c=k(a,e.id.A,b),d=i.makeNodeUrl(b,a);d==null||d.length==0?c.removeAttr("href"):c.attr("href",d)},switchNode:function(b,a){a.open||!j.canAsync(b,a)?i.expandCollapseNode(b,a,!a.open):b.async.enable?i.asyncNode(b,a)||i.expandCollapseNode(b,a,!a.open):a&&i.expandCollapseNode(b,a,!a.open)}};p.fn.zTree={consts:{className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_z:{tools:j,view:i,event:m,data:h},getZTreeObj:function(b){return(b=h.getZTreeTools(b))?b:null},destroy:function(b){if(b&&b.length>0){i.destroy(h.getSetting(b))}else{for(var a in r){i.destroy(r[a])}}},init:function(b,a,c){var d=j.clone(M);p.extend(!0,d,a);d.treeId=b.attr("id");d.treeObj=b;d.treeObj.empty();r[d.treeId]=d;if(typeof document.body.style.maxHeight==="undefined"){d.view.expandSpeed=""}h.initRoot(d);b=h.getRoot(d);a=d.data.key.children;c=c?j.clone(j.isArray(c)?c:[c]):[];b[a]=d.data.simpleData.enable?h.transformTozTreeFormat(d,c):c;h.initCache(d);m.unbindTree(d);m.bindTree(d);m.unbindEvent(d);m.bindEvent(d);c={setting:d,addNodes:function(a,b,c){function e(){i.addNodes(d,a,h,c==!0)}if(!b){return null}a||(a=null);if(a&&!a.isParent&&d.data.keep.leaf){return null}var h=j.clone(j.isArray(b)?b:[b]);j.canAsync(d,a)?i.asyncNode(d,a,c,e):e();return h},cancelSelectedNode:function(a){i.cancelPreSelectedNode(d,a)},destroy:function(){i.destroy(d)},expandAll:function(a){a=!!a;i.expandCollapseSonNode(d,null,a,!0);return a},expandNode:function(a,b,c,e,n){if(!a||!a.isParent){return null}b!==!0&&b!==!1&&(b=!a.open);if((n=!!n)&&b&&j.apply(d.callback.beforeExpand,[d.treeId,a],!0)==!1){return null}else{if(n&&!b&&j.apply(d.callback.beforeCollapse,[d.treeId,a],!0)==!1){return null}}b&&a.parentTId&&i.expandCollapseParentNode(d,a.getParentNode(),b,!1);if(b===a.open&&!c){return null}h.getRoot(d).expandTriggerFlag=n;if(!j.canAsync(d,a)&&c){i.expandCollapseSonNode(d,a,b,!0,function(){if(e!==!1){try{k(a,d).focus().blur()}catch(b){}}})}else{if(a.open=!b,i.switchNode(this.setting,a),e!==!1){try{k(a,d).focus().blur()}catch(m){}}}return b},getNodes:function(){return h.getNodes(d)},getNodeByParam:function(a,b,c){return !a?null:h.getNodeByParam(d,c?c[d.data.key.children]:h.getNodes(d),a,b)},getNodeByTId:function(a){return h.getNodeCache(d,a)},getNodesByParam:function(a,b,c){return !a?null:h.getNodesByParam(d,c?c[d.data.key.children]:h.getNodes(d),a,b)},getNodesByParamFuzzy:function(a,b,c){return !a?null:h.getNodesByParamFuzzy(d,c?c[d.data.key.children]:h.getNodes(d),a,b)},getNodesByFilter:function(a,b,c,e){b=!!b;return !a||typeof a!="function"?b?null:[]:h.getNodesByFilter(d,c?c[d.data.key.children]:h.getNodes(d),a,b,e)},getNodeIndex:function(a){if(!a){return null}for(var b=d.data.key.children,c=a.parentTId?a.getParentNode():h.getRoot(d),e=0,i=c[b].length;e<i;e++){if(c[b][e]==a){return e}}return -1},getSelectedNodes:function(){for(var a=[],b=h.getRoot(d).curSelectedList,c=0,e=b.length;c<e;c++){a.push(b[c])}return a},isSelectedNode:function(a){return h.isSelectedNode(d,a)},reAsyncChildNodes:function(a,b,c){if(this.setting.async.enable){var j=!a;j&&(a=h.getRoot(d));if(b=="refresh"){for(var b=this.setting.data.key.children,m=0,p=a[b]?a[b].length:0;m<p;m++){h.removeNodeCache(d,a[b][m])}h.removeSelectedNode(d);a[b]=[];j?this.setting.treeObj.empty():k(a,e.id.UL,d).empty()}i.asyncNode(this.setting,j?null:a,!!c)}},refresh:function(){this.setting.treeObj.empty();var a=h.getRoot(d),b=a[d.data.key.children];h.initRoot(d);a[d.data.key.children]=b;h.initCache(d);i.createNodes(d,0,a[d.data.key.children])},removeChildNodes:function(a){if(!a){return null}var b=a[d.data.key.children];i.removeChildNodes(d,a);return b?b:null},removeNode:function(a,b){a&&(b=!!b,b&&j.apply(d.callback.beforeRemove,[d.treeId,a],!0)==!1||(i.removeNode(d,a),b&&this.setting.treeObj.trigger(e.event.REMOVE,[d.treeId,a])))},selectNode:function(a,b){if(a&&j.uCanDo(d)){b=d.view.selectedMulti&&b;if(a.parentTId){i.expandCollapseParentNode(d,a.getParentNode(),!0,!1,function(){try{k(a,d).focus().blur()}catch(b){}})}else{try{k(a,d).focus().blur()}catch(c){}}i.selectNode(d,a,b)}},transformTozTreeNodes:function(a){return h.transformTozTreeFormat(d,a)},transformToArray:function(a){return h.transformToArrayFormat(d,a)},updateNode:function(a){a&&k(a,d).get(0)&&j.uCanDo(d)&&(i.setNodeName(d,a),i.setNodeTarget(d,a),i.setNodeUrl(d,a),i.setNodeLineIcos(d,a),i.setNodeFontCss(d,a))}};b.treeTools=c;h.setZTreeTools(d,c);b[a]&&b[a].length>0?i.createNodes(d,0,b[a]):d.async.enable&&d.async.url&&d.async.url!==""&&i.asyncNode(d);return c}};var N=p.fn.zTree,k=j.$,e=N.consts})(jQuery);(function(L){var C,D,A,K={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},E={check:{enable:!1,autoCheckTrigger:!1,chkStyle:K.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:K.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}};C=function(Q,R){if(R.chkDisabled===!0){return !1}var P=N.getSetting(Q.data.treeId),O=P.data.key.checked;if(I.apply(P.callback.beforeCheck,[P.treeId,R],!0)==!1){return !0}R[O]=!R[O];J.checkNodeRelation(P,R);O=M(R,H.id.CHECK,P);J.setChkClass(P,O,R);J.repairParentChkClassWithSelf(P,R);P.treeObj.trigger(H.event.CHECK,[Q,P.treeId,R]);return !0};D=function(Q,R){if(R.chkDisabled===!0){return !1}var P=N.getSetting(Q.data.treeId),O=M(R,H.id.CHECK,P);R.check_Focus=!0;J.setChkClass(P,O,R);return !0};A=function(Q,R){if(R.chkDisabled===!0){return !1}var P=N.getSetting(Q.data.treeId),O=M(R,H.id.CHECK,P);R.check_Focus=!1;J.setChkClass(P,O,R);return !0};L.extend(!0,L.fn.zTree.consts,K);L.extend(!0,L.fn.zTree._z,{tools:{},view:{checkNodeRelation:function(S,T){var R,V,O,P=S.data.key.children,Q=S.data.key.checked;R=H.radio;if(S.check.chkStyle==R.STYLE){var U=N.getRadioCheckedList(S);if(T[Q]){if(S.check.radioType==R.TYPE_ALL){for(V=U.length-1;V>=0;V--){R=U[V],R[Q]&&R!=T&&(R[Q]=!1,U.splice(V,1),J.setChkClass(S,M(R,H.id.CHECK,S),R),R.parentTId!=T.parentTId&&J.repairParentChkClassWithSelf(S,R))}U.push(T)}else{U=T.parentTId?T.getParentNode():N.getRoot(S);for(V=0,O=U[P].length;V<O;V++){R=U[P][V],R[Q]&&R!=T&&(R[Q]=!1,J.setChkClass(S,M(R,H.id.CHECK,S),R))}}}else{if(S.check.radioType==R.TYPE_ALL){for(V=0,O=U.length;V<O;V++){if(T==U[V]){U.splice(V,1);break}}}}}else{T[Q]&&(!T[P]||T[P].length==0||S.check.chkboxType.Y.indexOf("s")>-1)&&J.setSonNodeCheckBox(S,T,!0),!T[Q]&&(!T[P]||T[P].length==0||S.check.chkboxType.N.indexOf("s")>-1)&&J.setSonNodeCheckBox(S,T,!1),T[Q]&&S.check.chkboxType.Y.indexOf("p")>-1&&J.setParentNodeCheckBox(S,T,!0),!T[Q]&&S.check.chkboxType.N.indexOf("p")>-1&&J.setParentNodeCheckBox(S,T,!1)}},makeChkClass:function(S,T){var R=S.data.key.checked,P=H.checkbox,O=H.radio,Q="",Q=T.chkDisabled===!0?P.DISABLED:T.halfCheck?P.PART:S.check.chkStyle==O.STYLE?T.check_Child_State<1?P.FULL:P.PART:T[R]?T.check_Child_State===2||T.check_Child_State===-1?P.FULL:P.PART:T.check_Child_State<1?P.FULL:P.PART,R=S.check.chkStyle+"_"+(T[R]?P.TRUE:P.FALSE)+"_"+Q,R=T.check_Focus&&T.chkDisabled!==!0?R+"_"+P.FOCUS:R;return H.className.BUTTON+" "+P.DEFAULT+" "+R},repairAllChk:function(S,T){if(S.check.enable&&S.check.chkStyle===H.checkbox.STYLE){for(var R=S.data.key.checked,V=S.data.key.children,O=N.getRoot(S),P=0,Q=O[V].length;P<Q;P++){var U=O[V][P];U.nocheck!==!0&&U.chkDisabled!==!0&&(U[R]=T);J.setSonNodeCheckBox(S,U,T)}}},repairChkClass:function(P,Q){if(Q&&(N.makeChkFlag(P,Q),Q.nocheck!==!0)){var O=M(Q,H.id.CHECK,P);J.setChkClass(P,O,Q)}},repairParentChkClass:function(P,Q){if(Q&&Q.parentTId){var O=Q.getParentNode();J.repairChkClass(P,O);J.repairParentChkClass(P,O)}},repairParentChkClassWithSelf:function(P,Q){if(Q){var O=P.data.key.children;Q[O]&&Q[O].length>0?J.repairParentChkClass(P,Q[O][0]):J.repairParentChkClass(P,Q)}},repairSonChkDisabled:function(T,U,S,P){if(U){var O=T.data.key.children;if(U.chkDisabled!=S){U.chkDisabled=S}J.repairChkClass(T,U);if(U[O]&&P){for(var Q=0,R=U[O].length;Q<R;Q++){J.repairSonChkDisabled(T,U[O][Q],S,P)}}}},repairParentChkDisabled:function(Q,R,P,O){if(R){if(R.chkDisabled!=P&&O){R.chkDisabled=P}J.repairChkClass(Q,R);J.repairParentChkDisabled(Q,R.getParentNode(),P,O)}},setChkClass:function(P,Q,O){Q&&(O.nocheck===!0?Q.hide():Q.show(),Q.attr("class",J.makeChkClass(P,O)))},setParentNodeCheckBox:function(T,U,S,W){var P=T.data.key.children,Q=T.data.key.checked,R=M(U,H.id.CHECK,T);W||(W=U);N.makeChkFlag(T,U);U.nocheck!==!0&&U.chkDisabled!==!0&&(U[Q]=S,J.setChkClass(T,R,U),T.check.autoCheckTrigger&&U!=W&&T.treeObj.trigger(H.event.CHECK,[null,T.treeId,U]));if(U.parentTId){R=!0;if(!S){for(var P=U.getParentNode()[P],V=0,O=P.length;V<O;V++){if(P[V].nocheck!==!0&&P[V].chkDisabled!==!0&&P[V][Q]||(P[V].nocheck===!0||P[V].chkDisabled===!0)&&P[V].check_Child_State>0){R=!1;break}}}R&&J.setParentNodeCheckBox(T,U.getParentNode(),S,W)}},setSonNodeCheckBox:function(V,W,U,Y){if(W){var P=V.data.key.children,Q=V.data.key.checked,S=M(W,H.id.CHECK,V);Y||(Y=W);var X=!1;if(W[P]){for(var O=0,T=W[P].length;O<T&&W.chkDisabled!==!0;O++){var R=W[P][O];J.setSonNodeCheckBox(V,R,U,Y);R.chkDisabled===!0&&(X=!0)}}if(W!=N.getRoot(V)&&W.chkDisabled!==!0){X&&W.nocheck!==!0&&N.makeChkFlag(V,W);if(W.nocheck!==!0&&W.chkDisabled!==!0){if(W[Q]=U,!X){W.check_Child_State=W[P]&&W[P].length>0?U?2:0:-1}}else{W.check_Child_State=-1}J.setChkClass(V,S,W);V.check.autoCheckTrigger&&W!=Y&&W.nocheck!==!0&&W.chkDisabled!==!0&&V.treeObj.trigger(H.event.CHECK,[null,V.treeId,W])}}}},event:{},data:{getRadioCheckedList:function(Q){for(var R=N.getRoot(Q).radioCheckedList,P=0,O=R.length;P<O;P++){N.getNodeCache(Q,R[P].tId)||(R.splice(P,1),P--,O--)}return R},getCheckStatus:function(P,Q){if(!P.check.enable||Q.nocheck||Q.chkDisabled){return null}var O=P.data.key.checked;return{checked:Q[O],half:Q.halfCheck?Q.halfCheck:P.check.chkStyle==H.radio.STYLE?Q.check_Child_State===2:Q[O]?Q.check_Child_State>-1&&Q.check_Child_State<2:Q.check_Child_State>0}},getTreeCheckedNodes:function(T,U,S,W){if(!U){return[]}for(var Q=T.data.key.children,R=T.data.key.checked,O=S&&T.check.chkStyle==H.radio.STYLE&&T.check.radioType==H.radio.TYPE_ALL,W=!W?[]:W,V=0,P=U.length;V<P;V++){if(U[V].nocheck!==!0&&U[V].chkDisabled!==!0&&U[V][R]==S&&(W.push(U[V]),O)){break}N.getTreeCheckedNodes(T,U[V][Q],S,W);if(O&&W.length>0){break}}return W},getTreeChangeCheckedNodes:function(T,U,S){if(!U){return[]}for(var P=T.data.key.children,O=T.data.key.checked,S=!S?[]:S,Q=0,R=U.length;Q<R;Q++){U[Q].nocheck!==!0&&U[Q].chkDisabled!==!0&&U[Q][O]!=U[Q].checkedOld&&S.push(U[Q]),N.getTreeChangeCheckedNodes(T,U[Q][P],S)}return S},makeChkFlag:function(S,T){if(T){var R=S.data.key.children,W=S.data.key.checked,P=-1;if(T[R]){for(var Q=0,O=T[R].length;Q<O;Q++){var V=T[R][Q],U=-1;if(S.check.chkStyle==H.radio.STYLE){if(U=V.nocheck===!0||V.chkDisabled===!0?V.check_Child_State:V.halfCheck===!0?2:V[W]?2:V.check_Child_State>0?2:0,U==2){P=2;break}else{U==0&&(P=0)}}else{if(S.check.chkStyle==H.checkbox.STYLE){if(U=V.nocheck===!0||V.chkDisabled===!0?V.check_Child_State:V.halfCheck===!0?1:V[W]?V.check_Child_State===-1||V.check_Child_State===2?2:1:V.check_Child_State>0?1:0,U===1){P=1;break}else{if(U===2&&P>-1&&Q>0&&U!==P){P=1;break}else{if(P===2&&U>-1&&U<2){P=1;break}else{U>-1&&(P=U)}}}}}}}T.check_Child_State=P}}}});var L=L.fn.zTree,I=L._z.tools,H=L.consts,J=L._z.view,N=L._z.data,M=I.$;N.exSetting(E);N.addInitBind(function(O){O.treeObj.bind(H.event.CHECK,function(S,R,Q,P){S.srcEvent=R;I.apply(O.callback.onCheck,[S,Q,P])})});N.addInitUnBind(function(O){O.treeObj.unbind(H.event.CHECK)});N.addInitCache(function(){});N.addInitNode(function(Q,R,P,O){if(P){R=Q.data.key.checked;typeof P[R]=="string"&&(P[R]=I.eqs(P[R],"true"));P[R]=!!P[R];P.checkedOld=P[R];if(typeof P.nocheck=="string"){P.nocheck=I.eqs(P.nocheck,"true")}P.nocheck=!!P.nocheck||Q.check.nocheckInherit&&O&&!!O.nocheck;if(typeof P.chkDisabled=="string"){P.chkDisabled=I.eqs(P.chkDisabled,"true")}P.chkDisabled=!!P.chkDisabled||Q.check.chkDisabledInherit&&O&&!!O.chkDisabled;if(typeof P.halfCheck=="string"){P.halfCheck=I.eqs(P.halfCheck,"true")}P.halfCheck=!!P.halfCheck;P.check_Child_State=-1;P.check_Focus=!1;P.getCheckStatus=function(){return N.getCheckStatus(Q,P)};Q.check.chkStyle==H.radio.STYLE&&Q.check.radioType==H.radio.TYPE_ALL&&P[R]&&N.getRoot(Q).radioCheckedList.push(P)}});N.addInitProxy(function(T){var U=T.target,S=N.getSetting(T.data.treeId),P="",O=null,Q="",R=null;if(I.eqs(T.type,"mouseover")){if(S.check.enable&&I.eqs(U.tagName,"span")&&U.getAttribute("treeNode"+H.id.CHECK)!==null){P=I.getNodeMainDom(U).id,Q="mouseoverCheck"}}else{if(I.eqs(T.type,"mouseout")){if(S.check.enable&&I.eqs(U.tagName,"span")&&U.getAttribute("treeNode"+H.id.CHECK)!==null){P=I.getNodeMainDom(U).id,Q="mouseoutCheck"}}else{if(I.eqs(T.type,"click")&&S.check.enable&&I.eqs(U.tagName,"span")&&U.getAttribute("treeNode"+H.id.CHECK)!==null){P=I.getNodeMainDom(U).id,Q="checkNode"}}}if(P.length>0){switch(O=N.getNodeCache(S,P),Q){case"checkNode":R=C;break;case"mouseoverCheck":R=D;break;case"mouseoutCheck":R=A}}return{stop:Q==="checkNode",node:O,nodeEventType:Q,nodeEventCallback:R,treeEventType:"",treeEventCallback:null}},!0);N.addInitRoot(function(O){N.getRoot(O).radioCheckedList=[]});N.addBeforeA(function(P,Q,O){P.check.enable&&(N.makeChkFlag(P,Q),O.push("<span ID='",Q.tId,H.id.CHECK,"' class='",J.makeChkClass(P,Q),"' treeNode",H.id.CHECK,Q.nocheck===!0?" style='display:none;'":"","></span>"))});N.addZTreeTools(function(P,Q){Q.checkNode=function(U,S,T,V){var R=this.setting.data.key.checked;if(U.chkDisabled!==!0&&(S!==!0&&S!==!1&&(S=!U[R]),V=!!V,(U[R]!==S||T)&&!(V&&I.apply(this.setting.callback.beforeCheck,[this.setting.treeId,U],!0)==!1)&&I.uCanDo(this.setting)&&this.setting.check.enable&&U.nocheck!==!0)){U[R]=S,S=M(U,H.id.CHECK,this.setting),(T||this.setting.check.chkStyle===H.radio.STYLE)&&J.checkNodeRelation(this.setting,U),J.setChkClass(this.setting,S,U),J.repairParentChkClassWithSelf(this.setting,U),V&&this.setting.treeObj.trigger(H.event.CHECK,[null,this.setting.treeId,U])}};Q.checkAllNodes=function(R){J.repairAllChk(this.setting,!!R)};Q.getCheckedNodes=function(S){var R=this.setting.data.key.children;return N.getTreeCheckedNodes(this.setting,N.getRoot(this.setting)[R],S!==!1)};Q.getChangeCheckedNodes=function(){var R=this.setting.data.key.children;return N.getTreeChangeCheckedNodes(this.setting,N.getRoot(this.setting)[R])};Q.setChkDisabled=function(T,R,S,U){R=!!R;S=!!S;J.repairSonChkDisabled(this.setting,T,R,!!U);J.repairParentChkDisabled(this.setting,T.getParentNode(),R,S)};var O=Q.updateNode;Q.updateNode=function(S,T){O&&O.apply(Q,arguments);if(S&&this.setting.check.enable&&M(S,this.setting).get(0)&&I.uCanDo(this.setting)){var R=M(S,H.id.CHECK,this.setting);(T==!0||this.setting.check.chkStyle===H.radio.STYLE)&&J.checkNodeRelation(this.setting,S);J.setChkClass(this.setting,R,S);J.repairParentChkClassWithSelf(this.setting,S)}}});var B=J.createNodes;J.createNodes=function(Q,R,P,O){B&&B.apply(J,arguments);P&&J.repairParentChkClassWithSelf(Q,O)};var F=J.removeNode;J.removeNode=function(P,Q){var O=Q.getParentNode();F&&F.apply(J,arguments);Q&&O&&(J.repairChkClass(P,O),J.repairParentChkClass(P,O))};var G=J.appendNodes;J.appendNodes=function(S,T,R,P,O,Q){var U="";G&&(U=G.apply(J,arguments));P&&N.makeChkFlag(S,P);return U}})(jQuery);(function(E){var B={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},M={onHoverOverNode:function(I,N){var L=J.getSetting(I.data.treeId),H=J.getRoot(L);if(H.curHoverNode!=N){M.onHoverOutNode(I)}H.curHoverNode=N;T.addHoverDom(L,N)},onHoverOutNode:function(H){var H=J.getSetting(H.data.treeId),I=J.getRoot(H);if(I.curHoverNode&&!J.isSelectedNode(H,I.curHoverNode)){T.removeTreeDom(H,I.curHoverNode),I.curHoverNode=null}},onMousedownNode:function(w,z){function y(r){if(Aj.dragFlag==0&&Math.abs(Ae-r.clientX)<Ac.edit.drag.minMoveSize&&Math.abs(Af-r.clientY)<Ac.edit.drag.minMoveSize){return !0}var u,H,l,e,h;h=Ac.data.key.children;Ah.css("cursor","pointer");if(Aj.dragFlag==0){if(U.apply(Ac.callback.beforeDrag,[Ac.treeId,n],!0)==!1){return I(r),!0}for(u=0,H=n.length;u<H;u++){if(u==0){Aj.dragNodeShowBefore=[]}l=n[u];l.isParent&&l.open?(T.expandCollapseNode(Ac,l,!l.open),Aj.dragNodeShowBefore[l.tId]=!0):Aj.dragNodeShowBefore[l.tId]=!1}Aj.dragFlag=1;Y.showHoverDom=!1;U.showIfameMask(Ac,!0);l=!0;e=-1;if(n.length>1){var O=n[0].parentTId?n[0].getParentNode()[h]:J.getNodes(Ac);h=[];for(u=0,H=O.length;u<H;u++){if(Aj.dragNodeShowBefore[O[u].tId]!==void 0&&(l&&e>-1&&e+1!==u&&(l=!1),h.push(O[u]),e=u),n.length===h.length){n=h;break}}}l&&(Ad=n[0].getPreNode(),o=n[n.length-1].getNextNode());Am=G("<ul class='zTreeDragUL'></ul>",Ac);for(u=0,H=n.length;u<H;u++){l=n[u],l.editNameFlag=!1,T.selectNode(Ac,l,u>0),T.removeTreeDom(Ac,l),u>Ac.edit.drag.maxShowNodeNum-1||(e=G("<li id='"+l.tId+"_tmp'></li>",Ac),e.append(G(l,W.id.A,Ac).clone()),e.css("padding","0"),e.children("#"+l.tId+W.id.A).removeClass(W.node.CURSELECTED),Am.append(e),u==Ac.edit.drag.maxShowNodeNum-1&&(e=G("<li id='"+l.tId+"_moretmp'><a>  ...  </a></li>",Ac),Am.append(e)))}Am.attr("id",n[0].tId+W.id.UL+"_tmp");Am.addClass(Ac.treeObj.attr("class"));Am.appendTo(Ah);Ai=G("<span class='tmpzTreeMove_arrow'></span>",Ac);Ai.attr("id","zTreeMove_arrow_tmp");Ai.appendTo(Ah);Ac.treeObj.trigger(W.event.DRAG,[r,Ac.treeId,n])}if(Aj.dragFlag==1){P&&Ai.attr("id")==r.target.id&&Z&&r.clientX+Al.scrollLeft()+2>E("#"+Z+W.id.A,P).offset().left?(l=E("#"+Z+W.id.A,P),r.target=l.length>0?l.get(0):r.target):P&&(P.removeClass(W.node.TMPTARGET_TREE),Z&&E("#"+Z+W.id.A,P).removeClass(W.node.TMPTARGET_NODE+"_"+W.move.TYPE_PREV).removeClass(W.node.TMPTARGET_NODE+"_"+B.move.TYPE_NEXT).removeClass(W.node.TMPTARGET_NODE+"_"+B.move.TYPE_INNER));Z=P=null;X=!1;g=Ac;l=J.getSettings();for(var As in l){if(l[As].treeId&&l[As].edit.enable&&l[As].treeId!=Ac.treeId&&(r.target.id==l[As].treeId||E(r.target).parents("#"+l[As].treeId).length>0)){X=!0,g=l[As]}}As=Al.scrollTop();e=Al.scrollLeft();h=g.treeObj.offset();u=g.treeObj.get(0).scrollHeight;l=g.treeObj.get(0).scrollWidth;H=r.clientY+As-h.top;var L=g.treeObj.height()+h.top-r.clientY-As,N=r.clientX+e-h.left,Ar=g.treeObj.width()+h.left-r.clientX-e;h=H<Ac.edit.drag.borderMax&&H>Ac.edit.drag.borderMin;var O=L<Ac.edit.drag.borderMax&&L>Ac.edit.drag.borderMin,v=N<Ac.edit.drag.borderMax&&N>Ac.edit.drag.borderMin,Ao=Ar<Ac.edit.drag.borderMax&&Ar>Ac.edit.drag.borderMin,L=H>Ac.edit.drag.borderMin&&L>Ac.edit.drag.borderMin&&N>Ac.edit.drag.borderMin&&Ar>Ac.edit.drag.borderMin,N=h&&g.treeObj.scrollTop()<=0,Ar=O&&g.treeObj.scrollTop()+g.treeObj.height()+10>=u,s=v&&g.treeObj.scrollLeft()<=0,t=Ao&&g.treeObj.scrollLeft()+g.treeObj.width()+10>=l;if(r.target&&U.isChildOrSelf(r.target,g.treeId)){for(var Ap=r.target;Ap&&Ap.tagName&&!U.eqs(Ap.tagName,"li")&&Ap.id!=g.treeId;){Ap=Ap.parentNode}var At=!0;for(u=0,H=n.length;u<H;u++){if(l=n[u],Ap.id===l.tId){At=!1;break}else{if(G(l,Ac).find("#"+Ap.id).length>0){At=!1;break}}}if(At&&r.target&&U.isChildOrSelf(r.target,Ap.id+W.id.A)){P=E(Ap),Z=Ap.id}}l=n[0];if(L&&U.isChildOrSelf(r.target,g.treeId)){if(!P&&(r.target.id==g.treeId||N||Ar||s||t)&&(X||!X&&l.parentTId)){P=g.treeObj}h?g.treeObj.scrollTop(g.treeObj.scrollTop()-10):O&&g.treeObj.scrollTop(g.treeObj.scrollTop()+10);v?g.treeObj.scrollLeft(g.treeObj.scrollLeft()-10):Ao&&g.treeObj.scrollLeft(g.treeObj.scrollLeft()+10);P&&P!=g.treeObj&&P.offset().left<g.treeObj.offset().left&&g.treeObj.scrollLeft(g.treeObj.scrollLeft()+P.offset().left-g.treeObj.offset().left)}Am.css({top:r.clientY+As+3+"px",left:r.clientX+e+3+"px"});h=u=0;if(P&&P.attr("id")!=g.treeId){var Aq=Z==null?null:J.getNodeCache(g,Z);H=(r.ctrlKey||r.metaKey)&&Ac.edit.drag.isMove&&Ac.edit.drag.isCopy||!Ac.edit.drag.isMove&&Ac.edit.drag.isCopy;u=!!(Ad&&Z===Ad.tId);h=!!(o&&Z===o.tId);e=l.parentTId&&l.parentTId==Z;l=(H||!h)&&U.apply(g.edit.drag.prev,[g.treeId,n,Aq],!!g.edit.drag.prev);u=(H||!u)&&U.apply(g.edit.drag.next,[g.treeId,n,Aq],!!g.edit.drag.next);Ao=(H||!e)&&!(g.data.keep.leaf&&!Aq.isParent)&&U.apply(g.edit.drag.inner,[g.treeId,n,Aq],!!g.edit.drag.inner);if(!l&&!u&&!Ao){if(P=null,Z="",Ak=W.move.TYPE_INNER,Ai.css({display:"none"}),window.zTreeMoveTimer){clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null}}else{H=E("#"+Z+W.id.A,P);h=Aq.isLastNode?null:E("#"+Aq.getNextNode().tId+W.id.A,P.next());O=H.offset().top;e=H.offset().left;v=l?Ao?0.25:u?0.5:1:-1;Ao=u?Ao?0.75:l?0.5:0:-1;As=(r.clientY+As-O)/H.height();(v==1||As<=v&&As>=-0.2)&&l?(u=1-Ai.width(),h=O-Ai.height()/2,Ak=W.move.TYPE_PREV):(Ao==0||As>=Ao&&As<=1.2)&&u?(u=1-Ai.width(),h=h==null||Aq.isParent&&Aq.open?O+H.height()-Ai.height()/2:h.offset().top-Ai.height()/2,Ak=W.move.TYPE_NEXT):(u=5-Ai.width(),h=O,Ak=W.move.TYPE_INNER);Ai.css({display:"block",top:h+"px",left:e+u+"px"});H.addClass(W.node.TMPTARGET_NODE+"_"+Ak);if(Aa!=Z||Ab!=Ak){Ag=(new Date).getTime()}if(Aq&&Aq.isParent&&Ak==W.move.TYPE_INNER&&(As=!0,window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==Aq.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===Aq.tId&&(As=!1),As)){window.zTreeMoveTimer=setTimeout(function(){Ak==W.move.TYPE_INNER&&Aq&&Aq.isParent&&!Aq.open&&(new Date).getTime()-Ag>g.edit.drag.autoOpenTime&&U.apply(g.callback.beforeDragOpen,[g.treeId,Aq],!0)&&(T.switchNode(g,Aq),g.edit.drag.autoExpandTrigger&&g.treeObj.trigger(W.event.EXPAND,[g.treeId,Aq]))},g.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=Aq.tId}}}else{if(Ak=W.move.TYPE_INNER,P&&U.apply(g.edit.drag.inner,[g.treeId,n,null],!!g.edit.drag.inner)?P.addClass(W.node.TMPTARGET_TREE):P=null,Ai.css({display:"none"}),window.zTreeMoveTimer){clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null}}Aa=Z;Ab=Ak;Ac.treeObj.trigger(W.event.DRAGMOVE,[r,Ac.treeId,n])}return !1}function I(c){if(window.zTreeMoveTimer){clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null}Ab=Aa=null;Al.unbind("mousemove",y);Al.unbind("mouseup",I);Al.unbind("selectstart",f);Ah.css("cursor","auto");P&&(P.removeClass(W.node.TMPTARGET_TREE),Z&&E("#"+Z+W.id.A,P).removeClass(W.node.TMPTARGET_NODE+"_"+W.move.TYPE_PREV).removeClass(W.node.TMPTARGET_NODE+"_"+B.move.TYPE_NEXT).removeClass(W.node.TMPTARGET_NODE+"_"+B.move.TYPE_INNER));U.showIfameMask(Ac,!1);Y.showHoverDom=!0;if(Aj.dragFlag!=0){Aj.dragFlag=0;var e,L,h;for(e=0,L=n.length;e<L;e++){h=n[e],h.isParent&&Aj.dragNodeShowBefore[h.tId]&&!h.open&&(T.expandCollapseNode(Ac,h,!h.open),delete Aj.dragNodeShowBefore[h.tId])}Am&&Am.remove();Ai&&Ai.remove();var N=(c.ctrlKey||c.metaKey)&&Ac.edit.drag.isMove&&Ac.edit.drag.isCopy||!Ac.edit.drag.isMove&&Ac.edit.drag.isCopy;!N&&P&&Z&&n[0].parentTId&&Z==n[0].parentTId&&Ak==W.move.TYPE_INNER&&(P=null);if(P){var O=Z==null?null:J.getNodeCache(g,Z);if(U.apply(Ac.callback.beforeDrop,[g.treeId,n,O,Ak,N],!0)==!1){T.selectNodes(An,n)}else{var H=N?U.clone(n):n;e=function(){if(X){if(!N){for(var i=0,b=n.length;i<b;i++){T.removeNode(Ac,n[i])}}if(Ak==W.move.TYPE_INNER){T.addNodes(g,O,H)}else{if(T.addNodes(g,O.getParentNode(),H),Ak==W.move.TYPE_PREV){for(i=0,b=H.length;i<b;i++){T.moveNode(g,O,H[i],Ak,!1)}}else{for(i=-1,b=H.length-1;i<b;b--){T.moveNode(g,O,H[b],Ak,!1)}}}}else{if(N&&Ak==W.move.TYPE_INNER){T.addNodes(g,O,H)}else{if(N&&T.addNodes(g,O.getParentNode(),H),Ak!=W.move.TYPE_NEXT){for(i=0,b=H.length;i<b;i++){T.moveNode(g,O,H[i],Ak,!1)}}else{for(i=-1,b=H.length-1;i<b;b--){T.moveNode(g,O,H[b],Ak,!1)}}}}T.selectNodes(g,H);G(H[0],Ac).focus().blur();Ac.treeObj.trigger(W.event.DROP,[c,g.treeId,H,O,Ak,N])};Ak==W.move.TYPE_INNER&&U.canAsync(g,O)?T.asyncNode(g,O,!1,e):e()}}else{T.selectNodes(An,n),Ac.treeObj.trigger(W.event.DROP,[c,Ac.treeId,n,null,null,null])}}}function f(){return !1}var m,d,Ac=J.getSetting(w.data.treeId),Aj=J.getRoot(Ac),Y=J.getRoots();if(w.button==2||!Ac.edit.enable||!Ac.edit.drag.isCopy&&!Ac.edit.drag.isMove){return !0}var Q=w.target,V=J.getRoot(Ac).curSelectedList,n=[];if(J.isSelectedNode(Ac,z)){for(m=0,d=V.length;m<d;m++){if(V[m].editNameFlag&&U.eqs(Q.tagName,"input")&&Q.getAttribute("treeNode"+W.id.INPUT)!==null){return !0}n.push(V[m]);if(n[0].parentTId!==V[m].parentTId){n=[z];break}}}else{n=[z]}T.editNodeBlur=!0;T.cancelCurEditNode(Ac);var Al=E(Ac.treeObj.get(0).ownerDocument),Ah=E(Ac.treeObj.get(0).ownerDocument.body),Am,Ai,P,X=!1,g=Ac,An=Ac,Ad,o,Aa=null,Ab=null,Z=null,Ak=W.move.TYPE_INNER,Ae=w.clientX,Af=w.clientY,Ag=(new Date).getTime();U.uCanDo(Ac)&&Al.bind("mousemove",y);Al.bind("mouseup",I);Al.bind("selectstart",f);w.preventDefault&&w.preventDefault();return !0}};E.extend(!0,E.fn.zTree.consts,B);E.extend(!0,E.fn.zTree._z,{tools:{getAbs:function(H){H=H.getBoundingClientRect();return[H.left+(document.body.scrollLeft+document.documentElement.scrollLeft),H.top+(document.body.scrollTop+document.documentElement.scrollTop)]},inputFocus:function(H){H.get(0)&&(H.focus(),U.setCursorPosition(H.get(0),H.val().length))},inputSelect:function(H){H.get(0)&&(H.focus(),H.select())},setCursorPosition:function(H,L){if(H.setSelectionRange){H.focus(),H.setSelectionRange(L,L)}else{if(H.createTextRange){var I=H.createTextRange();I.collapse(!0);I.moveEnd("character",L);I.moveStart("character",L);I.select()}}},showIfameMask:function(N,P){for(var O=J.getRoot(N);O.dragMaskList.length>0;){O.dragMaskList[0].remove(),O.dragMaskList.shift()}if(P){for(var V=G("iframe",N),Q=0,L=V.length;Q<L;Q++){var I=V.get(Q),H=U.getAbs(I),I=G("<div id='zTreeMask_"+Q+"' class='zTreeMask' style='top:"+H[1]+"px; left:"+H[0]+"px; width:"+I.offsetWidth+"px; height:"+I.offsetHeight+"px;'></div>",N);I.appendTo(G("body",N));O.dragMaskList.push(I)}}}},view:{addEditBtn:function(I,N){if(!(N.editNameFlag||G(N,W.id.EDIT,I).length>0)&&U.apply(I.edit.showRenameBtn,[I.treeId,N],I.edit.showRenameBtn)){var L=G(N,W.id.A,I),H="<span class='"+W.className.BUTTON+" edit' id='"+N.tId+W.id.EDIT+"' title='"+U.apply(I.edit.renameTitle,[I.treeId,N],I.edit.renameTitle)+"' treeNode"+W.id.EDIT+" style='display:none;'></span>";L.append(H);G(N,W.id.EDIT,I).bind("click",function(){if(!U.uCanDo(I)||U.apply(I.callback.beforeEditName,[I.treeId,N],!0)==!1){return !1}T.editNode(I,N);return !1}).show()}},addRemoveBtn:function(I,N){if(!(N.editNameFlag||G(N,W.id.REMOVE,I).length>0)&&U.apply(I.edit.showRemoveBtn,[I.treeId,N],I.edit.showRemoveBtn)){var L=G(N,W.id.A,I),H="<span class='"+W.className.BUTTON+" remove' id='"+N.tId+W.id.REMOVE+"' title='"+U.apply(I.edit.removeTitle,[I.treeId,N],I.edit.removeTitle)+"' treeNode"+W.id.REMOVE+" style='display:none;'></span>";L.append(H);G(N,W.id.REMOVE,I).bind("click",function(){if(!U.uCanDo(I)||U.apply(I.callback.beforeRemove,[I.treeId,N],!0)==!1){return !1}T.removeNode(I,N);I.treeObj.trigger(W.event.REMOVE,[I.treeId,N]);return !1}).bind("mousedown",function(){return !0}).show()}},addHoverDom:function(H,I){if(J.getRoots().showHoverDom){I.isHover=!0,H.edit.enable&&(T.addEditBtn(H,I),T.addRemoveBtn(H,I)),U.apply(H.view.addHoverDom,[H.treeId,I])}},cancelCurEditNode:function(N,P,O){var I=J.getRoot(N),Q=N.data.key.name,L=I.curEditNode;if(L){var H=I.curEditInput,P=P?P:O?L[Q]:H.val();if(U.apply(N.callback.beforeRename,[N.treeId,L,P,O],!0)===!1){return !1}else{L[Q]=P,N.treeObj.trigger(W.event.RENAME,[N.treeId,L,O])}G(L,W.id.A,N).removeClass(W.node.CURSELECTED_EDIT);H.unbind();T.setNodeName(N,L);L.editNameFlag=!1;I.curEditNode=null;I.curEditInput=null;T.selectNode(N,L,!1)}return I.noSelection=!0},editNode:function(I,N){var L=J.getRoot(I);T.editNodeBlur=!1;if(J.isSelectedNode(I,N)&&L.curEditNode==N&&N.editNameFlag){setTimeout(function(){U.inputFocus(L.curEditInput)},0)}else{var H=I.data.key.name;N.editNameFlag=!0;T.removeTreeDom(I,N);T.cancelCurEditNode(I);T.selectNode(I,N,!1);G(N,W.id.SPAN,I).html("<input type=text class='rename' id='"+N.tId+W.id.INPUT+"' treeNode"+W.id.INPUT+" >");var O=G(N,W.id.INPUT,I);O.attr("value",N[H]);I.edit.editNameSelectAll?U.inputSelect(O):U.inputFocus(O);O.bind("blur",function(){T.editNodeBlur||T.cancelCurEditNode(I)}).bind("keydown",function(P){P.keyCode=="13"?(T.editNodeBlur=!0,T.cancelCurEditNode(I)):P.keyCode=="27"&&T.cancelCurEditNode(I,null,!0)}).bind("click",function(){return !1}).bind("dblclick",function(){return !1});G(N,W.id.A,I).addClass(W.node.CURSELECTED_EDIT);L.curEditInput=O;L.noSelection=!1;L.curEditNode=N}},moveNode:function(d,h,f,H,V,X){var Q=J.getRoot(d),N=d.data.key.children;if(h!=f&&(!d.data.keep.leaf||!h||h.isParent||H!=W.move.TYPE_INNER)){var n=f.parentTId?f.getParentNode():Q,P=h===null||h==Q;P&&h===null&&(h=Q);if(P){H=W.move.TYPE_INNER}Q=h.parentTId?h.getParentNode():Q;if(H!=W.move.TYPE_PREV&&H!=W.move.TYPE_NEXT){H=W.move.TYPE_INNER}if(H==W.move.TYPE_INNER){if(P){f.parentTId=null}else{if(!h.isParent){h.isParent=!0,h.open=!!h.open,T.setNodeLineIcos(d,h)}f.parentTId=h.tId}}var I;P?I=P=d.treeObj:(!X&&H==W.move.TYPE_INNER?T.expandCollapseNode(d,h,!0,!1):X||T.expandCollapseNode(d,h.getParentNode(),!0,!1),P=G(h,d),I=G(h,W.id.UL,d),P.get(0)&&!I.get(0)&&(I=[],T.makeUlHtml(d,h,I,""),P.append(I.join(""))),I=G(h,W.id.UL,d));var L=G(f,d);L.get(0)?P.get(0)||L.remove():L=T.appendNodes(d,f.level,[f],null,!1,!0).join("");I.get(0)&&H==W.move.TYPE_INNER?I.append(L):P.get(0)&&H==W.move.TYPE_PREV?P.before(L):P.get(0)&&H==W.move.TYPE_NEXT&&P.after(L);var Z=-1,O=0,m=null,P=null,Y=f.level;if(f.isFirstNode){if(Z=0,n[N].length>1){m=n[N][1],m.isFirstNode=!0}}else{if(f.isLastNode){Z=n[N].length-1,m=n[N][Z-1],m.isLastNode=!0}else{for(I=0,L=n[N].length;I<L;I++){if(n[N][I].tId==f.tId){Z=I;break}}}}Z>=0&&n[N].splice(Z,1);if(H!=W.move.TYPE_INNER){for(I=0,L=Q[N].length;I<L;I++){Q[N][I].tId==h.tId&&(O=I)}}if(H==W.move.TYPE_INNER){h[N]||(h[N]=[]);if(h[N].length>0){P=h[N][h[N].length-1],P.isLastNode=!1}h[N].splice(h[N].length,0,f);f.isLastNode=!0;f.isFirstNode=h[N].length==1}else{h.isFirstNode&&H==W.move.TYPE_PREV?(Q[N].splice(O,0,f),P=h,P.isFirstNode=!1,f.parentTId=h.parentTId,f.isFirstNode=!0,f.isLastNode=!1):h.isLastNode&&H==W.move.TYPE_NEXT?(Q[N].splice(O+1,0,f),P=h,P.isLastNode=!1,f.parentTId=h.parentTId,f.isFirstNode=!1,f.isLastNode=!0):(H==W.move.TYPE_PREV?Q[N].splice(O,0,f):Q[N].splice(O+1,0,f),f.parentTId=h.parentTId,f.isFirstNode=!1,f.isLastNode=!1)}J.fixPIdKeyValue(d,f);J.setSonNodeLevel(d,f.getParentNode(),f);T.setNodeLineIcos(d,f);T.repairNodeLevelClass(d,f,Y);!d.data.keep.parent&&n[N].length<1?(n.isParent=!1,n.open=!1,h=G(n,W.id.UL,d),H=G(n,W.id.SWITCH,d),N=G(n,W.id.ICON,d),T.replaceSwitchClass(n,H,W.folder.DOCU),T.replaceIcoClass(n,N,W.folder.DOCU),h.css("display","none")):m&&T.setNodeLineIcos(d,m);P&&T.setNodeLineIcos(d,P);d.check&&d.check.enable&&T.repairChkClass&&(T.repairChkClass(d,n),T.repairParentChkClassWithSelf(d,n),n!=f.parent&&T.repairParentChkClassWithSelf(d,f));X||T.expandCollapseParentNode(d,f.getParentNode(),!0,V)}},removeEditBtn:function(H,I){G(I,W.id.EDIT,H).unbind().remove()},removeRemoveBtn:function(H,I){G(I,W.id.REMOVE,H).unbind().remove()},removeTreeDom:function(H,I){I.isHover=!1;T.removeEditBtn(H,I);T.removeRemoveBtn(H,I);U.apply(H.view.removeHoverDom,[H.treeId,I])},repairNodeLevelClass:function(I,N,L){if(L!==N.level){var O=G(N,I),H=G(N,W.id.A,I),I=G(N,W.id.UL,I),L=W.className.LEVEL+L,N=W.className.LEVEL+N.level;O.removeClass(L);O.addClass(N);H.removeClass(L);H.addClass(N);I.removeClass(L);I.addClass(N)}},selectNodes:function(I,N){for(var L=0,H=N.length;L<H;L++){T.selectNode(I,N[L],L>0)}}},event:{},data:{setSonNodeLevel:function(I,N,L){if(L){var H=I.data.key.children;L.level=N?N.level+1:0;if(L[H]){for(var N=0,O=L[H].length;N<O;N++){L[H][N]&&J.setSonNodeLevel(I,L,L[H][N])}}}}}});var A=E.fn.zTree,U=A._z.tools,W=A.consts,T=A._z.view,J=A._z.data,G=U.$;J.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}});J.addInitBind(function(H){var L=H.treeObj,I=W.event;L.bind(I.RENAME,function(P,O,N,Q){U.apply(H.callback.onRename,[P,O,N,Q])});L.bind(I.DRAG,function(P,O,N,Q){U.apply(H.callback.onDrag,[O,N,Q])});L.bind(I.DRAGMOVE,function(P,O,N,Q){U.apply(H.callback.onDragMove,[O,N,Q])});L.bind(I.DROP,function(X,V,N,Y,O,Q,P){U.apply(H.callback.onDrop,[V,N,Y,O,Q,P])})});J.addInitUnBind(function(H){var H=H.treeObj,I=W.event;H.unbind(I.RENAME);H.unbind(I.DRAG);H.unbind(I.DRAGMOVE);H.unbind(I.DROP)});J.addInitCache(function(){});J.addInitNode(function(H,L,I){if(I){I.isHover=!1,I.editNameFlag=!1}});J.addInitProxy(function(P){var V=P.target,Q=J.getSetting(P.data.treeId),X=P.relatedTarget,L="",N=null,I="",H=null,O=null;if(U.eqs(P.type,"mouseover")){if(O=U.getMDom(Q,V,[{tagName:"a",attrName:"treeNode"+W.id.A}])){L=U.getNodeMainDom(O).id,I="hoverOverNode"}}else{if(U.eqs(P.type,"mouseout")){O=U.getMDom(Q,X,[{tagName:"a",attrName:"treeNode"+W.id.A}]),O||(L="remove",I="hoverOutNode")}else{if(U.eqs(P.type,"mousedown")&&(O=U.getMDom(Q,V,[{tagName:"a",attrName:"treeNode"+W.id.A}]))){L=U.getNodeMainDom(O).id,I="mousedownNode"}}}if(L.length>0){switch(N=J.getNodeCache(Q,L),I){case"mousedownNode":H=M.onMousedownNode;break;case"hoverOverNode":H=M.onHoverOverNode;break;case"hoverOutNode":H=M.onHoverOutNode}}return{stop:!1,node:N,nodeEventType:I,nodeEventCallback:H,treeEventType:"",treeEventCallback:null}});J.addInitRoot(function(H){var H=J.getRoot(H),I=J.getRoots();H.curEditNode=null;H.curEditInput=null;H.curHoverNode=null;H.dragFlag=0;H.dragNodeShowBefore=[];H.dragMaskList=[];I.showHoverDom=!0});J.addZTreeTools(function(H,I){I.cancelEditName=function(L){J.getRoot(this.setting).curEditNode&&T.cancelCurEditNode(this.setting,L?L:null,!0)};I.copyNode=function(Q,P,V,N){if(!P){return null}if(Q&&!Q.isParent&&this.setting.data.keep.leaf&&V===W.move.TYPE_INNER){return null}var L=this,O=U.clone(P);if(!Q){Q=null,V=W.move.TYPE_INNER}V==W.move.TYPE_INNER?(P=function(){T.addNodes(L.setting,Q,[O],N)},U.canAsync(this.setting,Q)?T.asyncNode(this.setting,Q,N,P):P()):(T.addNodes(this.setting,Q.parentNode,[O],N),T.moveNode(this.setting,Q,O,V,!1,N));return O};I.editName=function(L){L&&L.tId&&L===J.getNodeCache(this.setting,L.tId)&&(L.parentTId&&T.expandCollapseParentNode(this.setting,L.getParentNode(),!0),T.editNode(this.setting,L))};I.moveNode=function(Q,P,V,N){function L(){T.moveNode(O.setting,Q,P,V,!1,N)}if(!P){return P}if(Q&&!Q.isParent&&this.setting.data.keep.leaf&&V===W.move.TYPE_INNER){return null}else{if(Q&&(P.parentTId==Q.tId&&V==W.move.TYPE_INNER||G(P,this.setting).find("#"+Q.tId).length>0)){return null}else{Q||(Q=null)}}var O=this;U.canAsync(this.setting,Q)&&V===W.move.TYPE_INNER?T.asyncNode(this.setting,Q,N,L):L();return P};I.setEditable=function(L){this.setting.edit.enable=L;return this.refresh()}});var C=T.cancelPreSelectedNode;T.cancelPreSelectedNode=function(L,O){for(var N=J.getRoot(L).curSelectedList,I=0,H=N.length;I<H;I++){if(!O||O===N[I]){if(T.removeTreeDom(L,N[I]),O){break}}}C&&C.apply(T,arguments)};var D=T.createNodes;T.createNodes=function(I,N,L,H){D&&D.apply(T,arguments);L&&T.repairParentChkClassWithSelf&&T.repairParentChkClassWithSelf(I,H)};var R=T.makeNodeUrl;T.makeNodeUrl=function(H,I){return H.edit.enable?null:R.apply(T,arguments)};var F=T.removeNode;T.removeNode=function(H,L){var I=J.getRoot(H);if(I.curEditNode===L){I.curEditNode=null}F&&F.apply(T,arguments)};var K=T.selectNode;T.selectNode=function(I,N,L){var H=J.getRoot(I);if(J.isSelectedNode(I,N)&&H.curEditNode==N&&N.editNameFlag){return !1}K&&K.apply(T,arguments);T.addHoverDom(I,N);return !0};var S=U.uCanDo;U.uCanDo=function(H,L){var I=J.getRoot(H);if(L&&(U.eqs(L.type,"mouseover")||U.eqs(L.type,"mouseout")||U.eqs(L.type,"mousedown")||U.eqs(L.type,"mouseup"))){return !0}if(I.curEditNode){T.editNodeBlur=!1,I.curEditInput.focus()}return !I.curEditNode&&(S?S.apply(T,arguments):!0)}})(jQuery);