(function(L){var C,D,A,K={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},E={check:{enable:!1,autoCheckTrigger:!1,chkStyle:K.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:K.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}};C=function(P,R){if(R.chkDisabled===!0){return !1}var Q=N.getSetting(P.data.treeId),O=Q.data.key.checked;if(I.apply(Q.callback.beforeCheck,[Q.treeId,R],!0)==!1){return !0}R[O]=!R[O];J.checkNodeRelation(Q,R);O=M(R,H.id.CHECK,Q);J.setChkClass(Q,O,R);J.repairParentChkClassWithSelf(Q,R);Q.treeObj.trigger(H.event.CHECK,[P,Q.treeId,R]);return !0};D=function(P,R){if(R.chkDisabled===!0){return !1}var Q=N.getSetting(P.data.treeId),O=M(R,H.id.CHECK,Q);R.check_Focus=!0;J.setChkClass(Q,O,R);return !0};A=function(P,R){if(R.chkDisabled===!0){return !1}var Q=N.getSetting(P.data.treeId),O=M(R,H.id.CHECK,Q);R.check_Focus=!1;J.setChkClass(Q,O,R);return !0};L.extend(!0,L.fn.zTree.consts,K);L.extend(!0,L.fn.zTree._z,{tools:{},view:{checkNodeRelation:function(R,T){var S,V,O,P=R.data.key.children,Q=R.data.key.checked;S=H.radio;if(R.check.chkStyle==S.STYLE){var U=N.getRadioCheckedList(R);if(T[Q]){if(R.check.radioType==S.TYPE_ALL){for(V=U.length-1;V>=0;V--){S=U[V],S[Q]=!1,U.splice(V,1),J.setChkClass(R,M(S,H.id.CHECK,R),S),S.parentTId!=T.parentTId&&J.repairParentChkClassWithSelf(R,S)}U.push(T)}else{U=T.parentTId?T.getParentNode():N.getRoot(R);for(V=0,O=U[P].length;V<O;V++){S=U[P][V],S[Q]&&S!=T&&(S[Q]=!1,J.setChkClass(R,M(S,H.id.CHECK,R),S))}}}else{if(R.check.radioType==S.TYPE_ALL){for(V=0,O=U.length;V<O;V++){if(T==U[V]){U.splice(V,1);break}}}}}else{T[Q]&&(!T[P]||T[P].length==0||R.check.chkboxType.Y.indexOf("s")>-1)&&J.setSonNodeCheckBox(R,T,!0),!T[Q]&&(!T[P]||T[P].length==0||R.check.chkboxType.N.indexOf("s")>-1)&&J.setSonNodeCheckBox(R,T,!1),T[Q]&&R.check.chkboxType.Y.indexOf("p")>-1&&J.setParentNodeCheckBox(R,T,!0),!T[Q]&&R.check.chkboxType.N.indexOf("p")>-1&&J.setParentNodeCheckBox(R,T,!1)}},makeChkClass:function(R,T){var S=R.data.key.checked,P=H.checkbox,O=H.radio,Q="",Q=T.chkDisabled===!0?P.DISABLED:T.halfCheck?P.PART:R.check.chkStyle==O.STYLE?T.check_Child_State<1?P.FULL:P.PART:T[S]?T.check_Child_State===2||T.check_Child_State===-1?P.FULL:P.PART:T.check_Child_State<1?P.FULL:P.PART,S=R.check.chkStyle+"_"+(T[S]?P.TRUE:P.FALSE)+"_"+Q,S=T.check_Focus&&T.chkDisabled!==!0?S+"_"+P.FOCUS:S;return H.className.BUTTON+" "+P.DEFAULT+" "+S},repairAllChk:function(R,T){if(R.check.enable&&R.check.chkStyle===H.checkbox.STYLE){for(var S=R.data.key.checked,V=R.data.key.children,O=N.getRoot(R),P=0,Q=O[V].length;P<Q;P++){var U=O[V][P];U.nocheck!==!0&&U.chkDisabled!==!0&&(U[S]=T);J.setSonNodeCheckBox(R,U,T)}}},repairChkClass:function(O,Q){if(Q&&(N.makeChkFlag(O,Q),Q.nocheck!==!0)){var P=M(Q,H.id.CHECK,O);J.setChkClass(O,P,Q)}},repairParentChkClass:function(O,Q){if(Q&&Q.parentTId){var P=Q.getParentNode();J.repairChkClass(O,P);J.repairParentChkClass(O,P)}},repairParentChkClassWithSelf:function(O,Q){if(Q){var P=O.data.key.children;Q[P]&&Q[P].length>0?J.repairParentChkClass(O,Q[P][0]):J.repairParentChkClass(O,Q)}},repairSonChkDisabled:function(S,U,T,P){if(U){var O=S.data.key.children;if(U.chkDisabled!=T){U.chkDisabled=T}J.repairChkClass(S,U);if(U[O]&&P){for(var Q=0,R=U[O].length;Q<R;Q++){J.repairSonChkDisabled(S,U[O][Q],T,P)}}}},repairParentChkDisabled:function(P,R,Q,O){if(R){if(R.chkDisabled!=Q&&O){R.chkDisabled=Q}J.repairChkClass(P,R);J.repairParentChkDisabled(P,R.getParentNode(),Q,O)}},setChkClass:function(O,Q,P){Q&&(P.nocheck===!0?Q.hide():Q.show(),Q.removeClass(),Q.addClass(J.makeChkClass(O,P)))},setParentNodeCheckBox:function(S,U,T,W){var P=S.data.key.children,Q=S.data.key.checked,R=M(U,H.id.CHECK,S);W||(W=U);N.makeChkFlag(S,U);U.nocheck!==!0&&U.chkDisabled!==!0&&(U[Q]=T,J.setChkClass(S,R,U),S.check.autoCheckTrigger&&U!=W&&S.treeObj.trigger(H.event.CHECK,[null,S.treeId,U]));if(U.parentTId){R=!0;if(!T){for(var P=U.getParentNode()[P],V=0,O=P.length;V<O;V++){if(P[V].nocheck!==!0&&P[V].chkDisabled!==!0&&P[V][Q]||(P[V].nocheck===!0||P[V].chkDisabled===!0)&&P[V].check_Child_State>0){R=!1;break}}}R&&J.setParentNodeCheckBox(S,U.getParentNode(),T,W)}},setSonNodeCheckBox:function(U,W,V,Y){if(W){var P=U.data.key.children,Q=U.data.key.checked,S=M(W,H.id.CHECK,U);Y||(Y=W);var X=!1;if(W[P]){for(var O=0,T=W[P].length;O<T&&W.chkDisabled!==!0;O++){var R=W[P][O];J.setSonNodeCheckBox(U,R,V,Y);R.chkDisabled===!0&&(X=!0)}}if(W!=N.getRoot(U)&&W.chkDisabled!==!0){X&&W.nocheck!==!0&&N.makeChkFlag(U,W);if(W.nocheck!==!0&&W.chkDisabled!==!0){if(W[Q]=V,!X){W.check_Child_State=W[P]&&W[P].length>0?V?2:0:-1}}else{W.check_Child_State=-1}J.setChkClass(U,S,W);U.check.autoCheckTrigger&&W!=Y&&W.nocheck!==!0&&W.chkDisabled!==!0&&U.treeObj.trigger(H.event.CHECK,[null,U.treeId,W])}}}},event:{},data:{getRadioCheckedList:function(P){for(var R=N.getRoot(P).radioCheckedList,Q=0,O=R.length;Q<O;Q++){N.getNodeCache(P,R[Q].tId)||(R.splice(Q,1),Q--,O--)}return R},getCheckStatus:function(O,Q){if(!O.check.enable||Q.nocheck||Q.chkDisabled){return null}var P=O.data.key.checked;return{checked:Q[P],half:Q.halfCheck?Q.halfCheck:O.check.chkStyle==H.radio.STYLE?Q.check_Child_State===2:Q[P]?Q.check_Child_State>-1&&Q.check_Child_State<2:Q.check_Child_State>0}},getTreeCheckedNodes:function(S,U,T,W){if(!U){return[]}for(var Q=S.data.key.children,R=S.data.key.checked,O=T&&S.check.chkStyle==H.radio.STYLE&&S.check.radioType==H.radio.TYPE_ALL,W=!W?[]:W,V=0,P=U.length;V<P;V++){if(U[V].nocheck!==!0&&U[V].chkDisabled!==!0&&U[V][R]==T&&(W.push(U[V]),O)){break}N.getTreeCheckedNodes(S,U[V][Q],T,W);if(O&&W.length>0){break}}return W},getTreeChangeCheckedNodes:function(S,U,T){if(!U){return[]}for(var P=S.data.key.children,O=S.data.key.checked,T=!T?[]:T,Q=0,R=U.length;Q<R;Q++){U[Q].nocheck!==!0&&U[Q].chkDisabled!==!0&&U[Q][O]!=U[Q].checkedOld&&T.push(U[Q]),N.getTreeChangeCheckedNodes(S,U[Q][P],T)}return T},makeChkFlag:function(R,T){if(T){var S=R.data.key.children,W=R.data.key.checked,P=-1;if(T[S]){for(var Q=0,O=T[S].length;Q<O;Q++){var V=T[S][Q],U=-1;if(R.check.chkStyle==H.radio.STYLE){if(U=V.nocheck===!0||V.chkDisabled===!0?V.check_Child_State:V.halfCheck===!0?2:V[W]?2:V.check_Child_State>0?2:0,U==2){P=2;break}else{U==0&&(P=0)}}else{if(R.check.chkStyle==H.checkbox.STYLE){if(U=V.nocheck===!0||V.chkDisabled===!0?V.check_Child_State:V.halfCheck===!0?1:V[W]?V.check_Child_State===-1||V.check_Child_State===2?2:1:V.check_Child_State>0?1:0,U===1){P=1;break}else{if(U===2&&P>-1&&Q>0&&U!==P){P=1;break}else{if(P===2&&U>-1&&U<2){P=1;break}else{U>-1&&(P=U)}}}}}}}T.check_Child_State=P}}}});var L=L.fn.zTree,I=L._z.tools,H=L.consts,J=L._z.view,N=L._z.data,M=I.$;N.exSetting(E);N.addInitBind(function(O){O.treeObj.bind(H.event.CHECK,function(S,R,Q,P){I.apply(O.callback.onCheck,[R?R:S,Q,P])})});N.addInitUnBind(function(O){O.treeObj.unbind(H.event.CHECK)});N.addInitCache(function(){});N.addInitNode(function(P,R,Q,O){if(Q){R=P.data.key.checked;typeof Q[R]=="string"&&(Q[R]=I.eqs(Q[R],"true"));Q[R]=!!Q[R];Q.checkedOld=Q[R];if(typeof Q.nocheck=="string"){Q.nocheck=I.eqs(Q.nocheck,"true")}Q.nocheck=!!Q.nocheck||P.check.nocheckInherit&&O&&!!O.nocheck;if(typeof Q.chkDisabled=="string"){Q.chkDisabled=I.eqs(Q.chkDisabled,"true")}Q.chkDisabled=!!Q.chkDisabled||P.check.chkDisabledInherit&&O&&!!O.chkDisabled;if(typeof Q.halfCheck=="string"){Q.halfCheck=I.eqs(Q.halfCheck,"true")}Q.halfCheck=!!Q.halfCheck;Q.check_Child_State=-1;Q.check_Focus=!1;Q.getCheckStatus=function(){return N.getCheckStatus(P,Q)};P.check.chkStyle==H.radio.STYLE&&P.check.radioType==H.radio.TYPE_ALL&&Q[R]&&N.getRoot(P).radioCheckedList.push(Q)}});N.addInitProxy(function(S){var U=S.target,T=N.getSetting(S.data.treeId),P="",O=null,Q="",R=null;if(I.eqs(S.type,"mouseover")){if(T.check.enable&&I.eqs(U.tagName,"span")&&U.getAttribute("treeNode"+H.id.CHECK)!==null){P=I.getNodeMainDom(U).id,Q="mouseoverCheck"}}else{if(I.eqs(S.type,"mouseout")){if(T.check.enable&&I.eqs(U.tagName,"span")&&U.getAttribute("treeNode"+H.id.CHECK)!==null){P=I.getNodeMainDom(U).id,Q="mouseoutCheck"}}else{if(I.eqs(S.type,"click")&&T.check.enable&&I.eqs(U.tagName,"span")&&U.getAttribute("treeNode"+H.id.CHECK)!==null){P=I.getNodeMainDom(U).id,Q="checkNode"}}}if(P.length>0){switch(O=N.getNodeCache(T,P),Q){case"checkNode":R=C;break;case"mouseoverCheck":R=D;break;case"mouseoutCheck":R=A}}return{stop:Q==="checkNode",node:O,nodeEventType:Q,nodeEventCallback:R,treeEventType:"",treeEventCallback:null}},!0);N.addInitRoot(function(O){N.getRoot(O).radioCheckedList=[]});N.addBeforeA(function(O,Q,P){O.check.enable&&(N.makeChkFlag(O,Q),P.push("<span ID='",Q.tId,H.id.CHECK,"' class='",J.makeChkClass(O,Q),"' treeNode",H.id.CHECK,Q.nocheck===!0?" style='display:none;'":"","></span>"))});N.addZTreeTools(function(O,Q){Q.checkNode=function(U,T,S,V){var R=O.data.key.checked;if(U.chkDisabled!==!0&&(T!==!0&&T!==!1&&(T=!U[R]),V=!!V,(U[R]!==T||S)&&!(V&&I.apply(this.setting.callback.beforeCheck,[O.treeId,U],!0)==!1)&&I.uCanDo(this.setting)&&O.check.enable&&U.nocheck!==!0)){U[R]=T,T=M(U,H.id.CHECK,O),(S||O.check.chkStyle===H.radio.STYLE)&&J.checkNodeRelation(O,U),J.setChkClass(O,T,U),J.repairParentChkClassWithSelf(O,U),V&&O.treeObj.trigger(H.event.CHECK,[null,O.treeId,U])}};Q.checkAllNodes=function(R){J.repairAllChk(O,!!R)};Q.getCheckedNodes=function(S){var R=O.data.key.children;return N.getTreeCheckedNodes(O,N.getRoot(O)[R],S!==!1)};Q.getChangeCheckedNodes=function(){var R=O.data.key.children;return N.getTreeChangeCheckedNodes(O,N.getRoot(O)[R])};Q.setChkDisabled=function(T,S,U,R){S=!!S;U=!!U;J.repairSonChkDisabled(O,T,S,!!R);J.repairParentChkDisabled(O,T.getParentNode(),S,U)};var P=Q.updateNode;Q.updateNode=function(R,T){P&&P.apply(Q,arguments);if(R&&O.check.enable&&M(R,O).get(0)&&I.uCanDo(O)){var S=M(R,H.id.CHECK,O);(T==!0||O.check.chkStyle===H.radio.STYLE)&&J.checkNodeRelation(O,R);J.setChkClass(O,S,R);J.repairParentChkClassWithSelf(O,R)}}});var B=J.createNodes;J.createNodes=function(P,R,Q,O){B&&B.apply(J,arguments);Q&&J.repairParentChkClassWithSelf(P,O)};var F=J.removeNode;J.removeNode=function(O,Q){var P=Q.getParentNode();F&&F.apply(J,arguments);Q&&P&&(J.repairChkClass(O,P),J.repairParentChkClass(O,P))};var G=J.appendNodes;J.appendNodes=function(R,T,S,P,O,Q){var U="";G&&(U=G.apply(J,arguments));P&&N.makeChkFlag(R,P);return U}})(jQuery);