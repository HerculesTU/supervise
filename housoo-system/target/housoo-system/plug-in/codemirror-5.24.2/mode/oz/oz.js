(function(A){if(typeof exports=="object"&&typeof module=="object"){A(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],A)}else{A(CodeMirror)}}})(function(A){A.defineMode("oz",function(R){function H(U){return new RegExp("^(("+U.join(")|(")+"))\\b")}var S=/[\^@!\|<>#~\.\*\-\+\\/,=]/;var C=/(<-)|(:=)|(=<)|(>=)|(<=)|(<:)|(>:)|(=:)|(\\=)|(\\=:)|(!!)|(==)|(::)/;var T=/(:::)|(\.\.\.)|(=<:)|(>=:)/;var O=["in","then","else","of","elseof","elsecase","elseif","catch","finally","with","require","prepare","import","export","define","do"];var I=["end"];var J=H(["true","false","nil","unit"]);var M=H(["andthen","at","attr","declare","feat","from","lex","mod","mode","orelse","parser","prod","prop","scanner","self","syn","token"]);var G=H(["local","proc","fun","case","class","if","cond","or","dis","choice","not","thread","try","raise","lock","for","suchthat","meth","functor"]);var B=H(O);var F=H(I);function E(X,W){if(X.eatSpace()){return null}if(X.match(/[{}]/)){return"bracket"}if(X.match(/(\[])/)){return"keyword"}if(X.match(T)||X.match(C)){return"operator"}if(X.match(J)){return"atom"}var U=X.match(G);if(U){if(!W.doInCurrentLine){W.currentIndent++}else{W.doInCurrentLine=false}if(U[0]=="proc"||U[0]=="fun"){W.tokenize=N}else{if(U[0]=="class"){W.tokenize=Q}else{if(U[0]=="meth"){W.tokenize=L}}}return"keyword"}if(X.match(B)||X.match(M)){return"keyword"}if(X.match(F)){W.currentIndent--;return"keyword"}var V=X.next();if(V=='"'||V=="'"){W.tokenize=D(V);return W.tokenize(X,W)}if(/[~\d]/.test(V)){if(V=="~"){if(!/^[0-9]/.test(X.peek())){return null}else{if((X.next()=="0"&&X.match(/^[xX][0-9a-fA-F]+/))||X.match(/^[0-9]*(\.[0-9]+)?([eE][~+]?[0-9]+)?/)){return"number"}}}if((V=="0"&&X.match(/^[xX][0-9a-fA-F]+/))||X.match(/^[0-9]*(\.[0-9]+)?([eE][~+]?[0-9]+)?/)){return"number"}return null}if(V=="%"){X.skipToEnd();return"comment"}else{if(V=="/"){if(X.eat("*")){W.tokenize=K;return K(X,W)}}}if(S.test(V)){return"operator"}X.eatWhile(/\w/);return"variable"}function Q(V,U){if(V.eatSpace()){return null}V.match(/([A-Z][A-Za-z0-9_]*)|(`.+`)/);U.tokenize=E;return"variable-3"}function L(V,U){if(V.eatSpace()){return null}V.match(/([a-zA-Z][A-Za-z0-9_]*)|(`.+`)/);U.tokenize=E;return"def"}function N(V,U){if(V.eatSpace()){return null}if(!U.hasPassedFirstStage&&V.eat("{")){U.hasPassedFirstStage=true;return"bracket"}else{if(U.hasPassedFirstStage){V.match(/([A-Z][A-Za-z0-9_]*)|(`.+`)|\$/);U.hasPassedFirstStage=false;U.tokenize=E;return"def"}else{U.tokenize=E;return null}}}function K(X,V){var W=false,U;while(U=X.next()){if(U=="/"&&W){V.tokenize=E;break}W=(U=="*")}return"comment"}function D(U){return function(Z,X){var W=false,Y,V=false;while((Y=Z.next())!=null){if(Y==U&&!W){V=true;break}W=!W&&Y=="\\"}if(V||!W){X.tokenize=E}return"string"}}function P(){var U=O.concat(I);return new RegExp("[\\[\\]]|("+U.join("|")+")$")}return{startState:function(){return{tokenize:E,currentIndent:0,doInCurrentLine:false,hasPassedFirstStage:false}},token:function(V,U){if(V.sol()){U.doInCurrentLine=0}return U.tokenize(V,U)},indent:function(W,U){var V=U.replace(/^\s+|\s+$/g,"");if(V.match(F)||V.match(B)||V.match(/(\[])/)){return R.indentUnit*(W.currentIndent-1)}if(W.currentIndent<0){return 0}return W.currentIndent*R.indentUnit},fold:"indent",electricInput:P(),lineComment:"%",blockCommentStart:"/*",blockCommentEnd:"*/"}});A.defineMIME("text/x-oz","oz")});