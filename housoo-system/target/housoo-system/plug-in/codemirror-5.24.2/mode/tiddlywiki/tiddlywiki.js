(function(A){if(typeof exports=="object"&&typeof module=="object"){A(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],A)}else{A(CodeMirror)}}})(function(A){A.defineMode("tiddlywiki",function(){var E={};var B={"allTags":true,"closeAll":true,"list":true,"newJournal":true,"newTiddler":true,"permaview":true,"saveChanges":true,"search":true,"slider":true,"tabs":true,"tag":true,"tagging":true,"tags":true,"tiddler":true,"timeline":true,"today":true,"version":true,"option":true,"with":true,"filter":true};var I=/[\w_\-]/i,M=/^\-\-\-\-+$/,V=/^\/\*\*\*$/,P=/^\*\*\*\/$/,S=/^<<<$/,R=/^\/\/\{\{\{$/,X=/^\/\/\}\}\}$/,Q=/^<!--\{\{\{-->$/,L=/^<!--\}\}\}-->$/,U=/^\{\{\{$/,T=/^\}\}\}$/,O=/.*?\}\}\}/;function C(a,Z,Y){Z.tokenize=Y;return Y(a,Z)}function H(b,a){var Y=b.sol(),Z=b.peek();a.block=false;if(Y&&/[<\/\*{}\-]/.test(Z)){if(b.match(U)){a.block=true;return C(b,a,K)}if(b.match(S)){return"quote"}if(b.match(V)||b.match(P)){return"comment"}if(b.match(R)||b.match(X)||b.match(Q)||b.match(L)){return"comment"}if(b.match(M)){return"hr"}}b.next();if(Y&&/[\/\*!#;:>|]/.test(Z)){if(Z=="!"){b.skipToEnd();return"header"}if(Z=="*"){b.eatWhile("*");return"comment"}if(Z=="#"){b.eatWhile("#");return"comment"}if(Z==";"){b.eatWhile(";");return"comment"}if(Z==":"){b.eatWhile(":");return"comment"}if(Z==">"){b.eatWhile(">");return"quote"}if(Z=="|"){return"header"}}if(Z=="{"&&b.match(/\{\{/)){return C(b,a,K)}if(/[hf]/i.test(Z)&&/[ti]/i.test(b.peek())&&b.match(/\b(ttps?|tp|ile):\/\/[\-A-Z0-9+&@#\/%?=~_|$!:,.;]*[A-Z0-9+&@#\/%=~_|$]/i)){return"link"}if(Z=='"'){return"string"}if(Z=="~"){return"brace"}if(/[\[\]]/.test(Z)&&b.match(Z)){return"brace"}if(Z=="@"){b.eatWhile(I);return"link"}if(/\d/.test(Z)){b.eatWhile(/\d/);return"number"}if(Z=="/"){if(b.eat("%")){return C(b,a,J)}else{if(b.eat("/")){return C(b,a,N)}}}if(Z=="_"&&b.eat("_")){return C(b,a,D)}if(Z=="-"&&b.eat("-")){if(b.peek()!=" "){return C(b,a,F)}if(b.peek()==" "){return"brace"}}if(Z=="'"&&b.eat("'")){return C(b,a,W)}if(Z=="<"&&b.eat("<")){return C(b,a,G)}b.eatWhile(/[\w\$_]/);return E.propertyIsEnumerable(b.current())?"keyword":null}function J(b,Z){var a=false,Y;while(Y=b.next()){if(Y=="/"&&a){Z.tokenize=H;break}a=(Y=="%")}return"comment"}function W(b,Z){var a=false,Y;while(Y=b.next()){if(Y=="'"&&a){Z.tokenize=H;break}a=(Y=="'")}return"strong"}function K(a,Z){var Y=Z.block;if(Y&&a.current()){return"comment"}if(!Y&&a.match(O)){Z.tokenize=H;return"comment"}if(Y&&a.sol()&&a.match(T)){Z.tokenize=H;return"comment"}a.next();return"comment"}function N(b,Z){var a=false,Y;while(Y=b.next()){if(Y=="/"&&a){Z.tokenize=H;break}a=(Y=="/")}return"em"}function D(b,Z){var a=false,Y;while(Y=b.next()){if(Y=="_"&&a){Z.tokenize=H;break}a=(Y=="_")}return"underlined"}function F(b,Z){var a=false,Y;while(Y=b.next()){if(Y=="-"&&a){Z.tokenize=H;break}a=(Y=="-")}return"strikethrough"}function G(a,Z){if(a.current()=="<<"){return"macro"}var Y=a.next();if(!Y){Z.tokenize=H;return null}if(Y==">"){if(a.peek()==">"){a.next();Z.tokenize=H;return"macro"}}a.eatWhile(/[\w\$_]/);return B.propertyIsEnumerable(a.current())?"keyword":null}return{startState:function(){return{tokenize:H}},token:function(a,Z){if(a.eatSpace()){return null}var Y=Z.tokenize(a,Z);return Y}}});A.defineMIME("text/x-tiddlywiki","tiddlywiki")});