var server;this.onmessage=function(A){var C=A.data;switch(C.type){case"init":return startServer(C.defs,C.plugins,C.scripts);case"add":return server.addFile(C.name,C.text);case"del":return server.delFile(C.name);case"req":return server.request(C.body,function(E,D){postMessage({id:C.id,body:D,err:E&&String(E)})});case"getFile":var B=pending[C.id];delete pending[C.id];return B(C.err,C.text);default:throw new Error("Unknown message type: "+C.type)}};var nextId=0,pending={};function getFile(B,A){postMessage({type:"getFile",name:B,id:++nextId});pending[nextId]=A}function startServer(C,A,B){if(B){importScripts.apply(null,B)}server=new tern.Server({getFile:getFile,async:true,defs:C,plugins:A})}this.console={log:function(A){postMessage({type:"debug",message:A})}};