(function(A){if(typeof exports=="object"&&typeof module=="object"){A(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],A)}else{A(CodeMirror)}}})(function(B){var C=B.Pos;function A(W,Z){var I=Z&&Z.schemaInfo;var T=(Z&&Z.quoteChar)||'"';if(!I){return}var R=W.getCursor(),L=W.getTokenAt(R);if(L.end>R.ch){L.end=R.ch;L.string=L.string.slice(0,R.ch-L.start)}var e=B.innerMode(W.getMode(),L.state);if(e.mode.name!="xml"){return}var c=[],Y=false,P;var f=/\btag\b/.test(L.type)&&!/>$/.test(L.string);var G=f&&/^\w/.test(L.string),b;if(G){var K=W.getLine(R.line).slice(Math.max(0,L.start-2),L.start);var Q=/<\/$/.test(K)?"close":/<$/.test(K)?"open":null;if(Q){b=L.start-(Q=="close"?2:1)}}else{if(f&&L.string=="<"){Q="open"}else{if(f&&L.string=="</"){Q="close"}}}if(!f&&!e.state.tagName||Q){if(G){P=L.string}Y=Q;var H=e.state.context,a=H&&I[H.tagName];var E=H?a&&a.children:I["!top"];if(E&&Q!="close"){for(var X=0;X<E.length;++X){if(!P||E[X].lastIndexOf(P,0)==0){c.push("<"+E[X])}}}else{if(Q!="close"){for(var d in I){if(I.hasOwnProperty(d)&&d!="!top"&&d!="!attrs"&&(!P||d.lastIndexOf(P,0)==0)){c.push("<"+d)}}}}if(H&&(!P||Q=="close"&&H.tagName.lastIndexOf(P,0)==0)){c.push("</"+H.tagName+">")}}else{var a=I[e.state.tagName],V=a&&a.attrs;var S=I["!attrs"];if(!V&&!S){return}if(!V){V=S}else{if(S){var U={};for(var D in S){if(S.hasOwnProperty(D)){U[D]=S[D]}}for(var D in V){if(V.hasOwnProperty(D)){U[D]=V[D]}}V=U}}if(L.type=="string"||L.string=="="){var K=W.getRange(C(R.line,Math.max(0,R.ch-60)),C(R.line,L.type=="string"?L.start:L.end));var O=K.match(/([^\s\u00a0=<>\"\']+)=$/),N;if(!O||!V.hasOwnProperty(O[1])||!(N=V[O[1]])){return}if(typeof N=="function"){N=N.call(this,W)}if(L.type=="string"){P=L.string;var J=0;if(/['"]/.test(L.string.charAt(0))){T=L.string.charAt(0);P=L.string.slice(1);J++}var F=L.string.length;if(/['"]/.test(L.string.charAt(F-1))){T=L.string.charAt(F-1);P=L.string.substr(J,F-2)}Y=true}for(var X=0;X<N.length;++X){if(!P||N[X].lastIndexOf(P,0)==0){c.push(T+N[X]+T)}}}else{if(L.type=="attribute"){P=L.string;Y=true}for(var M in V){if(V.hasOwnProperty(M)&&(!P||M.lastIndexOf(P,0)==0)){c.push(M)}}}}return{list:c,from:Y?C(R.line,b==null?L.start:b):R,to:Y?C(R.line,L.end):R}}B.registerHelper("hint","xml",A)});