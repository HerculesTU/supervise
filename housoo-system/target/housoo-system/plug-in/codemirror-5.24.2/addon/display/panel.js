(function(A){if(typeof exports=="object"&&typeof module=="object"){A(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],A)}else{A(CodeMirror)}}})(function(E){E.defineExtension("addPanel",function(H,I){I=I||{};if(!this.state.panels){A(this)}var K=this.state.panels;var G=K.wrapper;var J=this.getWrapperElement();if(I.after instanceof B&&!I.after.cleared){G.insertBefore(H,I.before.node.nextSibling)}else{if(I.before instanceof B&&!I.before.cleared){G.insertBefore(H,I.before.node)}else{if(I.replace instanceof B&&!I.replace.cleared){G.insertBefore(H,I.replace.node);I.replace.clear()}else{if(I.position=="bottom"){G.appendChild(H)}else{if(I.position=="before-bottom"){G.insertBefore(H,J.nextSibling)}else{if(I.position=="after-top"){G.insertBefore(H,J)}else{G.insertBefore(H,G.firstChild)}}}}}}var F=(I&&I.height)||H.offsetHeight;this._setSize(null,K.heightLeft-=F);K.panels++;if(I.stable&&C(this,H)){this.scrollTo(null,this.getScrollInfo().top+F)}return new B(this,H,I,F)});function B(I,G,H,F){this.cm=I;this.node=G;this.options=H;this.height=F;this.cleared=false}B.prototype.clear=function(){if(this.cleared){return}this.cleared=true;var F=this.cm.state.panels;this.cm._setSize(null,F.heightLeft+=this.height);if(this.options.stable&&C(this.cm,this.node)){this.cm.scrollTo(null,this.cm.getScrollInfo().top-this.height)}F.wrapper.removeChild(this.node);if(--F.panels==0){D(this.cm)}};B.prototype.changed=function(F){var G=F==null?this.node.offsetHeight:F;var H=this.cm.state.panels;this.cm._setSize(null,H.height+=(G-this.height));this.height=G};function A(K){var H=K.getWrapperElement();var I=window.getComputedStyle?window.getComputedStyle(H):H.currentStyle;var G=parseInt(I.height);var J=K.state.panels={setHeight:H.style.height,heightLeft:G,panels:0,wrapper:document.createElement("div")};H.parentNode.insertBefore(J.wrapper,H);var F=K.hasFocus();J.wrapper.appendChild(H);if(F){K.focus()}K._setSize=K.setSize;if(G!=null){K.setSize=function(N,L){if(L==null){return this._setSize(N,L)}J.setHeight=L;if(typeof L!="number"){var M=/^(\d+\.?\d*)px$/.exec(L);if(M){L=Number(M[1])}else{J.wrapper.style.height=L;L=J.wrapper.offsetHeight;J.wrapper.style.height=""}}K._setSize(N,J.heightLeft+=(L-G));G=L}}}function D(H){var G=H.state.panels;H.state.panels=null;var F=H.getWrapperElement();G.wrapper.parentNode.replaceChild(F,G.wrapper);F.style.height=G.setHeight;H.setSize=H._setSize;H.setSize()}function C(H,F){for(var G=F.nextSibling;G;G=G.nextSibling){if(G==H.getWrapperElement()){return true}}return false}});